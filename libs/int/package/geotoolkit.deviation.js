/* eslint-disable */
import {L,Fb,M,G,D,V,Sg,th,U,Vi,wh,W,Jd,Gh,hb,sd,Wi,Tj,ek,Xg,wc,WF,Hd,Cd,Ed,Dd,wf,Xi,Rh,hc,mc,fp,Oe,Ce,Th,lc,X,Hg,xb,O,Am,jf,oi,Fk,Ki,Vm,rf,ho,rb,Zd,Be,va} from './geotoolkit.base.js';import {FR,GR,IR,PR,HR,kU} from './geotoolkit.controls.js';var aa,ha=ha||{};ha.scope={};ha.Nqc=function(c){var a=0;return function(){return a<c.length?{done:!1,value:c[a++]}:{done:!0}}};ha.Moe=function(c){return{next:ha.Nqc(c)}};ha.qXc=!1;ha.URd=!1;ha.VRd=!1;ha.Mfe=!1;ha.Acc=!1;ha.defineProperty=ha.qXc||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,a,b){if(c==Array.prototype||c==Object.prototype)return c;c[a]=b.value;return c};
ha.cod=function(c){c=["object"==typeof globalThis&&globalThis,c,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var a=0;a<c.length;++a){var b=c[a];if(b&&b.Math==Math)return b}return function(){throw Error("Cannot find global object");}()};ha.global=ha.cod(this);ha.nEb="function"===typeof Symbol&&"symbol"===typeof Symbol("x");ha.hje=!ha.Acc||ha.nEb;ha.r3b={};ha.L3b={};ha.S1c="$jscp$";
function aaa(c,a){var b=ha.L3b[a];if(null==b)return c[a];b=c[b];return void 0!==b?b:c[a]}ha.lKc=function(c,a,b,d){a&&(ha.Acc?ha.ZDd(c,a,b,d):ha.$Dd(c,a,b,d))};ha.$Dd=function(c,a,b,d){b=ha.global;c=c.split(".");for(d=0;d<c.length-1;d++){var e=c[d];if(!(e in b))return;b=b[e]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&ha.defineProperty(b,c,{configurable:!0,writable:!0,value:a})};
ha.ZDd=function(c,a,b,d){var e=c.split(".");c=1===e.length;d=e[0];d=!c&&d in ha.r3b?ha.r3b:ha.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];b=ha.nEb&&"es6"===b?d[e]:null;a=a(b);null!=a&&(c?ha.defineProperty(ha.r3b,e,{configurable:!0,writable:!0,value:a}):a!==b&&(ha.L3b[e]=ha.nEb?ha.global.Symbol(e):ha.S1c+e,e=ha.L3b[e],ha.defineProperty(d,e,{configurable:!0,writable:!0,value:a})))};ha.Ise=function(){};
ha.lKc("Symbol",function(c){function a(f){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new b(d+(f||"")+"_"+e++,f)}function b(f,g){this.oXc=f;ha.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})}if(c)return c;b.prototype.toString=function(){return this.oXc};var d="jscomp_symbol_",e=0;return a},"es6","es3");ha.Kse=function(){};
ha.lKc("Symbol.iterator",function(c){if(c)return c;c=Symbol("Symbol.iterator");for(var a="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),b=0;b<a.length;b++){var d=ha.global[a[b]];"function"===typeof d&&"function"!=typeof d.prototype[c]&&ha.defineProperty(d.prototype,c,{configurable:!0,writable:!0,value:function(){return ha.Nyd(ha.Nqc(this))}})}return c},"es6","es3");ha.Jse=function(){};
ha.Nyd=function(c){c={next:c};c[Symbol.iterator]=function(){return this};return c};var CO=/*#__PURE__*/function(){function c(){}L(c,"geotoolkit.deviation.Transformer2d");c.prototype.create=Fb;return c}();var DO=/*#__PURE__*/function(){function c(){this.Tg=[]}L(c,"geotoolkit.deviation.RectMap");c.prototype.ana=function(){return this.Tg};c.prototype.clear=function(){this.Tg=[];return this};c.prototype.yUa=function(a){for(var b=0;b<this.Tg.length;b++){var d=this.Tg[b];if(a<=d.agb)return b}return this.Tg.length};c.prototype.jRd=function(a){for(var b=this.Tg.length-1;0<=b;b--)if(this.Tg[b].agb<=a)return b;return 0};c.prototype.Jn=function(a){var b=a.agb;if(0===this.Tg.length)this.Tg.push(a);else{var d;for(d=0;d<this.Tg.length&&
!(this.Tg[d].agb>=b);d++);this.Tg.splice(d,0,a)}};return c}();var EO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(){}L(c,"geotoolkit.deviation.DeviatedTransformation");c.prototype.update=Fb;c.prototype.transform=Fb;c.prototype.nc=Fb;c.prototype.mF=Fb;c.prototype.II=Fb;c.prototype.Pua=Fb;c.prototype.MRa=Fb;c.prototype.Uva=Fb;c.prototype.contains=Fb;c.prototype.eX=Fb;c.prototype.fX=Fb;c.prototype.jDc=function(){return{xMin:this.XS(),yMin:this.YS(),xMean:this.Swb(),yMean:this.Twb(),xMax:this.JW(),yMax:this.KW()}};c.prototype.JW=Fb;c.prototype.KW=Fb;c.prototype.XS=Fb;c.prototype.YS=Fb;
c.prototype.Swb=function(){var a=this.XS(),b=this.JW();return Math.sqrt((a*a+b*b)/2)};c.prototype.Twb=function(){var a=this.YS(),b=this.KW();return Math.sqrt((a*a+b*b)/2)};c.prototype.i9=Fb;c.prototype.m_=Fb;return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoibmMiLCJ0cmFuc2Zvcm1MaW5lIjoibUYiLCJ0cmFuc2Zvcm1MaW5lcyI6IklJIiwiZmluZFZpc2libGVUcmFqZWN0b3J5UmFuZ2VzIjoiUHVhIiwiZmluZEJvdW5kcyI6Ik1SYSIsImdldFN0YXRpb25zQm91bmRzIjoiVXZhIiwic2NhbGVYQXQiOiJlWCIsInNjYWxlWUF0IjoiZlgiLCJnZXRTY2FsZXNJbmZvIjoiakRjIiwibWF4U2NhbGVYIjoiSlciLCJtYXhTY2FsZVkiOiJLVyIsIm1pblNjYWxlWCI6IlhTIiwibWluU2NhbGVZIjoiWVMiLCJkaWdpdGl6ZSI6Imk5IiwiZ2V0TG93ZXJJbmRleCI6Im1fIn19fSAg");var FO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(){}L(c,"geotoolkit.deviation.TrackWidthStrategy");c.prototype.ca=Fb;c.prototype.tXb=function(a,b){if(2>a.count())return{deviceLength:0,length:0};var d=0,e=0,f=new M,g=new M;b.Ma(f.Ga(a.getX(0),a.getY(0)),g);for(var h=g.x,k=g.y,l,m,n=1;n<a.count();++n)b.Ma(f.Ga(a.getX(n),a.getY(n)),g),l=g.x,m=g.y,h-=l,k-=m,d+=Math.sqrt(h*h+k*k),k=m,h=l,l=Math.abs(a.Sb(n-1)-a.Sb(n)),e+=l;return{deviceLength:d,length:e}};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXaWR0aCI6ImNhIiwiZ2V0RGV2aWNlTGVuZ3RoIjoidFhiIn19fSAg");var GO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(b){FO.call(this);b=G(b,{scaleWidth:!1,minWidth:1,maxWidth:Infinity,widthScaleX:1,widthScaleY:1});this.YOb=b.scaleWidth;this.OU=b.minWidth;this.IU=b.maxWidth;this.Hpb=b.widthScaleX;this.zRb=b.widthScaleY;this.Op=null;this.Pza=1}function a(b,d){return Math.abs(d)>Math.abs(b)?0>d?-Math.atan(b/d):Math.PI-Math.atan(b/d):0>b?-Math.PI/2+Math.atan(d/b):Math.PI/2+Math.atan(d/b)}D(c,FO);L(c,"geotoolkit.deviation.TrackMinMaxWidthStrategy");c.prototype.ca=function(b,d){var e=d.width;
if(!this.YOb)return e;d=d.trajectory;d!==this.Op&&(this.update(d),this.Op=d);b=Math.sqrt(b.pb()/this.Hpb*this.Pza*(b.pb()/this.Hpb)+b.Ab()/this.zRb*(1-this.Pza)*(b.Ab()/this.zRb));e*=b;e<this.OU&&(e=this.OU);e>this.IU&&(e=this.IU);return e};c.prototype.update=function(b){this.Pza=1;for(var d=0,e=0,f=0,g,h,k=1;k<b.count();++k)g=this.Hpb*(b.getX(f)-b.getX(k)),h=this.zRb*(b.getY(f)-b.getY(k)),1<k&&k<b.count()-1&&.5>Math.abs(g)&&.5>Math.abs(h)?k++:(e+=Math.abs(a(g,h)),d++,f=k);0<d&&(e/=d);this.Pza=Math.sin(e);
this.Pza*=this.Pza};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXaWR0aCI6ImNhIn19fSAg");var HO=/*#__PURE__*/function(){function c(b){return 0<=b?Math.floor(b+.5):Math.ceil(b-.5)}function a(){}L(a,"geotoolkit.deviation.Util");a.$E=function(b){return 0>b?Math.ceil(b):Math.floor(b)};a.gIa=function(b,d){return b.getX()*d.getX()+b.getY()*d.getY()};a.tRd=function(b,d){return b.getX()*d.getY()-b.getY()*d.getX()};a.aTb=function(b,d,e){var f=(b.getX()-d.getX())*(e.getX()-d.getX())+(b.getY()-d.getY())*(e.getY()-d.getY());b=(b.getX()-d.getX())*(e.getY()-d.getY())-(b.getY()-d.getY())*(e.getX()-d.getX());return 0!==
f||0!==b?Math.atan2(b,f):0};a.Mq=function(b,d,e,f){if(f){if(f=c(d.getX()),d=c(d.getY()),0<Math.abs(e.getX()-f)||0<Math.abs(e.getY()-d))e.Ga(f,d),b.push(new M(f,d))}else b.push(d)};a.qFc=function(b,d,e,f,g){var h=0<=(b.getY()-d.getY())*(e.getX()-d.getX())-(b.getX()-d.getX())*(e.getY()-d.getY());return h!==0<=(b.getY()-e.getY())*(f.getX()-e.getX())-(b.getX()-e.getX())*(f.getY()-e.getY())||h!==0<=(b.getY()-f.getY())*(g.getX()-f.getX())-(b.getX()-f.getX())*(g.getY()-f.getY())||h!==0<=(b.getY()-g.getY())*
(d.getX()-g.getX())-(b.getX()-g.getX())*(d.getY()-g.getY())?!1:!0};a.Gla=function(b,d,e,f,g){var h=(f.getY()-e.getY())*(d.getX()-b.getX())-(f.getX()-e.getX())*(d.getY()-b.getY());return 0!==h?(f=((f.getX()-e.getX())*(b.getY()-e.getY())-(f.getY()-e.getY())*(b.getX()-e.getX()))/h,e=b.getY()+f*(d.getY()-b.getY()),b=b.getX()+f*(d.getX()-b.getX()),g.Ga(b,e),!0):!1};a.Yvb=function(b,d,e,f){var g=0<=(b.getY()-d.getY())*(e.getX()-d.getX())-(b.getX()-d.getX())*(e.getY()-d.getY());return g!==0<=(b.getY()-e.getY())*
(f.getX()-e.getX())-(b.getX()-e.getX())*(f.getY()-e.getY())||g!==0<=(b.getY()-f.getY())*(d.getX()-f.getX())-(b.getX()-f.getX())*(d.getY()-f.getY())?!1:!0};a.getLength=function(b){return Math.abs(b.getX())<=Number.MIN_VALUE?Math.abs(b.getY()):Math.abs(b.getY())<=Number.MIN_VALUE?Math.abs(b.getX()):Math.sqrt(b.getX()*b.getX()+b.getY()*b.getY())};a.kKc=function(b){var d=b?b.length:0;return 2>d?!0:M.Uf(b[0],b[d-1])<V.Qb};a.SP=function(b,d,e){b=b.getY()===d.getY()?(b.getX()+d.getX())/2:b.getX()+(d.getX()-
b.getX())*(e-b.getY())/(d.getY()-b.getY());return new M(b,e)};a.i0b=function(b,d,e,f){void 0===f&&(f=V.Qb);var g=d.getY()-b.getY();if(0===g)return Math.abs(b.getY()-e.getY())<=f;var h=d.getX()-b.getX();return 0===h?Math.abs(b.getX()-e.getX())<=f:Math.abs(b.getX()+(d.getX()-b.getX())*(e.getY()-b.getY())/g-e.getX())<=f||Math.abs(b.getY()+(d.getY()-b.getY())*(e.getX()-b.getX())/h-e.getY())<=f?!0:!1};a.rtc=function(b,d,e,f,g,h,k){if(0>=k)throw Error("Invalid radius");var l=b-e,m=d-f;l=Math.atan2(m,l);
g-=e;h-=f;h=Math.atan2(h,g);m=h-l;g=-Math.sign(m);if(Math.abs(m)<=Number.MIN_VALUE)throw Error("Invalid angles");var n=Math.abs(m/2),p=k/Math.sin(n);m=p*Math.cos((l+h)/2);var q=p*Math.sin((l+h)/2),r=p*Math.cos(n);n=r*Math.cos(l);p=r*Math.sin(l);var t=r*Math.cos(h);r*=Math.sin(h);return{line:{LRd:b,NRd:d,iXc:g*n+e,lXc:g*p+f},arc:{left:g*m+e-k,top:g*q+f-k,hw:l+Math.PI/2,Yvc:h-Math.PI/2},kp:{x:g*t+e,y:g*r+f}}};a.xkd=function(b,d,e,f){var g=f||a.Erd(b,d);if(0===g.length)return[];if(1===g.length)return a.yCc(b,
d,e);f=[];var h;for(h=0;h<g.length;++h){var k=b.slice(g[h].from,g[h].Ie+1);var l=d.slice(g[h].from,g[h].Ie+1);k=a.yCc(k,l,e);for(l=0;l<k.length;++l)f.push(k[l].from),f.push(k[l].Ie)}f.sort(function(m,n){return m-n});b=[];for(h=0;h<f.length;h+=2)b.push({from:f[h],Ie:f[h+1]});return b};a.Erd=function(b,d){for(var e=Math.min(b.length,d.length),f=[],g,h,k,l,m=0;m<e;++m){g=b[m];h=d[m];for(var n=m+2;n<e;++n)if(k=b[n],l=d[n],g===k&&h===l){f.push({from:m,Ie:n});m=n;break}}0===f.length&&f.push({from:0,Ie:f.length-
1});return f};a.yCc=function(b,d,e){var f=[],g=Math.min(b.length,d.length),h=[],k;for(k=1;k<g;++k)if(!(d[k]===d[k-1]||d[k]<e&&d[k-1]<e||d[k]>e&&d[k-1]>e)){if(d[k-1]>d[k]){var l=d[k];var m=d[k-1];var n=b[k];var p=b[k-1]}else l=d[k-1],m=d[k],n=b[k-1],p=b[k];l!==e&&(n=n===p?p:n+(e-l)*(p-n)/(m-l),h.push(n))}if(2>h.length)return f;h.sort(function(q,r){return q-r});for(k=0;k<h.length;k+=2)f.push({from:h[k],Ie:h[k+1]});return f};a.JKc=function(b,d){return Math.abs(b-d)<=1E-12*Math.min(Math.abs(b),Math.abs(d))};
return a}();var IO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(){}L(c,"geotoolkit.deviation.ClipHelper");c.DGa=function(a,b){for(var d=new Sg,e=new Sg,f=0;f<a.length-1;++f){d.setStart(a[f]);d.setEnd(a[f+1]);for(var g=0;g<b.length-1;++g){e.setStart(b[g]);e.setEnd(b[g+1]);var h=d.$la(e);if(h)return h}}return null};return c}(),2,"eyJpbnRlcnNlY3RMaW5lcyI6IkRHYSJ9");var JO=/*#__PURE__*/function(){function c(b,d){this.FAa=NaN;this.TY=new M;this.Oq(b,d)}var a=new M;L(c,"geotoolkit.deviation.Line");c.prototype.Oq=function(b,d){if("number"===typeof d)this.TY.Ga(b.getX(),b.getY()),this.FAa=d;else if(d instanceof M){a.Ga(d.getY()-b.getY(),b.getX()-d.getX());d=HO.gIa(a,a);if(d>V.Qb){var e=Math.sqrt(d);d=a.getX()/e;e=a.getY()/e}else d=1,e=0;this.TY.Ga(d,e);this.FAa=-HO.gIa(this.TY,b)}else this.FAa=b.FAa,this.TY.Ga(b.TY.getX(),b.TY.getY())};c.prototype.bxb=function(){return this.TY};
c.prototype.Yve=function(b){this.TY=b};c.prototype.s7a=function(){return this.FAa};c.prototype.Xve=function(b){this.FAa=b};c.prototype.distance=function(b){return HO.gIa(this.TY,b)+this.FAa};c.prototype.project=function(b){var d=this.distance(b);return new M(b.getX()-this.TY.getX()*d,b.getY()-this.TY.getY()*d)};c.prototype.$te=function(b){var d=2*this.distance(b);return new M(b.getX()-this.TY.getX()*d,b.getY()-this.TY.getY()*d)};c.Gbd=function(b,d){b=b.bxb();d=d.bxb();return Math.abs(b.getX()*d.getY()-
d.getX()*b.getY())<V.Qb};c.pLc=function(b,d){var e=b.bxb(),f=d.bxb(),g=e.getX()*f.getY()-f.getX()*e.getY();b=b.s7a();var h=d.s7a();d=e.getY()*h-f.getY()*b;e=f.getX()*b-e.getX()*h;return new M(d/g,e/g)};return c}();var KO=/*#__PURE__*/function(){function c(){this.bka=[]}L(c,"geotoolkit.deviation.MappedPixel");c.prototype.clear=function(){this.bka=[]};c.prototype.append=function(a){this.bka.push(a)};c.prototype.get=function(a){return this.bka[a]};c.prototype.getSize=function(){return this.bka.length};return c}();var LO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(){this.MBa=[]}function a(p){var q=p.getSize(),r=p.ce();p=p.Fe();var t=0===q||r[0]===r[q-1]&&p[0]===p[q-1];if(q<(t?4:3))return 0;for(var u=0,w=1;w<q;++w)u+=r[w-1]*p[w]-p[w-1]*r[w];t||(u+=r[q-1]*p[0]-p[q-1]*r[0]);return Math.abs(u/2)}function b(p,q,r){this.Oh=p;this.Ch=q;this.area=r}var d=HO,e=8;L(c,"geotoolkit.deviation.PixelMapper");c.prototype.nc=Fb;var f=new M,g=new M,h=new M,k=new M,l=new th,m=new th,n=new U;c.prototype.MQd=function(p,q,r){var t=p.getX();p=p.getY();
t=[this.nc(f.Ga(t,p)),this.nc(g.Ga(t+1,p)),this.nc(h.Ga(t+1,p+1)),this.nc(k.Ga(t,p+1))];t.forEach(function(B){B.y*=r});p=0>t[0].x?1-d.$E(t[0].x):-d.$E(t[0].x);for(var u=0>t[0].y?1-d.$E(t[0].y):-d.$E(t[0].y),w=Infinity,y=-Infinity,A=Infinity,x=-Infinity,C=0;C<t.length;C++)t[C].x+=p,t[C].y+=u,w=Math.min(w,t[C].x),y=Math.max(y,t[C].x),A=Math.min(A,t[C].y),x=Math.max(x,t[C].y);p=new KO;if(Vi.vp().Cz(n.cb(w,A,y,x)))t=0,u=x-A,C=y-w,t+=u*w,t+=-C*x,t+=-u*y,t+=C*A,p.append(new b(0,0,t));else for(u=d.$E(t[0].x),
C=d.$E(t[0].y),w=Math.floor(w),y=Math.ceil(y),A=Math.floor(A),x=Math.ceil(x);w<y;++w)for(var z=A;z<x;++z){var v=new wh;v.union(l.he([t[0].x,t[1].x,t[2].x,t[3].x],[t[0].y,t[1].y,t[2].y,t[3].y]),v);v=v.intersect(m.he([w,w+1,w+1,w],[z,z,z+1,z+1]));0<v.length&&p.append(new b(w-u,z-C,a(v[0])))}this.MBa[q]=p};c.prototype.L1b=function(p,q){var r=this.nc(p),t=r.getX()-(0>r.getX()?d.$E(r.getX())-1:d.$E(r.getX())),u=r.getY()-(0>r.getY()?d.$E(r.getY())-1:d.$E(r.getY()));t=d.$E(t*e)+d.$E(u*e)*e;this.MBa[t]&&
0!==this.MBa[t].getSize()||this.MQd(p,t,q);this.MBa[t].og=r;return this.MBa[t]};c.prototype.rTb=function(){for(var p=0;p<this.MBa.length;++p)this.MBa[p].clear()};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoibmMifX19");var MO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a,b){LO.call(this);this.FE=a;this.ABa=new M;this.ZCa=new M;this.WCa=new M;this.xBa=new M;this.pR=this.oR=1;this.qOb=null;this.qjc=b}D(c,LO);L(c,"geotoolkit.deviation.TrajectoryStation");c.prototype.bd=function(){return this.ABa};c.prototype.T6b=function(a){this.ABa.Ga(a.getX(),a.getY())};c.prototype.Vf=function(){return this.xBa};c.prototype.Q6b=function(a){this.xBa.Ga(a.getX(),a.getY())};c.prototype.Wf=function(){return this.ZCa};c.prototype.N7b=function(a){this.ZCa.Ga(a.getX(),
a.getY())};c.prototype.nf=function(){return this.WCa};c.prototype.J7b=function(a){this.WCa.Ga(a.getX(),a.getY())};c.prototype.yf=function(){return this.FE.ka()};c.prototype.b7b=function(a){a=Math.min(this.FE.ma(),a);this.FE.cb(this.FE.la(),a,this.FE.na(),this.FE.ma());this.update()};c.prototype.ng=function(){return this.FE.ma()};c.prototype.$6b=function(a){a=Math.max(this.FE.ka(),a);this.FE.cb(this.FE.la(),this.FE.ka(),this.FE.na(),a);this.update()};c.prototype.Gf=function(){return this.FE};c.prototype.Mxa=
function(a){this.FE=a};c.prototype.ga=function(){var a=new U(this.bd().getX(),this.bd().getY(),this.Vf().getX(),this.Vf().getY());return a.union(new U(this.nf().getX(),this.nf().getY(),this.Wf().getX(),this.Wf().getY()))};c.prototype.JW=function(){return this.oR};c.prototype.FIa=function(a){this.oR=a};c.prototype.KW=function(){return this.pR};c.prototype.GIa=function(a){this.pR=a};c.prototype.t$=function(){return this.qjc};c.prototype.zEd=function(a){this.qOb=a};c.prototype.offset=function(a){var b=
a.getX();a=a.getY();this.ABa.Ga(this.ABa.getX()+b,this.ABa.getY()+a);this.ZCa.Ga(this.ZCa.getX()+b,this.ZCa.getY()+a);this.WCa.Ga(this.WCa.getX()+b,this.WCa.getY()+a);this.xBa.Ga(this.xBa.getX()+b,this.xBa.getY()+a)};c.prototype.update=function(){this.rTb()};c.prototype.i9=function(a,b){if(this.qjc&&null!=this.qOb){var d=this.nc(a),e=this.FE.ma(),f=this.FE.ka();e-=f;d=(d.y-f)/e;a=0>d?this.qOb.i9(a,b):this.L1b(a,b)}else a=this.L1b(a,b);return a};c.prototype.BW=function(){var a=(this.ABa.x+this.ZCa.x)/
2,b=(this.ABa.y+this.ZCa.y)/2,d=(this.xBa.x+this.WCa.x)/2,e=(this.xBa.y+this.WCa.y)/2;return Math.sqrt((a-d)*(a-d)+(b-e)*(b-e))};c.prototype.contains=function(a,b,d){var e=new M,f=this.Gf();if(0<=a.c9(this.bd(),this.Wf(),e,e)&&0<=a.c9(this.Vf(),this.nf(),e,e))return b>f.ka()&&(b=f.ka()),d<f.ma()&&(d=f.ma()),{Of:b,Nf:d,contain:!0};var g=this.nc(a.bd()),h=this.nc(a.Wf());e=this.nc(a.nf());a=this.nc(a.Vf());g=new U(g.getX(),g.getY(),h.getX(),h.getY());g.union(new U(e.getX(),e.getY(),a.getX(),a.getY()));
g.intersect(f);return g.isEmpty()?{Of:b,Nf:d,contain:!1}:(b>g.ka()&&(b=g.ka()),d<g.ma()&&(d=g.ma()),{Of:b,Nf:d,contain:!0})};c.prototype.transform=Fb;c.prototype.mF=Fb;c.prototype.mya=Fb;c.prototype.eX=Fb;c.prototype.fX=Fb;return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJ0cmFuc2Zvcm1MaW5lIjoibUYiLCJ0cmFuc2Zvcm1MaW5lUmV2IjoibXlhIiwic2NhbGVYQXQiOiJlWCIsInNjYWxlWUF0IjoiZlgifX19");var NO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(e,f,g){var h=(g-f)/100;if(f<=e&&e<=g)return e;if(e<f){if(f-e<h)return f}else if(e-g<h)return g;return NaN}function a(e,f,g){MO.call(this,f,g);this.DL=null;this.Rc=new W;null!=e&&this.Rc.Tb(e);this.im=new W;this.WY=new M;this.c8=new M;this.iNb=2;this.jka=new M}var b=HO,d=JO;D(a,MO);L(a,"geotoolkit.deviation.LinearTrajectoryStation");a.prototype.HAd=function(){return this.iNb};a.prototype.Brb=function(){this.iNb--};a.prototype.Gse=function(){this.iNb++};a.prototype.BW=function(){return M.Uf(this.WY,
this.c8)};a.prototype.KOd=function(){return this.WY};a.prototype.Cid=function(){return this.c8};a.prototype.D_=function(){return this.DL=this.DL||this.Rc.rc()};a.prototype.Fa=function(){return this.Rc};a.prototype.Tb=function(e){this.Rc.Tb(e);this.DL=null;this.rTb()};a.prototype.Pve=function(e){this.im.Tb(e)};a.prototype.offset=function(e){MO.prototype.offset.call(this,e);var f=e.getX();e=e.getY();this.Rc.cB(this.Rc.hf()+f,this.Rc.We()+e);this.t$()&&this.im.cB(this.im.hf()+f,this.im.We()+e);this.DL=
null;this.WY.Ga(this.WY.getX()+f,this.WY.getY()+e);this.c8.Ga(this.c8.getX()+f,this.c8.getY()+e)};a.prototype.contains=function(e,f,g){if(e instanceof U)return MO.prototype.contains.call(this,e,f,g);if(!this.t$()){g=this.D_().Ma(e);var h=this.Gf();if(h.contains(g))return f&&f.Ga(g.getX(),g.getY()),!0;e=c(g.getX(),h.la(),h.na());if(!V.Xp(e))return!1;g=c(g.getY(),h.ka(),h.ma());if(!V.Xp(g))return!1;f&&f.Ga(e,g);return!0}if(this.bd().getY()<=this.Vf().getY()===this.Wf().getY()<=this.nf().getY())return b.qFc(e,
this.Vf(),this.nf(),this.Wf(),this.bd());f=new M;return b.Gla(this.bd(),this.Wf(),this.Vf(),this.nf(),f)?b.Yvb(e,this.bd(),this.Vf(),f)||b.Yvb(e,this.Wf(),this.nf(),f):!1};a.prototype.nc=function(e){if(!this.t$())return this.D_().Ma(e);var f=new M,g=new M;if(!b.Gla(this.bd(),this.Wf(),this.Vf(),this.nf(),f)||!b.Gla(this.WY,this.c8,f,e,g))return e.clone();if(g.getY()<Math.min(this.WY.getY(),this.c8.getY()))return this.Gf().bd();if(g.getY()>Math.max(this.WY.getY(),this.c8.getY()))return this.Gf().nf();
f=b.getLength(this.jka.Ga(this.c8.getX()-this.WY.getX(),this.c8.getY()-this.WY.getY()));g=Math.abs(f)>V.Qb?b.getLength(this.jka.Ga(g.getX()-this.WY.getX(),g.getY()-this.WY.getY()))/f:Number.MAX_VALUE;f=g*this.Rc.pb()+(1-g)*this.im.pb();e=Math.abs(f)<=V.Qb?Number.MAX_VALUE:(e.getX()-g*(this.Rc.Yi()*this.Gf().ma()+this.Rc.hf())-(1-g)*(this.im.Yi()*this.Gf().ka()+this.im.hf()))/f;g=g*this.Gf().ma()+(1-g)*this.Gf().ka();return new M(e,g)};a.prototype.transform=function(e){if(!this.t$())return this.Rc.Ma(e);
var f=this.Gf().ma(),g=this.Gf().ka(),h=f-g;if(Math.abs(h)<V.Qb)return e.getY()<g?this.im.Ma(e):this.Rc.Ma(e);h=(e.getY()-g)/h;if(0>=h)return this.im.Ma(e);if(1<=h)return this.Rc.Ma(e);var k=this.im.pb()*e.getX()+this.im.Yi()*g+this.im.hf(),l=this.Rc.pb()*e.getX()+this.Rc.Yi()*f+this.Rc.hf();g=this.im.Ji()*e.getX()+this.im.Ab()*g+this.im.We();e=this.Rc.Ji()*e.getX()+this.Rc.Ab()*f+this.Rc.We();return new M((l-k)*h+k,(e-g)*h+g)};a.prototype.update=function(){MO.prototype.update.call(this);this.DL=
null;var e=this.Gf(),f=this.t$()?this.im:this.Rc;this.WY=f.Ma(new M(e.cc(),e.ka()));this.c8=this.Rc.Ma(new M(e.cc(),e.ma()));this.T6b(f.Ma(e.bd()));this.N7b(f.Ma(e.Wf()));this.J7b(this.Rc.Ma(e.nf()));this.Q6b(this.Rc.Ma(e.Vf()));0===this.Rc.pb()?this.FIa(Math.abs(this.Rc.Ji())):0===this.Rc.Ji()?this.FIa(Math.abs(this.Rc.pb())):this.FIa(Math.sqrt(this.Rc.pb()*this.Rc.pb()+this.Rc.Ji()*this.Rc.Ji()));0===this.Rc.Ab()?this.GIa(Math.abs(this.Rc.Yi())):0===this.Rc.Yi()?this.GIa(Math.abs(this.Rc.Ab())):
this.GIa(Math.sqrt(this.Rc.Ab()*this.Rc.Ab()+this.Rc.Yi()*this.Rc.Yi()));this.t$()&&(0===this.im.pb()?this.FIa(Math.max(this.JW(),Math.abs(this.im.Ji()))):0===this.im.Ji()?this.FIa(Math.max(this.JW(),Math.abs(this.im.pb()))):this.FIa(Math.max(this.JW(),Math.sqrt(this.im.pb()*this.im.pb()+this.im.Ji()*this.im.Ji()))),0===this.im.Ab()?this.GIa(Math.max(this.KW(),Math.abs(this.im.Yi()))):0===this.im.Yi()?this.GIa(Math.max(this.KW(),Math.abs(this.im.Ab()))):this.GIa(Math.max(this.KW(),Math.sqrt(this.im.Ab()*
this.im.Ab()+this.im.Yi()*this.im.Yi()))))};a.prototype.eX=function(e){if(!this.t$())return 0===this.Rc.pb()?Math.abs(this.Rc.Ji()):0===this.Rc.Ji()?Math.abs(this.Rc.pb()):Math.sqrt(this.Rc.pb()*this.Rc.pb()+this.Rc.Ji()*this.Rc.Ji());e=this.yqc(e);return 0===e.pb()?Math.abs(e.Ji()):0===e.Ji()?Math.abs(e.pb()):Math.sqrt(e.pb()*e.pb()+e.Ji()*e.Ji())};a.prototype.fX=function(e){if(!this.t$())return 0===this.Rc.Ab()?Math.abs(this.Rc.Yi()):0===this.Rc.Yi()?Math.abs(this.Rc.Ab()):Math.sqrt(this.Rc.Ab()*
this.Rc.Ab()+this.Rc.Yi()*this.Rc.Yi());e=this.yqc(e);return 0===e.Ab()?Math.abs(e.Yi()):0===e.Yi()?Math.abs(e.Ab()):Math.sqrt(e.Ab()*e.Ab()+e.Yi()*e.Yi())};a.prototype.yqc=function(e){if(!this.t$())return this.Rc;var f=this.Gf().ma(),g=this.Gf().ka(),h=f-g;if(Math.abs(h)<V.Qb)return e.getY()<g?this.im:this.Rc;var k=(e.getY()-g)/h;if(0>=k)return this.im;if(1<=k)return this.Rc;if(Math.abs(e.getY())<=V.Qb){e=this.Rc.Yi()*f+this.Rc.hf();var l=this.Rc.Ab()*f+this.Rc.We(),m=this.im.Yi()*g+this.im.hf(),
n=this.im.Ab()*g+this.im.We();return new W(this.Rc.pb()*k+this.im.pb()*(1-k),this.Rc.Ji()*k+this.im.Ji()*(1-k),(e-m)/h,(l-n)/h,(m*f-e*g)/h,(n*f-l*g)/h)}return new W(this.Rc.pb()*k+this.im.pb()*(1-k),this.Rc.Ji()*k+this.im.Ji()*(1-k),(this.Rc.Yi()*k*f+this.im.Yi()*(1-k)*g)/e.getY(),(this.Rc.Ab()*k*f+this.im.Ab()*(1-k)*g)/e.getY(),this.Rc.hf()*k+this.im.hf()*(1-k),this.Rc.We()*k+this.im.We()*(1-k))};a.prototype.mF=function(e,f,g,h,k){var l=this.Gf(),m=V.Qb;l.ka()<=e.getY()+m&&l.ma()>=e.getY()-m&&b.Mq(h,
this.transform(e),g,k);l.ka()>e.getY()-m&&l.ka()<f.getY()+m&&b.Mq(h,this.transform(b.SP(e,f,l.ka())),g,k);l.ma()>e.getY()-m&&l.ma()<f.getY()+m&&b.Mq(h,this.transform(b.SP(e,f,l.ma())),g,k);l.ka()<=f.getY()+m&&l.ma()>=f.getY()-m&&b.Mq(h,this.transform(f),g,k)};a.prototype.mya=function(e,f,g,h,k){var l=this.Gf();l.ka()<=e.getY()&&l.ma()>=e.getY()&&b.Mq(h,this.transform(e),g,k);l.ma()>f.getY()&&l.ma()<e.getY()&&b.Mq(h,this.transform(b.SP(e,f,l.ma())),g,k);l.ka()>f.getY()&&l.ka()<e.getY()&&b.Mq(h,this.transform(b.SP(e,
f,l.ka())),g,k);l.ka()<=f.getY()&&l.ma()>=f.getY()&&b.Mq(h,this.transform(f),g,k)};a.jUc=function(e,f,g,h,k,l,m){m=0;if(e.t$()||f.t$())return{tooShort:m,tUa:g,NQa:!1};var n=b.tRd(new M(f.Vf().getX()-f.bd().getX(),f.Vf().getY()-f.bd().getY()),new M(e.Vf().getX()-e.bd().getX(),e.Vf().getY()-e.bd().getY()));if(Math.abs(n)<V.Qb)return{tooShort:m,tUa:g,NQa:!1};if(g=0>n){n=new d(e.bd(),e.Vf());var p=new d(f.bd(),f.Vf())}else n=new d(e.Wf(),e.nf()),p=new d(f.Wf(),f.nf());if(d.Gbd(n,p))return{tooShort:m,
tUa:g,NQa:!1};n=d.pLc(p,n);h.Ga(n.getX(),n.getY());n=e.nc(h);k.Ga(n.getX(),n.getY());n=f.nc(h);l.Ga(n.getX(),n.getY());if(e.yf()>=k.getY()||f.ng()<=l.getY())return m=e.yf()>=k.getY()?f.ng()<=l.getY()?-3:-2:-1,{tooShort:m,tUa:g,NQa:!1};e.ng()<k.getY()&&f.yf()>l.getY()&&(m=1);return{tooShort:m,tUa:g,NQa:!0}};return a}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoibmMiLCJzY2FsZVhBdCI6ImVYIiwic2NhbGVZQXQiOiJmWCIsInRyYW5zZm9ybUxpbmUiOiJtRiIsInRyYW5zZm9ybUxpbmVSZXYiOiJteWEifX19");var OO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(){MO.call(this,new U,!0);this.xe=[];this.ou=this.wm=null;this.aca=0;this.Re=[];this.sg=[];this.rO=[];this.BR=[];this.u8=this.C7=0;this.FIa(1);this.GIa(1);this.Gr=[];this.Cb=new M;this.JLb=!1;this.ei=new M;this.Ikc=new M;this.Jkc=new M;this.wmb=this.xmb=0;this.Sa=new U}function a(l,m,n,p,q){return k.Gla(l,m,n,p,q)?b(l,m,q)?b(n,p,q)?3:1:b(n,p,q)?2:0:-1}function b(l,m,n){if(l.getY()<m.getY()){if(n.getY()<l.getY()||n.getY()>m.getY())return!1}else if(n.getY()>l.getY()||n.getY()<
m.getY())return!1;if(l.getX()<m.getX()){if(n.getX()<l.getX()||n.getX()>m.getX())return!1}else if(n.getX()>l.getX()||n.getX()<m.getX())return!1;return!0}function d(l,m){return l.key>=m.key?1:-1}function e(l,m,n,p,q,r,t,u){M.Uf(t,m)<M.Uf(p,m)||M.Uf(t,m)<M.Uf(q,m)||(m=f(m,p,q,t,u),0<m&&l.push({key:m,point:t}))}function f(l,m,n,p,q){l=k.aTb(m,l,p);if(0>q){if(0>l&&l>q)return-l}else if(0<l&&l<q)return l;return 0}function g(l,m,n){return new M(h(l,m,n),n)}function h(l,m,n){return Math.abs(l.getY()-n)<=V.Qb?
l.getX():Math.abs(m.getY()-n)<=V.Qb?m.getX():Math.abs(l.getY()-m.getY())<=V.Qb?(l.getX()+m.getX())/2:l.getX()+(m.getX()-l.getX())*(n-l.getY())/(m.getY()-l.getY())}var k=HO;D(c,MO);L(c,"geotoolkit.deviation.OutlineTrajectoryStation");c.wfd=function(l,m,n,p,q){q=new c;q.ou=l;q.wm=m;if(!q.jQd())return n=q.kyc(),{nBb:null,tooShort:n};n=q.kyc();q.xe=q.xe.concat(p);q.update();return{nBb:q,tooShort:n}};c.prototype.kyc=function(){return this.aca};c.prototype.ga=function(){return this.Sa};c.prototype.append=
function(l,m,n,p){l=l.clone();m=m.clone();if(n)if(0<this.Re.length&&0<this.sg.length){var q=M.Uf(l,this.Re[this.Re.length-1]);var r=M.Uf(m,this.sg[this.sg.length-1]);if(1>q&&1>r)return;var t=new M;if(1<this.Re.length&&1<this.sg.length&&(1<q&&0<a(l,this.Re[this.Re.length-1],this.Re[0],n,t)||1<r&&0<a(m,this.sg[this.sg.length-1],this.sg[0],p,t)))return;if(1<Math.abs(q-r)&&(2<q||2<r)){p=(n=q>r)?k.$E(q):k.$E(r);t=this.Re[this.Re.length-1];var u=this.sg[this.sg.length-1],w=M.Uf(this.Re[this.Re.length-1],
this.sg[this.sg.length-1]);q=(M.Uf(l,m)-w)/(n?q:r);r=t.clone();for(var y=u.clone(),A=1;A<p;++A){w+=q;n?r=new M(t.getX()+(l.getX()-t.getX())*A/p,t.getY()+(l.getY()-t.getY())*A/p):y=new M((m.getX()*A+u.getX()*(p-A))/p,(m.getY()*A+u.getY()*(p-A))/p);var x=M.Uf(r,y);x<w+1&&(n?r=new M((y.getX()*(x-w)+r.getX()*w)/x,(y.getY()*(x-w)+r.getY()*w)/x):y=new M((r.getX()*(x-w)+y.getX()*w)/x,(r.getY()*(x-w)+y.getY()*w)/x));this.rO.push(M.Uf(r,this.Re[this.Re.length-1]));this.C7+=this.rO[this.rO.length-1];this.BR.push(M.Uf(y,
this.sg[this.sg.length-1]));this.u8+=this.BR[this.BR.length-1];this.Re.push(r);this.sg.push(y);this.Sa.union(new U(r.getX(),r.getY(),y.getX(),y.getY()))}q=M.Uf(l,this.Re[this.Re.length-1]);r=M.Uf(m,this.sg[this.sg.length-1])}this.rO.push(q);this.C7+=this.rO[this.rO.length-1];this.BR.push(r);this.u8+=this.BR[this.BR.length-1];this.Sa.union(new U(l.getX(),l.getY(),m.getX(),m.getY()))}else this.Sa=new U(l.getX(),l.getY(),m.getX(),m.getY());else if(0<this.Re.length&&0<this.sg.length){q=M.Uf(l,this.Re[this.Re.length-
1]);r=M.Uf(m,this.sg[this.sg.length-1]);if(1>q&&1>r)return;this.rO.push(q);this.C7+=this.rO[this.rO.length-1];this.BR.push(r);this.u8+=this.BR[this.BR.length-1];0<this.Re.length&&0<this.sg.length?this.Sa.union(new U(l.getX(),l.getY(),m.getX(),m.getY())):this.Sa=new U(l.getX(),l.getY(),m.getX(),m.getY())}this.Re.push(l);this.sg.push(m)};c.prototype.prepend=function(l,m){if(0<this.Re.length&&0<this.sg.length){var n=M.Uf(l,this.Re[0]),p=M.Uf(m,this.sg[0]);if(1>n&&1>p)return;this.rO.unshift(n);this.C7+=
this.rO[0];this.BR.unshift(p);this.u8+=this.BR[0];0<this.Re.length&&0<this.sg.length?this.Sa.union(new U(l.getX(),l.getY(),m.getX(),m.getY())):this.Sa=new U(l.getX(),l.getY(),m.getX(),m.getY())}this.Re.unshift(l);this.sg.unshift(m)};c.prototype.jQd=function(){var l=NO.jUc(this.ou,this.wm,this.JLb,this.ei,this.Jkc,this.Ikc,this.aca);this.aca=l.tooShort;this.JLb=l.tUa;if(!l.NQa)return!1;this.wmb=this.ou.ng();this.xmb=this.wm.yf();this.ou.$6b(this.Jkc.getY());this.wm.b7b(this.Ikc.getY());this.aca=0;
this.Mxa(new U(this.ou.Gf().la(),this.ou.Gf().ma(),this.wm.Gf().na(),this.wm.Gf().ka()));return!0};c.prototype.reset=function(){this.ou.$6b(this.wmb);this.wm.b7b(this.xmb)};c.prototype.BW=function(){return(this.C7+this.u8)/2};c.prototype.ntc=function(l){if(0===this.Re.length||0>=this.Gf().da()||0>=this.Gf().ca())return-1;l=new M(l.getX()-this.Cb.getX(),l.getY()-this.Cb.getY());if(Math.abs(l.getX()-h(this.Re[0],this.sg[0],l.getY()))<=V.Qb)return 0;for(var m=1;m<this.Re.length;++m)if(this.Re[m-1].getX()===
this.Re[m].getX()&&this.Re[m-1].getY()===this.Re[m].getY()){if(k.Yvb(l,this.Re[m],this.sg[m],this.sg[m-1]))return m}else if(this.sg[m-1].getX()===this.sg[m].getX()&&this.sg[m-1].getY()===this.sg[m].getY()){if(k.Yvb(l,this.sg[m],this.Re[m],this.Re[m-1]))return m}else if(k.qFc(l,this.sg[m-1],this.sg[m],this.Re[m],this.Re[m-1]))return m;return-1};c.prototype.contains=function(l,m,n){if(l instanceof M)return 0<=this.ntc(l);var p=new M,q=new M;l=new U(l.bd().getX()-this.Cb.getX(),l.bd().getY()-this.Cb.getY(),
l.nf().getX()-this.Cb.getX(),l.nf().getY()-this.Cb.getY());for(var r=!1,t=!1,u=0,w=this.Re.length-1,y=u,A=w;(!1===r||!1===t)&&u<w;){if(!r){if(t&&(A>w&&(A=w),u>=A)){u>A&&(u=A);r=!0;break}if(0<=l.c9(this.Re[u],this.sg[u],p,q))u-1<=y?r=!0:(A=u,u=k.$E((u+y)/2));else if(t)if(u+1>=A){u=A;r=!0;break}else y=u,u=k.$E((u+A)/2);else u++}if(!t){if(r&&(y<u&&(y=u),w<=y)){w<y&&(w=y);t=!0;break}if(0<=l.c9(this.Re[w],this.sg[w],p,q))w+1>=A?t=!0:(y=w,w=k.$E((w+A)/2));else if(r)if(w-1<=y){w=y;t=!0;break}else A=w,w=
k.$E((w+y)/2);else w--}}if(!r&&!t)return{Of:m,Nf:n,contain:!1};r&&(0<u&&u--,m>this.Gr[u]&&(m=this.Gr[u]));t&&(w<this.Gr.length-1&&w++,n<this.Gr[w]&&(n=this.Gr[w]));return{Of:m,Nf:n,contain:!0}};c.prototype.update=function(){MO.prototype.update.call(this);this.rO=[];this.BR=[];this.u8=this.C7=0;if(!(0>this.aca)){var l=[],m;if(this.JLb){var n=k.aTb(this.ou.nf(),this.ei,this.wm.Wf());0===this.aca&&e(l,this.ei,this.ou.Wf(),this.ou.nf(),this.wm.Wf(),this.wm.nf(),this.ou.transform(new M(this.Gf().na(),
this.wmb)),n);for(m=0;m<this.xe.length;++m)e(l,this.ei,this.ou.Wf(),this.ou.nf(),this.wm.Wf(),this.wm.nf(),this.xe[m].Wf(),n),e(l,this.ei,this.ou.Wf(),this.ou.nf(),this.wm.Wf(),this.wm.nf(),this.xe[m].nf(),n);0===this.aca&&e(l,this.ei,this.ou.Wf(),this.ou.nf(),this.wm.Wf(),this.wm.nf(),this.wm.transform(new M(this.Gf().na(),this.xmb)),n);l.sort(d);this.append(this.ei,this.ou.nf());if(0===l.length)this.append(this.ei,this.wm.Wf(),this.ei,this.wm.Wf());else{this.append(this.ei,l[0].point);for(n=1;n<
l.length;n++)this.append(this.ei,l[n].point,this.ei,this.wm.Wf());this.append(this.ei,this.wm.Wf())}}else{n=k.aTb(this.ou.Vf(),this.ei,this.wm.bd());0===this.aca&&e(l,this.ei,this.ou.bd(),this.ou.Vf(),this.wm.bd(),this.wm.Vf(),this.ou.transform(new M(this.Gf().la(),this.wmb)),n);for(m=0;m<this.xe.length;++m)e(l,this.ei,this.ou.bd(),this.ou.Vf(),this.wm.bd(),this.wm.Vf(),this.xe[m].bd(),n),e(l,this.ei,this.ou.bd(),this.ou.Vf(),this.wm.bd(),this.wm.Vf(),this.xe[m].Vf(),n);0===this.aca&&e(l,this.ei,
this.ou.bd(),this.ou.Vf(),this.wm.bd(),this.wm.Vf(),this.wm.transform(new M(this.Gf().la(),this.xmb)),n);l.sort(d);this.append(this.ou.Vf(),this.ei);if(0===l.length)this.append(this.wm.bd(),this.ei,this.wm.bd(),this.ei);else{this.append(l[0].point,this.ei);for(n=1;n<l.length;n++)this.append(l[n].point,this.ei,this.wm.bd(),this.ei);this.append(this.wm.bd(),this.ei)}}}};c.prototype.AVc=function(){if(!(0>this.aca||(this.Mxa(new U(this.ou.Gf().la(),this.ou.Gf().ma(),this.wm.Gf().na(),this.wm.Gf().ka())),
this.Gr=[],1>=this.Re.length||(this.T6b(new M(this.Re[0].getX()+this.Cb.getX(),this.Re[0].getY()+this.Cb.getY())),this.N7b(new M(this.sg[0].getX()+this.Cb.getX(),this.sg[0].getY()+this.Cb.getY())),this.J7b(new M(this.sg[this.sg.length-1].getX()+this.Cb.getX(),this.sg[this.sg.length-1].getY()+this.Cb.getY())),this.Q6b(new M(this.Re[this.Re.length-1].getX()+this.Cb.getX(),this.Re[this.Re.length-1].getY()+this.Cb.getY())),0>=this.Gf().da()||0>=this.Gf().ca())))){var l=this.Gf().ka();this.Gr.push(l);
for(var m=0;m<this.rO.length-1;++m){var n=(this.rO[m]+this.BR[m])/(this.C7+this.u8);l+=n*this.Gf().da();if(l>this.Gf().ma())break;this.Gr.push(l)}this.Gr.push(this.Gf().ma())}};c.prototype.J7a=function(l){if(0>=this.Gf().da()||1>=this.Gr.length)return-1;var m=0,n=this.Gr.length-1;if(l.getY()<=this.Gr[0])return 0;if(l.getY()>=this.Gr[n])return n;for(var p;1<n-m;){var q=m+n>>1;p=this.Gr[q]-l.getY();if(Math.abs(p)<=V.Qb)return q;0>p?m=q:n=q}return n};c.prototype.transform=function(l,m){if(null==m){if(l.getY()>=
this.Gf().ka()&&l.getY()<=this.Gf().ma()){var n=new M;m=this.Gf();var p=(l.getX()-m.la())/m.ca();if(Math.abs(l.getY()-m.ka())<=V.Qb)n.setX(this.Re[0].getX()+(this.sg[0].getX()-this.Re[0].getX())*p),n.setY(this.Re[0].getY()+(this.sg[0].getY()-this.Re[0].getY())*p);else if(Math.abs(l.getY()-m.ma())<=V.Qb)n.setX(this.Re[this.Re.length-1].getX()+(this.sg[this.sg.length-1].getX()-this.Re[this.Re.length-1].getX())*p),n.setY(this.Re[this.Re.length-1].getY()+(this.sg[this.sg.length-1].getY()-this.Re[this.Re.length-
1].getY())*p);else if(m=this.J7a(l),0<m&&m<this.Re.length){var q=(l.getY()-this.Gr[m-1])/(this.Gr[m]-this.Gr[m-1]);l=new M(this.Re[m-1].getX()+(this.Re[m].getX()-this.Re[m-1].getX())*q,this.Re[m-1].getY()+(this.Re[m].getY()-this.Re[m-1].getY())*q);m=new M(this.sg[m-1].getX()+(this.sg[m].getX()-this.sg[m-1].getX())*q,this.sg[m-1].getY()+(this.sg[m].getY()-this.sg[m-1].getY())*q);n.setX(l.getX()+(m.getX()-l.getX())*p);n.setY(l.getY()+(m.getY()-l.getY())*p)}else n.setX(this.Re[0].getX()+(this.sg[0].getX()-
this.Re[0].getX())*p),n.setY(this.Re[0].getY()+(this.sg[0].getY()-this.Re[0].getY())*p);return new M(n.getX()+this.Cb.getX(),n.getY()+this.Cb.getY())}return l}if(0>=this.Gf().da()||1>=this.Gr.length)return l;p=(l.getX()-this.Gf().la())/this.Gf().ca();n=new M;Math.abs(this.Gr[m]-l.getY())<=V.Qb||0>=m?(n.setX(this.Re[m].getX()+(this.sg[m].getX()-this.Re[m].getX())*p),n.setY(this.Re[m].getY()+(this.sg[m].getY()-this.Re[m].getY())*p)):(q=(l.getY()-this.Gr[m-1])/(this.Gr[m]-this.Gr[m-1]),l=new M(this.Re[m-
1].getX()+(this.Re[m].getX()-this.Re[m-1].getX())*q,this.Re[m-1].getY()+(this.Re[m].getY()-this.Re[m-1].getY())*q),m=new M(this.sg[m-1].getX()+(this.sg[m].getX()-this.sg[m-1].getX())*q,this.sg[m-1].getY()+(this.sg[m].getY()-this.sg[m-1].getY())*q),n.setX(l.getX()+(m.getX()-l.getX())*p),n.setY(l.getY()+(m.getY()-l.getY())*p));return new M(n.getX()+this.Cb.getX(),n.getY()+this.Cb.getY())};c.prototype.mF=function(l,m,n,p,q){if(!(0>=this.Gf().da()||this.Gf().ka()>=m.getY()||this.Gf().ma()<=l.getY()||
1>=this.Gr.length)){var r=this.J7a(l),t=this.J7a(m);0===r?(k.Mq(p,this.transform(g(l,m,this.Gr[0]),0),n,q),++r):k.Mq(p,this.transform(l,r),n,q);for(;r<t;++r){var u=g(l,m,this.Gr[r]);k.Mq(p,this.transform(u,r),n,q)}this.Gr[t]<m.getY()?k.Mq(p,this.transform(g(l,m,this.Gr[t]),t),n,q):k.Mq(p,this.transform(m,t),n,q)}};c.prototype.mya=function(l,m,n,p,q){if(!(0>=this.Gf().da()||this.Gf().ka()>=l.getY()||this.Gf().ma()<=m.getY()||1>=this.Gr.length)){var r=this.J7a(l),t=this.J7a(m);for(this.Gr[r]<l.getY()?
k.Mq(p,this.transform(g(l,m,this.Gr[r]),r),n,q):k.Mq(p,this.transform(l,r),n,q);r>t;--r){var u=g(l,m,this.Gr[r-1]);k.Mq(p,this.transform(u,r-1),n,q)}0<t&&k.Mq(p,this.transform(m,t),n,q)}};c.prototype.nc=function(l){if(0>=this.Gf().da()||1>=this.Gr.length)return new M(l.getX()-this.Cb.getX(),l.getY()-this.Cb.getY());var m=this.ntc(l);if(0>m)return new M(l.getX()-this.Cb.getX(),l.getY()-this.Cb.getY());var n=this.Gf(),p=n.bd();l=new M(l.getX()-this.Cb.getX(),l.getY()-this.Cb.getY());if(0===m)p.setX(p.getX()+
n.ca()*M.Uf(this.Re[0],l)/M.Uf(this.Re[0],this.sg[0]));else{p.setY(this.Gr[m-1]);var q=this.Gr[m]-this.Gr[m-1],r=new M;if(this.Re[m-1].getX()===this.Re[m].getX()&&this.Re[m-1].getY()===this.Re[m].getY())k.Gla(this.Re[m],l,this.sg[m-1],this.sg[m],r)&&(p.setY(p.getY()+q*M.Uf(r,this.sg[m-1])/this.BR[m-1]),p.setX(p.getX()+n.ca()*M.Uf(l,this.Re[m])/M.Uf(r,this.Re[m])));else if(this.sg[m-1].getX()===this.sg[m].getX()&&this.sg[m-1].getY()===this.sg[m].getY())k.Gla(this.sg[m],l,this.Re[m-1],this.Re[m],r)&&
(p.setY(p.getY()+q*M.Uf(r,this.Re[m-1])/this.rO[m-1]),p.setX(p.getX()+n.ca()*M.Uf(l,r)/M.Uf(r,this.sg[m])));else{var t=new M,u=new M;k.Gla(this.Re[m-1],this.sg[m-1],this.Re[m],this.sg[m],r)||r.Ga(l.getX()-this.sg[m-1].getX()+this.Re[m-1].getX(),l.getY()-this.sg[m-1].getY()+this.Re[m-1].getY());k.Gla(r,l,this.Re[m-1],this.Re[m],t)&&k.Gla(r,l,this.sg[m-1],this.sg[m],u)&&(p.setY(p.getY()+q*(M.Uf(t,this.Re[m-1])/this.rO[m-1]+M.Uf(u,this.sg[m-1])/this.BR[m-1])/2),p.setX(p.getX()+n.ca()*M.Uf(l,t)/M.Uf(u,
t)))}}return p};c.prototype.eX=function(l){var m=l.clone();m.setX(m.getX()+1);return Math.abs(this.nc(m).getX()-this.nc(l).getX())};c.prototype.fX=function(l){var m=l.clone();m.setY(m.getY()+1);return Math.abs(this.nc(m).getY()-this.nc(l).getY())};c.prototype.offset=function(l){this.Cb.Ga(this.Cb.getX()+l.getX(),this.Cb.getY()+l.getY());MO.prototype.offset.call(this,l)};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJ0cmFuc2Zvcm1MaW5lIjoibUYiLCJ0cmFuc2Zvcm1MaW5lUmV2IjoibXlhIiwiaW52ZXJzZVRyYW5zZm9ybSI6Im5jIiwic2NhbGVYQXQiOiJlWCIsInNjYWxlWUF0IjoiZlgifX19");var PO=/*#__PURE__*/function(){function c(b){this.DPb=b}function a(b,d,e){this.tt=b;this.qbb=d;this.qwa=void 0!==e?e:-1}L(c,"geotoolkit.deviation.PiecewiseApproximator");c.prototype.tSb=function(b,d){var e=[];e.push(new a(b,this.DPb.transform(b),1));e.push(new a(d,this.DPb.transform(d),-1));for(b=0;-1!==e[b].qwa;){d=e[b];var f=e[d.qwa],g=M.Uf(d.qbb,f.qbb);if(1>g)b=d.qwa;else{var h=new M((d.tt.getX()+f.tt.getX())/2,(d.tt.getY()+f.tt.getY())/2),k=this.DPb.transform(h),l=d.qwa;f=new JO(d.qbb,f.qbb);g=f.distance(k);
.5>Math.abs(g)?b=d.qwa:(d.qwa=e.length,e.push(new a(h,k,l)))}}return e};return c}();var QO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(){MO.call(this,new U,!0);this.VN=this.bAa=this.$Ob=this.Bib=this.wc=this.bla=this.ala=this.bOa=this.FOa=this.ei=this.hmb=this.Zmb=null;this.K4c=new PO(this);this.$f=this.c2=null;this.gj=NaN;this.Sa=null}var a=HO,b=JO;L(c,"geotoolkit.deviation.PieSliceTrajectoryStation");D(c,MO);c.prototype.BW=function(){return this.gj};c.prototype.ga=function(){return this.Sa};c.zfd=function(d,e,f){var g=new M,h=new M,k=new M,l=NO.jUc(d,e,m,g,h,k,f);var m=l.tUa;f=l.tooShort;if(!l.NQa)return{nBb:null,
tooShort:f};d.$6b(h.getY());e.b7b(k.getY());h=m?d.nf():d.Vf();k=new M(h.getX()-g.getX(),h.getY()-g.getY());h=m?e.Wf():e.bd();h=new M(h.getX()-g.getX(),h.getY()-g.getY());l=Math.atan2(k.getY(),k.getX());var n=W.Xi(-l,0,0),p=W.cf(-g.getX(),-g.getY());p=W.multiply(n,p);n=n.Ma(h);h=new c;h.bAa=Math.atan2(n.getY(),n.getX());h.Bib=p;h.$Ob=p.rc();m?(h.ala=d.Gf().la(),h.bla=d.Gf().na()-h.ala):(h.ala=d.Gf().na(),h.bla=d.Gf().la()-h.ala);h.ei=g;h.wc=M.Uf(k,new M(0,0));h.VN=l;h.T6b(d.Vf());h.N7b(d.nf());h.Q6b(e.bd());
h.J7b(e.Wf());h.gj=Math.abs(h.wc*h.bAa/2);h.Mxa(new U(d.Gf().Vf().getX(),d.Gf().Vf().getY(),e.Gf().Wf().getX(),e.Gf().Wf().getY()));k=new b(g,m?d.nf():d.Vf());l=new b(g,m?e.Wf():e.bd());0<k.distance(m?e.Wf():e.bd())?(h.Zmb=k,h.hmb=l,m?(m=d.nf(),k=e.Wf()):(m=d.Vf(),k=e.bd())):(h.Zmb=l,h.hmb=k,m?(k=d.nf(),m=e.Wf()):(k=d.Vf(),m=e.bd()));h.FOa=new M(m.getX(),m.getY());h.bOa=new M(k.getX(),k.getY());h.Sa=new U(d.Vf().getX(),d.Vf().getY(),d.nf().getX(),d.nf().getY());h.Sa.union(new U(e.bd().getX(),e.bd().getY(),
e.Wf().getX(),e.Wf().getY()));d=new M(g.getX()-h.wc,g.getY());h.contains(d)&&h.Sa.la()>d.getX()&&h.Sa.setX(d.getX());d=new M(g.getX()+h.wc,g.getY());h.contains(d)&&h.Sa.na()<d.getX()&&h.Sa.Ra(d.getX()-h.Sa.la());d=new M(g.getX(),g.getY()-h.wc);h.contains(d)&&h.Sa.ka()>d.getY()&&h.Sa.setY(d.getY());g=new M(g.getX(),g.getY()+h.wc);h.contains(g)&&h.Sa.ma()<g.getY()&&h.Sa.Ya(g.getY()-h.Sa.ka());return{nBb:h,tooShort:f}};c.prototype.update=function(d,e){this.Mxa(new U(d.Gf().la(),d.ng(),d.Gf().na(),e.yf()))};
c.prototype.offset=function(d){MO.prototype.offset.call(this,d);var e=d.getX();d=d.getY();this.ei.Ga(this.ei.getX()+e,this.ei.getY()+d);this.FOa.Ga(this.FOa.getX()+e,this.FOa.getY()+d);this.bOa.Ga(this.bOa.getX()+e,this.bOa.getY()+d);e=W.Xi(-this.VN,0,0);d=W.cf(-this.ei.getX(),-this.ei.getY());this.Bib=W.multiply(e,d);this.$Ob=this.Bib.rc();this.Zmb.Oq(this.ei,this.FOa);this.hmb.Oq(this.ei,this.bOa)};c.prototype.contains=function(d,e,f){if(d instanceof M)return M.Uf(this.ei,d)-this.wc<V.Qb&&0<this.Zmb.distance(d)&&
0>this.hmb.distance(d);var g=this.Gf();if(d.contains(this.ei)||d.contains(this.FOa)&&d.contains(this.bOa))return e>g.ka()&&(e=g.ka()),f<g.ma()&&(f=g.ma()),{Of:e,Nf:f,contain:!0};g=this.ei.clone();this.ei.getY()<d.ka()?g.setY(d.ka()):this.ei.getY()>d.ma()&&g.setY(d.ma());this.ei.getX()<d.la()?g.setX(d.la()):this.ei.getX()>d.na()&&g.setX(d.na());if(M.Uf(this.ei,g)>this.wc)return{Of:e,Nf:f,contain:!1};var h=MO.prototype.contains.call(this,d,e,f);e=h.Of;f=h.Nf;if(h.contain)return{Of:e,Nf:f,contain:!0};
if(!this.contains(g))return{Of:e,Nf:f,contain:!1};f=this.osc(d.la(),d,e,f);f=this.osc(d.na(),d,f.Of,f.Nf);f=this.qsc(d.ka(),d,f.Of,f.Nf);f=this.qsc(d.ma(),d,f.Of,f.Nf);e=f.Of;f=f.Nf;return{Of:e,Nf:f,contain:!0}};c.prototype.nc=function(d){var e=d.getX(),f=d.getY();Math.abs(this.wc)>V.Qb&&(e=this.ala+this.bla*(M.Uf(d,this.ei)/this.wc));d=this.Bib.Ma(d);Math.abs(this.bAa)>V.Qb&&(f=this.Gf().ka()+Math.atan2(d.getY(),d.getX())/this.bAa*this.Gf().da());return new M(e,f)};c.prototype.transform=function(d){var e=
Math.abs(this.bla)>V.Qb?(d.getX()-this.ala)/this.bla:d.getX()-this.ala;d=this.Gf().da()>V.Qb?(d.getY()-this.Gf().ka())/this.Gf().da():d.getY()-this.Gf().ka();d=W.Xi(this.bAa*d,0,0);e=new M(this.wc*e,0);return this.$Ob.Ma(d.Ma(e))};c.prototype.eX=function(d){return Math.abs(this.bla)>V.Qb?Math.abs(this.wc/this.bla):Math.abs(this.wc)};c.prototype.fX=function(d){d=Math.abs(this.bla)>V.Qb?(d.getX()-this.ala)/this.bla:d.getX()-this.ala;return this.Gf().da()>V.Qb?Math.abs(this.bAa*this.wc*d/this.Gf().da()):
Math.abs(this.bAa*this.wc*d)};c.prototype.mF=function(d,e,f,g,h){if(HO.JKc(d.getY(),e.getY()))this.LFc(d,e,f,g,h);else{this.c2=!0;var k=this.Gf();k.ka()<=d.getY()&&k.ma()>=d.getY()&&this.process(g,d,f,h);k.ka()>d.getY()&&k.ka()<e.getY()&&this.process(g,a.SP(d,e,k.ka()),f,h);k.ma()>d.getY()&&k.ma()<e.getY()&&this.process(g,a.SP(d,e,k.ma()),f,h);k.ka()<=e.getY()&&k.ma()>=e.getY()&&this.process(g,e,f,h)}};c.prototype.mya=function(d,e,f,g,h){if(HO.JKc(d.getY(),e.getY()))this.LFc(d,e,f,g,h);else{this.c2=
!0;var k=this.Gf();k.ka()<=d.getY()&&k.ma()>=d.getY()&&this.process(g,d,f,h);k.ma()>e.getY()&&k.ma()<d.getY()&&this.process(g,a.SP(d,e,k.ma()),f,h);k.ka()>e.getY()&&k.ka()<d.getY()&&this.process(g,a.SP(d,e,k.ka()),f,h);k.ka()<=e.getY()&&k.ma()>=e.getY()&&this.process(g,e,f,h)}};c.prototype.process=function(d,e,f,g){if(this.c2)a.Mq(d,this.transform(e),f,g),this.$f=e&&e.clone(),this.c2=!1;else{e=this.K4c.tSb(this.$f,e);var h=0;do h=e[h].qwa,a.Mq(d,e[h].qbb,f,g);while(-1!==e[h].qwa)}};c.prototype.LFc=
function(d,e,f,g,h){a.Mq(g,this.transform(d),f,h);a.Mq(g,this.transform(e),f,h)};c.prototype.osc=function(d,e,f,g){var h=new M,k=Math.abs(d-this.ei.getX());k<=this.wc&&(h.setX(d),k=Math.sqrt(this.wc*this.wc-k*k),this.ei.getY()-k<e.ka()?h.setY(e.ka()):h.setY(this.ei.getY()-k),this.contains(h)&&(h=this.nc(h),f>h.getY()&&(f=h.getY()),g<h.getY()&&(g=h.getY())),h.setX(d),this.ei.getY()+k>e.ma()?h.setY(e.ma()):h.setY(this.ei.getY()+k),this.contains(h)&&(h=this.nc(h),f>h.getY()&&(f=h.getY()),g<h.getY()&&
(g=h.getY())));return{Of:f,Nf:g}};c.prototype.qsc=function(d,e,f,g){var h=new M,k=Math.abs(d-this.ei.getY());k<=this.wc&&(h.setY(d),k=Math.sqrt(this.wc*this.wc-k*k),this.ei.getX()-k<e.la()?h.setX(e.la()):h.setX(this.ei.getX()-k),this.contains(h)&&(h=this.nc(h),f>h.getY()&&(f=h.getY()),g<h.getY()&&(g=h.getY())),h.setY(d),this.ei.getX()+k>e.na()?h.setX(e.na()):h.setX(this.ei.getX()+k),this.contains(h)&&(h=this.nc(h),f>h.getY()&&(f=h.getY()),g<h.getY()&&(g=h.getY())));return{Of:f,Nf:g}};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoibmMiLCJzY2FsZVhBdCI6ImVYIiwic2NhbGVZQXQiOiJmWCIsInRyYW5zZm9ybUxpbmUiOiJtRiIsInRyYW5zZm9ybUxpbmVSZXYiOiJteWEifX19");var RO=/*#__PURE__*/function(){function c(a,b){this.vpa=void 0!==a?a:-1;this.D5=b||new U;this.mJa=Number.MAX_VALUE}L(c,"geotoolkit.deviation.StationBounds");return c}();var SO=/*#__PURE__*/function(){function c(a,b){this.agb=a;this.Bv=b}L(c,"geotoolkit.deviation.StationPair");return c}();var TO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(g,h,k){EO.call(this);g=G(g,{filter:!0,trackWidth:0,offset:0});this.Op=g.trajectory;this.uf=g.filter;this.zw=g.trackWidth;this.Cb=g.offset;k=k?k.clone():new W;this.ja=new a(k);this.Se=k;this.rjc=h.joinSegments;this.cHb=h.approxThreshold;this.Wfc=void 0!==h.approxThresholdMd?h.approxThresholdMd:this.cHb;this.GQb=h.trackWidthStrategy;null==this.GQb&&(this.GQb=new GO({scaleWidth:h.scaleWidth,minWidth:h.minWidth,maxWidth:h.maxWidth,widthScaleX:h.widthScaleX,widthScaleY:h.widthScaleY}));
this.tOa=h.outlineSegments;this.imc=h.outlineModelBboxAdjust;this.xE=-1;this.xAa=[];this.EJ=new W;this.roe=new W;this.gM=new M;this.Sa=null;this.nJ=[new M,new M];this.soa();this.ZMc()}function a(g){this.Se=g;this.xe=[];this.YF=new DO;this.RU=this.jgc=this.QNa=this.PNa=this.Yca=this.Xca=this.pR=this.oR=1}function b(g,h){return Math.abs(h)>Math.abs(g)?0>h?-Math.atan(g/h):Math.PI-Math.atan(g/h):0>g?-Math.PI/2+Math.atan(h/g):Math.PI/2+Math.atan(h/g)}function d(g,h){return g.xx===h.xx&&g.yy===h.yy}function e(g){var h=
V.nN(g.pb(),5);g=V.nN(g.Ab(),5);return{xx:h,yy:g}}var f=16;D(c,EO);L(c,"geotoolkit.deviation.PiecewiseTransformation");c.prototype.iQd=function(){this.ja.jgc=1;var g=this.ja.xe.length;if(g){var h=this.ja.xe[0];g=this.ja.xe[g-1];h=h.yf();g=g.ng();var k=[new M(0,h),new M(0,g)],l=[];this.II(k,l,this.Se);for(var m=k=0;m<l.length-1;++m)k+=M.Uf(l[m],l[m+1]);k&&(this.ja.jgc=Math.max(1,2*HO.$E(.5+k/Math.abs(g-h))))}};c.prototype.m_=function(g){var h=this.ja.xe.length,k=V.findIndex(null,this.ja.xe,null,null,
function(l){l=l.Gf().ma()-g;return Math.abs(l)>V.Qb?l:0});0>k?k=~k:++k;k>=h&&(k=h-1);return k};c.prototype.transform=function(g,h){h&&(g=h.Ma(g));h=this.m_(g.getY());for(0>h&&(h=0);h<this.ja.xe.length;++h){var k=this.ja.xe[h].Gf();if(g.getY()<=k.ma()&&g.getY()>=k.ka()||k.ma()>g.getY())return this.ja.xe[h].transform(g)}return 0<this.ja.xe.length?this.ja.xe[this.ja.xe.length-1].transform(g):new M};c.prototype.nc=function(g){if(0<=this.xE&&this.xE<this.ja.xe.length){for(var h=0;this.xE+h<this.ja.xe.length||
0<=this.xE-h;){if(this.xE+h<this.ja.xe.length&&this.ja.xe[this.xE+h].contains(g))return this.xE+=h,this.ja.xe[this.xE].nc(g);if(0<=this.xE-h&&this.ja.xe[this.xE-h].contains(g))return this.xE-=h,this.ja.xe[this.xE].nc(g);h++}return new M(Number.NaN,Number.NaN)}h=this.ja.YF.ana();for(var k=this.ja.YF.yUa(g.getY()-this.Se.We());k<h.length;++k){var l=h[k];this.gM.Ga(NaN,NaN);if(this.ja.xe[l.Bv.vpa].contains(g,this.gM))return this.xE=l.Bv.vpa,V.Xp(this.gM.getX())&&V.Xp(this.gM.getY())?this.gM:this.ja.xe[this.xE].nc(g);
if(g.getY()<l.Bv.mJa)break}return new M(Number.NaN,Number.NaN)};c.prototype.mF=function(g,h,k,l){0!==this.ja.xe.length&&this.II([g,h],k,l)};c.prototype.II=function(g,h,k,l){var m=g.length;if(1<m&&0<this.ja.xe.length){(l=l&&!HO.kKc(g,m))&&++m;if(k){var n=k.pb();var p=k.Ab();var q=k.hf();k=k.We()}else p=n=1,k=q=0;for(var r=new M(Number.MAX_VALUE,Number.MAX_VALUE),t=new M(g[0].getX()*n+q,g[0].getY()*p+k),u=new M,w=0,y=1,A=0;A<m-1;++A,++y){l&&A===m-2&&(y=0);u.Ga(g[y].getX()*n+q,g[y].getY()*p+k);if(0>
w||w>=this.ja.xe.length||!(this.ja.xe[w].Gf().ka()<=t.getY()&&this.ja.xe[w].Gf().ma()>=t.getY()))w=this.m_(t.getY());var x;if(t.getY()<=u.getY())for(x=w;x<this.ja.xe.length;++x){var C=this.ja.xe[x];var z=C.Gf();C.mF(t,u,r,h,this.uf);if(z.ma()>=u.getY()){w=x;break}}else for(w>=this.ja.xe.length&&(w=this.ja.xe.length-1),x=w;0<=x;--x)if(C=this.ja.xe[x],z=C.Gf(),C.mya(t,u,r,h,!1),z.ka()<=u.getY()){w=x;break}t.Ga(u.getX(),u.getY())}}};c.prototype.contains=function(g){for(var h=this.ja.YF.ana(),k=this.ja.YF.yUa(g.getY()-
this.Se.We());k<h.length;++k){var l=h[k];if(l.Bv.D5.contains(g)&&this.ja.xe[l.Bv.vpa].contains(g))return!0;if(g.getY()<l.Bv.mJa)break}return!1};c.prototype.Pua=function(g){var h=this.Op.iBc(this.Se,this.cHb,this.Wfc),k=h.PIb;h=[];this.nJ[0].Ga(g.la(),g.ka());this.nJ[1].Ga(g.na(),g.ka());var l=IO.DGa(this.nJ,k);l&&h.push(l);this.nJ[0].Ga(g.la(),g.ma());this.nJ[1].Ga(g.na(),g.ma());(l=IO.DGa(this.nJ,k))&&h.push(l);this.nJ[0].Ga(g.la(),g.ka());this.nJ[1].Ga(g.la(),g.ma());(l=IO.DGa(this.nJ,k))&&h.push(l);
this.nJ[0].Ga(g.na(),g.ka());this.nJ[1].Ga(g.na(),g.ma());(l=IO.DGa(this.nJ,k))&&h.push(l);return 2===h.length?(g=this.nc(h[0]),h=this.nc(h[1]),isNaN(g.getX())||isNaN(g.getY())||isNaN(h.getX())||isNaN(h.getY())?null:[new Jd(g.getY(),h.getY())]):0!==h.length||g.contains(k[0])?null:[]};c.prototype.MRa=function(g){if(1>this.ja.xe.length)return Vi.Dm();g=this.Se.Ta(g);var h=Infinity,k=-Infinity,l=this.ja.YF.ana();var m=this.ja.YF.jRd(g.ma()-this.Se.We());0<m&&m--;if(m!==l.length-1&&g.Nd(l[m].Bv.D5)){var n=
this.ja.xe[l[m].Bv.vpa];var p=n.Gf();0<=g.c9(n.bd(),n.Wf(),this.gM,this.gM)&&(h=p.ka());0<=g.c9(n.Vf(),n.nf(),this.gM,this.gM)&&(k=p.ma())}for(m=this.ja.YF.yUa(g.ka()-this.Se.We());m<l.length;++m){var q=l[m];n=this.ja.xe[q.Bv.vpa];p=n.Gf();if(h>p.ka()||k<p.ma())p=new U(g),p.intersect(q.Bv.D5),p.isEmpty()||(k=n.contains(p,h,k),h=k.Of,k=k.Nf);if(q.Bv.mJa>g.ma())break}return h>k?Vi.Dm():new U(0,h,this.zw,k)};c.prototype.update=function(g){this.Sa=null;var h=e(g),k=e(this.Se);if(d(h,k))return this.shift(g),
!0;var l=null;this.xAa.some(function(m){return d(m.key,h)?(l=m.value,!0):!1});l?(this.ja=l,this.Se=this.ja.Se,this.ja.RU<Number.MAX_VALUE-1&&this.ja.RU++,this.shift(g)):(this.ja=new a(g),this.Se=g,this.ZMc(),this.soa());return!0};c.prototype.eX=function(g){var h=this.m_(g.getY());for(0>h&&(h=0);h<this.ja.xe.length;++h){var k=this.ja.xe[h].Gf();if(g.getY()<=k.ma()&&g.getY()>=k.ka())return this.ja.xe[h].eX(g);if(k.ma()>g.getY())break}return this.ja.oR};c.prototype.fX=function(g){var h=this.m_(g.getY());
for(0>h&&(h=0);h<this.ja.xe.length;++h){var k=this.ja.xe[h].Gf();if(g.getY()<=k.ma()&&g.getY()>=k.ka())return this.ja.xe[h].fX(g);if(k.ma()>g.getY())break}return this.ja.pR};c.prototype.JW=function(){return this.ja.oR};c.prototype.KW=function(){return this.ja.pR};c.prototype.XS=function(){return this.ja.Xca};c.prototype.YS=function(){return this.ja.Yca};c.prototype.Swb=function(){return this.ja.PNa};c.prototype.Twb=function(){return this.ja.QNa};c.prototype.i9=function(g,h){if(this.ja.xe[this.xE]&&
this.ja.xe[this.xE].contains(g))return this.ja.xe[this.xE].i9(g,h);for(var k=this.ja.YF.ana(),l=this.ja.YF.yUa(g.getY()-this.Se.We());l<k.length;++l){var m=k[l];if(m.Bv.D5.contains(g))return this.xE=m.Bv.vpa,this.ja.xe[this.xE].i9(g,h);if(g.getY()<m.Bv.mJa)break}return null};c.prototype.mpe=function(){this.xAa.forEach(function(g){delete g.value})};c.prototype.soa=function(){var g=!1;this.ja.oR=0;this.ja.pR=0;this.ja.Xca=0;this.ja.Yca=0;this.ja.PNa=1;this.ja.QNa=1;for(var h=[],k=[],l=[],m=this.GQb.ca(this.Se,
{width:this.zw,trajectory:this.Op})/this.zw,n=this.Op.iBc(this.Se,this.cHb,this.Wfc),p=this.Se.rc(),q,r,t,u,w,y=[],A=[],x,C,z=new W;!n.end();)if(null==q&&(w=n.object(),q=0===h.length?w.Zbd():r,t=0===h.length?w.line().project(this.Se.Hc(this.Op.getX(q),this.Op.getY(q))):u,r=w.lVb(),u=w.line().project(this.Se.Hc(this.Op.getX(r),this.Op.getY(r))),w=p.Ma(t),C=t.getY()-u.getY(),x=t.getX()-u.getX(),x=b(x,C),W.cf(w.getX(),w.getY(),this.EJ),W.multiply(this.Se,this.EJ,z),this.Se.Ma(w,this.gM),W.Xi(x,this.gM.getX(),
this.gM.getY(),this.EJ),W.multiply(this.EJ,z,z),x=0===z.Yi()?Math.abs(z.pb()):Math.sqrt(z.pb()*z.pb()+z.Ji()*z.Ji()),C=0===z.Ji()?Math.abs(z.Ab()):Math.sqrt(z.Ab()*z.Ab()+z.Yi()*z.Yi()),0>this.Se.Ab()&&(C=-C),0>this.Se.pb()&&(x=-x),t=M.Uf(t,u),w=this.Op.Sb(r)-this.Op.Sb(q),C=Math.abs(w)>V.Qb?1/C*(t/w):1,this.EJ.Tb(m/x,0,0,C,0,0),W.multiply(z,this.EJ,z),this.EJ.Tb(1,0,0,1,-this.zw/2+this.Cb,-this.Op.Sb(q)),W.multiply(z,this.EJ,z),q=new U(0,this.Op.Sb(q),this.zw,this.Op.Sb(r)),q=new NO(z,q,!1),q.update()),
this.rjc){var v=0;if(0===y.length)h.push(t),k.push(this.Op.Sb(0)+w),l.push(q.BW()),q.Brb(),y.push(q),q=null,n.next();else{var B=y[y.length-1];l[l.length-1]-=B.BW();v=this.tOa?OO.wfd(B,q,v,A,this.imc):QO.zfd(B,q,v);var E=v.nBb;v=v.tooShort;l[l.length-1]+=B.BW();0<=v&&(h.push(h[h.length-1]+t),k.push(k[k.length-1]+w));E?(A=[],y.push(E),l.push(E.BW()+l[l.length-1])):-2===v?1<h.length?(h[h.length-2]=h[h.length-1],k[k.length-2]=k[k.length-1],h.pop(),k.pop(),l.pop(),y.pop(),this.tOa?(A.unshift(B),B=y[y.length-
1],B instanceof OO&&(l.pop(),y.pop(),l[l.length-1]-=y[y.length-1].BW(),B.reset(),l[l.length-1]+=y[y.length-1].BW(),B.xe=B.xe.concat(A),A=B.xe.slice())):y[y.length-1]instanceof QO&&(l.pop(),y.pop())):(h[h.length-1]+=t,k[k.length-1]+=w,l[l.length-1]-=B.BW(),B.Tb(q.Fa()),q=B.Gf().clone().union(q.Gf()),B.Mxa(q),B.update(),l[l.length-1]+=B.BW(),q=null,v=0,n.next(),this.tOa&&(A=[])):0===v?(B.Brb(),q.Brb()):(h[h.length-1]+=t,k[k.length-1]+=w,n.next(),n.end()&&(l[l.length-1]-=B.BW(),B.Mxa(B.Gf().clone().union(q.Gf())),
B.update(),l[l.length-1]+=B.BW()),this.tOa&&A.push(q),q=null)}q&&0<=v&&(y.push(q),l.push(q.BW()+l[l.length-1]),q=null,n.next())}else this.hEa(q),g=this.Mn(q,g),n.next(),q=null;if(this.rjc&&0<y.length)for(y[y.length-1]instanceof NO&&y[y.length-1].Brb(),n=h[h.length-1]/l[l.length-1]||1,r=0,B=q=A=null,v=0;v<y.length;++v)if(this.tOa&&!this.imc)y[v]instanceof NO?g=this.Mn(y[v],g):y[v]instanceof OO&&y[v].AVc(),this.hEa(y[v]);else if(E=y[v],E instanceof NO){if(0<E.HAd()){for(t=0===v?0:l[v-1]*n;h[r]<t&&r<
h.length-1;)r++;u=0===r?0:h[r-1];u=(t-u)/(h[r]-u);t=0===r?this.Op.Sb(0):k[r-1];var H=t*(1-u)+k[r]*u;for(t=l[v]*n;h[r]<t&&r<h.length-1;)r++;u=0===r?0:h[r-1];u=(t-u)/(h[r]-u);t=0===r?this.Op.Sb(0):k[r-1];var F=t*(1-u)+k[r]*u;t=E.KOd();u=E.Cid();w=p.Ma(t);x=t.getX()-u.getX();C=t.getY()-u.getY();x=b(x,C);W.cf(w.getX(),w.getY(),this.EJ);W.multiply(this.Se,this.EJ,z);this.Se.Ma(w,this.gM);W.Xi(x,this.gM.getX(),this.gM.getY(),this.EJ);W.multiply(this.EJ,z,z);x=0===z.vg?Math.abs(z.jf):Math.sqrt(z.jf*z.jf+
z.Bg*z.Bg);C=0===z.Bg?Math.abs(z.wf):Math.sqrt(z.wf*z.wf+z.vg*z.vg);0>this.Se.wf&&(C=-C);0>this.Se.jf&&(x=-x);t=M.Uf(t,u);w=F-H;C=Math.abs(w)>V.Qb?1/C*(t/w):1;W.dl(m/x,C,this.EJ);W.multiply(z,this.EJ,z);W.cf(-this.zw/2,-H,this.EJ);W.multiply(z,this.EJ,z);E.Tb(z);E.Mxa(new U(0,H,this.zw,F));E.update();q&&B?(q.AVc(),this.hEa(q)):A&&B&&(A.Mxa(new U(B.Gf().la(),B.ng(),B.Gf().na(),E.yf())),this.hEa(A));q=A=null;B=E}this.hEa(E);g=this.Mn(E,g)}else this.tOa?q=E instanceof OO?E:null:A=E instanceof QO?E:null;
1<this.ja.xe.length&&(this.ja.PNa=Math.pow(this.ja.PNa,1/this.ja.xe.length),this.ja.QNa=Math.pow(this.ja.QNa,1/this.ja.xe.length));0===this.ja.oR&&(this.ja.oR=1);0===this.ja.pR&&(this.ja.pR=1);0===this.ja.Xca&&(this.ja.Xca=1);0===this.ja.Yca&&(this.ja.Yca=1);g=Infinity;h=this.ja.YF.ana();for(k=h.length-1;0<=k;--k)l=h[k],l.Bv.mJa=g,g=Math.min(g,l.Bv.D5.ka());this.iQd()};c.prototype.Mn=function(g,h){var k=g.JW();g=g.KW();this.ja.PNa*=k;this.ja.QNa*=g;h?(this.ja.oR=Math.max(k,this.ja.oR),this.ja.pR=
Math.max(g,this.ja.pR),this.ja.Xca=Math.min(k,this.ja.Xca),this.ja.Yca=Math.min(g,this.ja.Yca)):(this.ja.oR=k,this.ja.pR=g,this.ja.Xca=k,this.ja.Yca=g,h=!0);return h};c.prototype.hEa=function(g){var h=g.ga(),k=new RO(this.ja.xe.length,h);h=h.ma()-this.Se.We();this.ja.YF.Jn(new SO(h,k));this.ja.xe.push(g)};c.prototype.ZMc=function(){if(this.xAa.length>=f){for(var g=Infinity,h=0,k=0;k<this.xAa.length;++k){var l=this.xAa[k];if(g>l.value.RU&&(h=k,g=l.value.RU,1===g))break}this.xAa.splice(h,1)}this.xAa.push({key:e(this.Se),
value:this.ja})};c.prototype.shift=function(g){var h=g.hf()-this.Se.hf(),k=g.We()-this.Se.We();if(Math.abs(h)>V.Qb||Math.abs(k)>V.Qb){this.gM.Ga(h,k);W.cf(h,k,this.EJ);h=null;for(var l=0;l<this.ja.xe.length;++l)this.ja.xe[l].offset(this.gM),this.ja.xe[l].zEd(h),h=this.ja.xe[l];h=this.ja.YF.ana();for(l=0;l<h.length;++l){var m=h[l];m.Bv.mJa+=k;this.EJ.Ta(m.Bv.D5,m.Bv.D5)}}this.Se=this.ja.Se=g};c.prototype.W7a=function(){return this.Se};c.prototype.Uva=function(){if(!this.Sa){var g=null;this.ja.xe.forEach(function(h){g?
g.union(h.ga()):g=h.ga()});this.Sa=g}return this.Sa};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRMb3dlckluZGV4IjoibV8iLCJpbnZlcnNlVHJhbnNmb3JtIjoibmMiLCJ0cmFuc2Zvcm1MaW5lIjoibUYiLCJ0cmFuc2Zvcm1MaW5lcyI6IklJIiwiZmluZFZpc2libGVUcmFqZWN0b3J5UmFuZ2VzIjoiUHVhIiwiZmluZEJvdW5kcyI6Ik1SYSIsInNjYWxlWEF0IjoiZVgiLCJzY2FsZVlBdCI6ImZYIiwibWF4U2NhbGVYIjoiSlciLCJtYXhTY2FsZVkiOiJLVyIsIm1pblNjYWxlWCI6IlhTIiwibWluU2NhbGVZIjoiWVMiLCJnZXRTdGF0aW9uc0JvdW5kcyI6IlV2YSJ9fX0g");var UO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a){CO.call(this);this.ea=G(a,{joinSegments:!0,scaleWidth:!1,minWidth:-Infinity,maxWidth:Infinity,widthScaleX:1,widthScaleY:1,approxThreshold:.5,outlineSegments:!1,outlineModelBboxAdjust:!1,trackWidthStrategy:null});this.ea.approxThresholdMd=null!=this.ea.approxThresholdMd?this.ea.approxThresholdMd:this.ea.approxThreshold}D(c,CO);L(c,"geotoolkit.deviation.PiecewiseTransformer");c.prototype.ta=function(){return G(this.ea,{})};c.prototype.setOptions=function(a){G(a,this.ea);
return this};c.prototype.ia=function(){return this.ta()};c.prototype.fa=function(a){return this.setOptions(a)};c.prototype.create=function(a,b){return new TO(a,this.ea,b)};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoidGEiLCJnZXRQcm9wZXJ0aWVzIjoiaWEiLCJzZXRQcm9wZXJ0aWVzIjoiZmEifX19");var VO=/*#__PURE__*/function(){function c(d,e,f){Gh.call(this,d,e,f)}var a=new W,b=new M;D(c,Gh);c.prototype.render=function(d,e,f,g,h,k,l,m,n){d.eg?(f=d.eg.transform(b.Ga(e+this.ca()/2,f+this.da()/2),a),e=f.getX()-this.ca()/2,f=f.getY()-this.da()/2,g||h?Gh.prototype.render.call(this,d.U9(),e,f,g,h,k,l,m,n):Gh.prototype.render.call(this,d.U9(),e,f)):hb("context must be instanceof geotoolkit.renderer.DeviatedRenderingContext")};return c}();var WO=/*#__PURE__*/va(/*#__PURE__*/function(){function c(n){Tj.call(this);this.Se=null!=n?n:new W;this.Vob=null;this.ea={};this.ea.trajectory=null;this.ea.transformer=new UO;this.ea.trackWidth=100;this.ea.offset=0;this.ea.clip=!0;this.ea.webglrendering=!1;this.eg=this.be=null;this.ja=[];this.kM=new W;this.jka=new M;this.vAa=this.uAa=NaN;this.UMa=this.fn=null;this.gz=[0,0,0,0];this.tDa=[];this.aO=this.T7=this.lH=null;this.XNb=this.vDa=!1}function a(n){return n instanceof Wi&&n.Lz()}var b=function(){function n(p,q){this.$c=p;
this.kd=q;this.Sa=new U(0,0,this.$c,this.kd);this.Rjb=new Gh(this.$c,this.kd,!0);this.dU=this.Rjb.sua(this.$c,this.kd);this.jjb=!0;this.bCa=sd.iUa()||sd.dab();this.WNa=Number.POSITIVE_INFINITY;this.Jlb=Number.NEGATIVE_INFINITY;this.XNa=Number.POSITIVE_INFINITY;this.Klb=Number.NEGATIVE_INFINITY}n.prototype.ca=function(){return this.$c};n.prototype.da=function(){return this.kd};n.prototype.clear=function(){if(null==this.dU)return this;for(var p=this.dU.getData(),q=4*this.dU.ca()*this.dU.da(),r=0;r<
q;r++)p[r]=0;this.bCa&&this.Rjb.clear();return this};n.prototype.vq=function(){!1===this.jjb&&(this.clear(),this.WNa=Number.POSITIVE_INFINITY,this.Jlb=Number.NEGATIVE_INFINITY,this.XNa=Number.POSITIVE_INFINITY,this.Klb=Number.NEGATIVE_INFINITY);this.z$c=this.dU.getData();this.jjb=!0;return this};n.prototype.Ko=function(){this.Rjb.uoa(this.dU,0,0)};n.prototype.A7b=function(p,q,r){this.jjb=!1;this.WNa=Math.min(p,this.WNa);this.Jlb=Math.max(p,this.Jlb);this.XNa=Math.min(q,this.XNa);this.Klb=Math.max(q,
this.Klb);var t=this.z$c;p=4*(q*this.$c+p);t[p+0]=r[0];t[p+1]=r[1];t[p+2]=r[2];t[p+3]=r[3]};n.prototype.No=function(p,q){this.Sa.setX(p).setY(q);return this};n.prototype.ga=function(){return this.Sa};n.prototype.render=function(p,q,r){if(!0===this.jjb)return this;var t=this.Jlb-this.WNa+1,u=this.Klb-this.XNa+1;r.drawImage(this.Rjb,this.WNa,this.XNa,t,u,p+this.WNa,q+this.XNa,t,u);return this};return n}(),d=function(){function n(p,q){this.WO=p;this.Sa=q;this.ef=Math.ceil(q.ca()/p.ca());this.Tf=Math.ceil(q.da()/
p.da())}n.prototype.aTa=function(){return this.Tf};n.prototype.Osb=function(){return this.ef};n.prototype.lud=function(p,q){p=this.Sa.la()+p*this.WO.ca();q=this.Sa.ka()+q*this.WO.da();return this.WO.No(p,q)};return n}(),e=new M(0,0),f=new M(0,0),g=new M(0,0),h=new M(0,0);D(c,Tj);c.prototype.Jo=function(){if(!this.be)throw Error("Parent rendering context is not defined");};c.prototype.sEc=function(){return{filter:this.ea.filter,trajectory:this.ea.trajectory,trackWidth:this.ea.trackWidth,offset:this.ea.offset}};
c.prototype.uC=function(n){G(n,this.ea);this.eg&&this.ea.transformer&&(n=this.kM,"function"==typeof this.eg.W7a&&(n=this.eg.W7a()),this.ea.transformer.setOptions(this.ea),this.eg=this.ea.transformer.create(this.sEc(),n))};c.prototype.Pk=function(){return this.ea};c.prototype.wP=function(){return this.eg?{lhd:this.eg.jDc()}:{}};c.prototype.U9=function(){return this.be};c.prototype.update=function(n){this.reb(n.Fa());this.be=n;this.setFilters(this.be?this.be.getFilters():null)};c.prototype.reb=function(n){n&&
(this.ea.transformer.setOptions(this.ea),this.eg?this.eg.update(n):this.eg=this.ea.transformer.create(this.sEc(),n));this.Se.kdb()};c.prototype.Zb=function(n){n=W.multiply(this.Se,n);n=new c(n);n.uC(this.Pk());n.setFilters(this.getFilters());n.$Va(this.lH);this.be.yh(this.aO);n.eg=this.eg;n.be=this.be;return n};c.prototype.Fa=function(){return this.Se};c.prototype.Tb=function(n){this.Se=n;this.T7=this.Vob=null;return this};c.prototype.pp=function(){null==this.Vob&&(this.Vob=this.Se.rc());return this.Vob};
c.prototype.Ma=function(n){return this.eg.transform(n,this.Se)};c.prototype.mF=function(n,p,q){q||(q=[]);this.eg.II([n,p],q,this.Se);return q};c.prototype.sc=function(n,p,q,r){n instanceof U?(e.Ga(n.la(),n.ka()),f.Ga(n.la()+n.ca(),n.ka()+n.da())):(e.Ga(n,p),f.Ga(n+q,p+r));n=[e.getX(),f.getX(),f.getX(),e.getX(),e.getX()];p=[e.getY(),e.getY(),f.getY(),f.getY(),e.getY()];this.Sj(n,p);return this};c.occ=new b(256,256);c.prototype.Cyb=function(n,p,q,r,t,u,w,y,A,x){if(w===A||y===x)return this;var C=null;
"function"===typeof this.fn.FP&&(null!=this.UMa&&(q=this.UMa.la(),r=this.UMa.ka(),t=this.UMa.na(),u=this.UMa.ma()),C=this.fn.FP(q,r,t,u));if(!C)return this;q=1;r=[];t=[];if(1!==q)for(w*=q,y*=q,A*=q,x*=q,u=0;u<n.length;++u)r.push(n[u]*q),t.push(p[u]*q);else r=n,t=p;w=Math.floor(w);y=Math.floor(y);A=Math.ceil(A);x=Math.ceil(x);p=A-w+1;n=x-y+1;if(0>w+p||0>y+n)return this;w=new U(w,y,A,x);(x=this.be.jg().clone())&&1!==q&&x.cb(x.la()*q,x.ka()*q,x.na()*q,x.ma()*q);if(!1===w.Nd(x))return this;w.intersect(x);
if(w.isEmpty())return this;w.cb(Math.floor(w.la()),Math.floor(w.ka()),Math.ceil(w.na()),Math.ceil(w.ma()));n=w.da();p=this.Se.rc();if(r[0]!==r[r.length-1]||t[0]!==t[t.length-1])r.push(r[0]),t.push(t[0]);u=[{}];var z=new d(c.occ,w),v=c.occ.ca(),B=this.be.Fa();this.be.Tb(W.Xj);for(var E=0;E<z.aTa();E++)for(var H=0;H<z.Osb();H++){var F=z.lud(H,E),I=F.ga();if(null==x||!1!==x.Nd(F.ga())){F.vq();w=F.ga().la();y=F.ga().ka();A=F.ga().na();F.ga();for(var J=0;J<n;++J){var K=y+J;if(!x||!(K<x.ka()||K>x.ma()))for(var N=
HO.xkd(r,t,K,u),P=0;P<N.length;++P){var Q=N[P];if(!(1>Q.Ie-Q.from)){var R=Math.floor(Q.from);R<w&&(R=w);var Y=Math.ceil(Q.Ie);Y>A&&(Y=A);var ca=Math.ceil(Q.from)-Q.from;Q=Q.Ie-Math.floor(Q.Ie);for(var ea=R;ea<=Y;++ea){var ua=ea-w;if(!(0>ua||ua>=I.ca()||0>J||J>=I.da()||x&&!x.contains(ea,K))){e.Ga(ea/q,K/q);var Ga=this.eg.nc(e);isNaN(Ga.getX())||isNaN(Ga.getY())||(p.Ma(Ga,Ga),C.Tp(Ga.getX(),Ga.getY(),this.gz),ea===R&&0!==ua?this.gz[3]=Math.round(ca*this.gz[3]):ea===Y&&ua!==v&&(this.gz[3]=Math.round(Q*
this.gz[3])),F.A7b(ua,J,this.gz))}}}}}F.Ko();F.render(w/q,y/q,this.be)}}this.be.Tb(B);return this};c.prototype.$Ub=function(){this.vDa=!1;var n=Wi.q9(Vi.vp(),this.aO.lp()),p=this.Se;this.aO instanceof ek&&(p=p.clone().scale(this.aO.ca(),this.aO.da()).translate(0,-1));var q=this.eg.transform(n,p);n=q.getX();var r=q.getY(),t=this.eg.nc(q);V.Xp(t.getX())&&V.Xp(t.getY())&&(this.jka.Ga(0,t.getY()),q=this.eg.transform(this.jka,this.kM),this.jka.Ga(this.ea.trackWidth,t.getY()),t=this.eg.transform(this.jka,
this.kM),t=Math.atan2(t.getY()-q.getY(),t.getX()-q.getX()),q=0>p.pb()?-1:1,p=0>p.Ab()?-1:1,t=W.Xi(t,0,0),n=W.cf(n,r),r=(new W).scale(q,p),W.multiply(t,r,r),W.multiply(n,r,r),n=this.be.Fa(),this.be.Tb(r),r=this.aO.Fk(),this.aO.wb(!1),this.aO.Db(0,0),this.aO.render(this.be),this.aO.Db(r),this.aO.wb(!0),this.be.Tb(n))};c.prototype.Sj=function(n,p,q,r){this.Jo();if(!this.ea.trajectory)return this;if(a(this.aO))return this.$Ub(),this;if(this.vDa)return this;var t=Math.min(n.length,p.length),u=[];r=q=Number.POSITIVE_INFINITY;
var w=Number.NEGATIVE_INFINITY,y=Number.NEGATIVE_INFINITY,A;for(A=0;A<t;++A){var x=n[A];var C=p[A];x<q&&(q=x);C<r&&(r=C);x>w&&(w=x);C>y&&(y=C);u.push(new M(n[A],p[A]))}q=Math.floor(q);r=Math.floor(r);w=Math.ceil(w);y=Math.ceil(y);this.ja=[];this.eg.II(u,this.ja,this.Se,!0);n=[];p=[];u=t=Number.POSITIVE_INFINITY;var z=Number.NEGATIVE_INFINITY,v=Number.NEGATIVE_INFINITY;for(A=0;A<this.ja.length;++A)x=this.ja[A].getX(),C=this.ja[A].getY(),x<t&&(t=x),C<u&&(u=C),x>z&&(z=x),C>v&&(v=C),n.push(x),p.push(C);
if(n[n.length-1]!==n[0]||p[p.length-1]!==p[0])n.push(n[0]),p.push(p[0]);x=0;C=n.length-1;this.ja=[];A=this.be.Fa();this.be.Tb(this.kM);this.fn&&this.Cyb(n,p,q,r,w,y,t,u,z,v);this.be.Sj(n,p,x,C);this.be.Tb(A);return this};c.prototype.nm=function(n,p,q,r){this.Jo();if(!this.ea.trajectory)return this;void 0===q&&(q=0,r=Math.min(n.length,p.length)-1);if(r<=q)return this;for(var t=[];q<=r;++q)t.push(new M(n[q],p[q]));this.ja=[];this.eg.II(t,this.ja,this.Se,!1);n=[];p=[];for(q=0;q<this.ja.length;++q)n.push(this.ja[q].getX()),
p.push(this.ja[q].getY());q=0;r=n.length-1;this.ja=[];t=this.be.Fa();this.be.Tb(this.kM);this.be.nm(n,p,q,r);this.be.Tb(t);return this};c.prototype.Lvc=function(n){var p=this.ea.trajectory;this.be.ra(n);this.be.nm(p.Vc,p.zd,0,p.Vc.length-1)};c.prototype.Nc=function(n,p,q,r){this.Jo();if(!this.ea.trajectory)return this;e.Ga(n,p);f.Ga(q,r);this.ja=[];this.eg.II([e,f],this.ja,this.Se);n=[];p=[];for(q=0;q<this.ja.length;++q)n.push(this.ja[q].getX()),p.push(this.ja[q].getY());q=0;r=n.length-1;this.g$b([e,
f],this.ja);this.ja=[];var t=this.be.Fa();this.be.Tb(this.kM);this.be.nm(n,p,q,r);this.be.Tb(t);return this};c.prototype.Wpb=function(n,p,q,r){e.Ga(n.mna(),n.pna());f.Ga(n.nna(),n.qna());g.Ga(n.ona(),n.rna());h.Ga(n.Kfa(),n.Lfa());n=V.sla(e,f,g,h);this.ja=[];this.eg.II(n,this.ja,this.Se,!1);for(n=0;n<this.ja.length;++n){var t=this.ja[n].getX(),u=this.ja[n].getY();t<r.cE&&(r.cE=t);u<r.eE&&(r.eE=u);t>r.bE&&(r.bE=t);u>r.dE&&(r.dE=u);p.push(t);q.push(u)}};c.prototype.Rp=function(n,p,q,r){this.Jo();if(!this.ea.trajectory)return this;
if(a(this.aO))return this.$Ub(),this;var t=n,u=p,w=n+q,y=p+r;n+=q/2;p+=r/2;r=Xg.gma(n,p,q,r);n=[];p=[];q={cE:Number.POSITIVE_INFINITY,eE:Number.POSITIVE_INFINITY,bE:Number.NEGATIVE_INFINITY,dE:Number.NEGATIVE_INFINITY};for(var A=0;A<r.length;++A)this.Wpb(r[A],n,p,q);r=this.be.Fa();this.be.Tb(this.kM);this.fn&&this.Cyb(n,p,t,u,w,y,q.cE,q.eE,q.bE,q.dE);this.be.Sj(n,p);this.be.Tb(r);return this};c.prototype.Fx=function(n,p,q,r,t,u,w,y){this.Jo();if(!this.ea.trajectory)return this;if(u-t>=2*Math.PI)return this.Rp(n,
p,q,r),this;var A=n,x=p,C=n+q,z=p+r;n+=q/2;p+=r/2;w=[];var v=[];if(!y){var B=this.eg.transform(new M(n,p),this.Se);w.push(B.getX());v.push(B.getY())}n=Xg.gma(n,p,q,r,t,u);if(1>n.length)return this;p={cE:Number.POSITIVE_INFINITY,eE:Number.POSITIVE_INFINITY,bE:Number.NEGATIVE_INFINITY,dE:Number.NEGATIVE_INFINITY};for(q=0;q<n.length;++q)this.Wpb(n[q],w,v,p);n=this.be.Fa();this.be.Tb(this.kM);if(y)if(this.XNb)for(y=0;y<w.length;++y)p=g.Ga(w[y],v[y]),this.be.lineTo(p.getX(),p.getY());else this.be.nm(w,
v);else this.be.Sj(w,v);this.be.Tb(n);if(this.fn){this.Myb();this.UI={cE:A,eE:x,bE:C,dE:z};for(A=0;A<w.length;++A){x=Math.round(w[A]);C=Math.round(v[A]);z=this.iea.length;if(0===z||this.iea[z-1]!==x&&this.Tta[z-1]!==C)this.iea.push(x),this.Tta.push(C);w[A]<this.dA.cE&&(this.dA.cE=w[A]);v[A]<this.dA.eE&&(this.dA.eE=v[A]);w[A]>this.dA.bE&&(this.dA.bE=w[A]);v[A]>this.dA.dE&&(this.dA.dE=v[A])}this.be.Tb(this.kM);this.Cyb(this.iea,this.Tta,this.UI.cE,this.UI.eE,this.UI.bE,this.UI.dE,this.dA.cE,this.dA.eE,
this.dA.bE,this.dA.dE);this.Myb();this.be.Tb(n)}return this};c.prototype.ZH=function(n,p,q,r,t,u){this.Jo();if(!this.ea.trajectory)return this;var w=u-t>=2*Math.PI;w&&(t=0,u=2*Math.PI);q=Xg.gma(n,p,2*q,2*q,t,u);n=Xg.gma(n,p,2*r,2*r,t,u,!0);if(w){this.beginPath();p=q[0];this.moveTo(p.mna(),p.pna());for(w=0;w<q.length;++w)p=q[w],this.bezierCurveTo(p.nna(),p.qna(),p.ona(),p.rna(),p.Kfa(),p.Lfa());p=n[n.length-1];this.moveTo(p.Kfa(),p.Lfa());for(w=n.length-1;0<=w;--w)p=n[w],this.bezierCurveTo(p.ona(),
p.rna(),p.nna(),p.qna(),p.mna(),p.pna());this.closePath();this.be.xi();this.be.stroke()}else{p=[];r=[];t={cE:Number.POSITIVE_INFINITY,eE:Number.POSITIVE_INFINITY,bE:Number.NEGATIVE_INFINITY,dE:Number.NEGATIVE_INFINITY};for(w=0;w<q.length;++w)this.Wpb(q[w],p,r,t);for(w=0;w<n.length;++w)this.Wpb(n[w],p,r,t);q=this.be.Fa();this.be.Tb(this.kM);this.be.Sj(p,r);this.be.Tb(q)}return this};var k=new th([],[]),l=new th([],[]),m=wc(100,100);c.prototype.drawImage=function(n,p,q,r,t,u,w,y,A){"function"===typeof n.wk&&
(n=n.wk());void 0===r&&(r=n.width,t=n.height,u=p,w=q,y=r,A=t,q=p=0);var x=this.Se.transform(new U(u,w,u+y,w+A)),C=Math.ceil(x.ca()),z=Math.ceil(x.da());if(0!==C&&0!==z){var v=Math.ceil(x.na()),B=Math.ceil(x.ma());m.width=v;m.height=B;v=m.getContext("2d");v.setTransform(this.Se.jf,this.Se.Bg,this.Se.vg,this.Se.wf,this.Se.Oh,this.Se.Ch);v.drawImage(n,p,q,r,t,u,w,y,A);x=v.getImageData(Math.floor(x.la()),Math.floor(x.ka()),C,z).data;v.setTransform(1,0,0,1,0,0);B=this.Se.transform(new M(u,w),e);var E=
this.Se.transform(new M(u+y,w),f),H=this.Se.transform(new M(u,w+A),g);w=this.Se.transform(new M(u+y,w+A),h);u=new th([B.x,E.x,w.x,H.x],[B.y,E.y,w.y,H.y]);this.eg.II([B,E,w,H],this.ja,this.kM,!0);if(3>this.ja.length)this.ja=[];else if(this.ea.webglrendering){v=[];x=[];u=[];B=[];E=[];var F=Number.POSITIVE_INFINITY;A=Number.POSITIVE_INFINITY;var I=Number.NEGATIVE_INFINITY,J=Number.NEGATIVE_INFINITY;z=C=Number.POSITIVE_INFINITY;w=H=Number.NEGATIVE_INFINITY;for(y=0;y<this.ja.length;y++){var K=this.ja[y],
N=this.Se.nc(this.eg.nc(K)),P=N.getX(),Q=N.getY();isNaN(P)||isNaN(Q)?E.push(null):(E.push(N),F=Math.min(P,F),A=Math.min(Q,A),I=Math.max(P,I),J=Math.max(Q,J),N=K.getX(),K=K.getY(),C=Math.min(N,C),z=Math.min(K,z),H=Math.max(N,H),w=Math.max(K,w))}if(!V.equals(H,C,1)&&!V.equals(w,z,1)){K=(I-F)*n.width/r;N=(J-A)*n.height/t;p=F+p/r*(I-F);q=A+q/t*(J-A);for(y=0;y<this.ja.length;y++)null!=E[y]&&(v.push((E[y].getX()-p)/K),x.push((E[y].getY()-q)/N),u.push(this.ja[y].getX()-C),B.push(this.ja[y].getY()-z));v=
WF.rga(n,{width:H-C,height:w-z,source:{x:u,y:B},destination:{x:v,y:x}});x=this.be.Fa();this.be.Tb(this.kM);this.be.drawImage(v,C,z);this.be.Tb(x)}}else{r=[];A=[];n=y=Infinity;t=q=-Infinity;for(p=0;p<this.ja.length;++p)J=this.ja[p].getX(),F=this.ja[p].getY(),J<y&&(y=J),F<n&&(n=F),J>q&&(q=J),F>t&&(t=F),r.push(J),A.push(F);this.ja=[];p=new wh;p.union(k.he(r,A),p);r=Math.min(B.x,E.x,H.x,w.x);B=Math.min(B.y,E.y,H.y,w.y);y=Math.floor(y);n=Math.floor(n);q=Math.ceil(q);t=Math.ceil(t);E=Math.min(100,Math.max(q-
y,t-n));m.width=E;m.height=E;H=this.be.Fa();this.be.Tb(this.kM);for(J=y;J<q;J+=E)for(F=n;F<t;F+=E)if(I=v.createImageData(E,E),w=Math.min(J+E,q),A=Math.min(F+E,t),l.he([J,w,w,J],[F,F,A,A]),K=p.intersect(l),K.length){N=Infinity;w=A=-Infinity;y=Infinity;for(P=0;P<K.length;P++)N=Math.min(N,Math.min.apply(null,K[P].ce())),w=Math.max(w,Math.max.apply(null,K[P].ce())),A=Math.max(A,Math.max.apply(null,K[P].Fe())),y=Math.min(y,Math.min.apply(null,K[P].Fe()));K=!1;for(N=Math.floor(N);N<Math.ceil(w);++N)for(P=
Math.floor(y);P<Math.ceil(A);++P){var R=Q=0,Y=0,ca=0,ea=e.Ga(N,P),ua=N-J,Ga=P-F,Aa=this.eg.nc(ea),Ba=g.Ga(HO.$E(Aa.getX()-r),HO.$E(Aa.getY()-B));if(u.contains(Aa.getX(),Aa.getY())&&(Aa=this.eg.i9(ea,1))){for(var La=ea=0;La<Aa.getSize();++La){var Pa=Aa.get(La),Oa=Ba.x+Pa.Oh,Va=Ba.y+Pa.Ch;0>Oa||0>Va||Oa>=C||Va>=z||(Oa=4*(Oa+Va*C),Q+=x[Oa++]*Pa.area,R+=x[Oa++]*Pa.area,Y+=x[Oa++]*Pa.area,ca+=x[Oa]*Pa.area,ea+=Pa.area)}ca<V.Qb||0===ea||(K=4*(ua+Ga*E),I.data[K++]=Q/ea,I.data[K++]=R/ea,I.data[K++]=Y/ea,
I.data[K]=ca/ea,K=!0)}}K&&(v.clearRect(0,0,E,E),v.putImageData(I,0,0),this.be.drawImage(m,J,F))}this.be.Tb(H)}}};c.prototype.je=function(n,p,q){this.Jo();if(!this.ea.trajectory)return this;if(a(this.aO))return this.$Ub(),this;var r=this.eg.transform(new M(n,p),this.Se);p=this.eg.transform(new M(n+1,p),this.Se);n=this.be.Fa();p=Math.atan2(p.getY()-r.getY(),p.getX()-r.getX());p=W.Xi(p,r.getX(),r.getY());this.be.Tb(p);this.be.je(r.getX(),r.getY(),q);this.be.Tb(n);return this};c.prototype.beginPath=function(){this.Jo();
if(!this.ea.trajectory)return this;this.Myb();this.be.beginPath();return this};c.prototype.moveTo=function(n,p){this.Jo();if(!this.ea.trajectory||this.vDa)return this;this.hgc=n;this.igc=p;this.uAa=n;this.vAa=p;e.Ga(n,p);e=this.eg.transform(e,this.Se);n=this.be.Fa();n.hd(e,e);this.be.moveTo(e.getX(),e.getY());return this};c.prototype.Myb=function(){this.UI={cE:Number.POSITIVE_INFINITY,eE:Number.POSITIVE_INFINITY,bE:Number.NEGATIVE_INFINITY,dE:Number.NEGATIVE_INFINITY};this.dA={cE:Number.POSITIVE_INFINITY,
eE:Number.POSITIVE_INFINITY,bE:Number.NEGATIVE_INFINITY,dE:Number.NEGATIVE_INFINITY};this.iea=[];this.Tta=[]};c.prototype.g$b=function(n,p){if(this.fn&&this.UI)for(n=Hd.getBoundingBox(n),n.la()<this.UI.cE&&(this.UI.cE=n.la()),n.ka()<this.UI.eE&&(this.UI.eE=n.ka()),n.na()>this.UI.bE&&(this.UI.bE=n.na()),n.ma()>this.UI.dE&&(this.UI.dE=n.ma()),n=Hd.getBoundingBox(p),n.la()<this.dA.cE&&(this.dA.cE=n.la()),n.ka()<this.dA.eE&&(this.dA.eE=n.ka()),n.na()>this.dA.bE&&(this.dA.bE=n.na()),n.ma()>this.dA.dE&&
(this.dA.dE=n.ma()),this.iea||(this.iea=[]),this.Tta||(this.Tta=[]),n=0;n<p.length;++n){var q=p[n].getX(),r=p[n].getY(),t=this.iea.length;1<t&&this.iea[t-1]===q&&this.Tta[t-1]===r||(this.iea.push(q),this.Tta.push(r))}};c.prototype.lineTo=function(n,p){this.Jo();if(!this.ea.trajectory||this.vDa)return this;var q=e.Ga(this.uAa,this.vAa),r=f.Ga(n,p);this.ja=[];this.eg.II([q,r],this.ja,this.Se,!1);for(var t=this.be.Fa(),u=0;u<this.ja.length;++u){var w=g.Ga(this.ja[u].getX(),this.ja[u].getY());t.hd(w,
w);this.be.lineTo(w.getX(),w.getY())}this.g$b([q,r],this.ja);this.ja=[];this.uAa=n;this.vAa=p;return this};c.prototype.arcTo=function(n,p,q,r,t){this.Jo();if(!this.ea.trajectory||this.vDa)return this;n=HO.rtc(this.uAa,this.vAa,n,p,q,r,t);this.lineTo(n.line.iXc,n.line.lXc);this.uAa=n.kp.x;this.vAa=n.kp.y;n=n.arc;this.XNb=!0;this.Fx(n.left,n.top,2*t,2*t,n.hw,n.Yvc,void 0,!0);this.XNb=!1;return this};c.prototype.bezierCurveTo=function(n,p,q,r,t,u){this.Jo();if(!this.ea.trajectory||this.vDa)return this;
this.ja=[];e.Ga(this.uAa,this.vAa);f.Ga(n,p);g.Ga(q,r);h.Ga(t,u);n=V.sla(e,f,g,h);this.eg.II(n,this.ja,this.Se,!1);p=this.be.Fa();this.be.Tb(this.kM);for(q=0;q<this.ja.length;++q)this.be.lineTo(this.ja[q].getX(),this.ja[q].getY());this.be.Tb(p);this.g$b(n,this.ja);this.ja=[];this.uAa=t;this.vAa=u;return this};c.prototype.stroke=function(){this.Jo();if(!this.ea.trajectory)return this;this.be.stroke();return this};c.prototype.closePath=function(){this.Jo();if(!this.ea.trajectory)return this;void 0!==
this.hgc&&void 0!==this.igc&&this.lineTo(this.hgc,this.igc);this.be.closePath();return this};c.prototype.xi=function(){this.Jo();this.fn&&!1===this.ac()?(this.Cyb(this.iea,this.Tta,this.UI.cE,this.UI.eE,this.UI.bE,this.UI.dE,this.dA.cE,this.dA.eE,this.dA.bE,this.dA.dE),this.Myb()):this.be.xi();return this};c.prototype.ib=function(n){this.Jo();if(!this.ea.trajectory)return this;this.be.ib(n);return this};c.prototype.getParent=function(){this.Jo();return this.be.getParent()};c.prototype.WJ=function(){this.Jo();
return this.be.WJ()};c.prototype.TJ=function(){this.Jo();return this.be?this.be.TJ():null};c.prototype.Hy=function(n,p,q){this.Jo();return new VO(n,p,q)};c.prototype.$Va=function(n){this.vC(n);return this};c.prototype.vC=function(n){this.lH=null!=n?n.clone():null;this.T7=null};c.prototype.xC=function(n){if(null!=n){var p=this.Fa();null!=p&&(n=p.Ta(n));this.vC(n)}};c.prototype.jg=function(){return null==this.lH?new U(0,this.ea.trajectory.Of(),this.ea.trackWidth,this.ea.trajectory.Nf()):this.lH instanceof
U?this.lH:this.lH.ga()};c.prototype.Rg=function(){null==this.T7&&(this.T7=this.pp().Ta(this.jg()));return this.T7};c.prototype.SGa=function(n,p,q){this.ja=[];this.eg.II(n,this.ja,this.kM,q);if(!(1>this.ja.length)){q&&(n=this.ja[0],p.moveTo(n.getX(),n.getY()));for(var r=1;r<this.ja.length;++r)n=this.ja[r],p.lineTo(n.getX(),n.getY());q&&p.close();this.ja=[]}};c.prototype.fh=function(n,p,q){n instanceof wh&&(n=n.S8a());if(!this.ea.clip)return this;this.Jo();p=void 0!==p?p:Cd.To;q=void 0!==q?q:!1;null!=
n&&q&&!this.Fa().GD()&&this.Fa().transform(n,n);this.$Va(Hd.Uwb(this.lH,n,p));null==this.lH?(n=this.ea.trajectory,q=new U(0,n.Of(),this.ea.trackWidth,n.Nf())):q=this.lH;n=new Ed;if(q instanceof U)q=q.clone().round(),e.Ga(q.la(),q.ka()),f.Ga(q.na(),q.ka()),g.Ga(q.na(),q.ma()),h.Ga(q.la(),q.ma()),this.SGa([e,f,g,h],n,!0);else if(q instanceof Ed){p=q.getTags();for(var r=q.getX(),t=q.getY(),u=new M,w=new M,y,A,x=0;x<p.length;x++){var C=q.getIndex(x);if(p[x]===Dd.ey)u.Ga(r[C],t[C]),w.Ga(r[C],t[C]),y=this.eg.transform(u,
this.kM),n.moveTo(y.getX(),y.getY());else if(p[x]===Dd.bz)e.Ga(r[C],t[C]),this.SGa([w,e],n),w.Ga(r[C],t[C]);else if(p[x]===Dd.BC)f.Ga(r[C],t[C]),g.Ga(r[C+1],t[C+1]),h.Ga(r[C+2],t[C+2]),A=V.sla(w,f,g,h),this.SGa(A,n),w.Ga(r[C+2],t[C+2]);else if(p[x]===Dd.DQ){y=HO.rtc(w.getX(),w.getY(),r[C],t[C],r[C+1],t[C+1],r[C+2]);A=y.line;e.Ga(A.LRd,A.NRd);w.Ga(A.iXc,A.lXc);this.SGa([e,w],n);A=y.arc;C=r[C+2];C=Xg.gma(A.left+C,A.top+C,2*C,2*C,A.hw,A.Yvc);for(var z,v=0;v<C.length;++v)z=C[v],e.Ga(z.mna(),z.pna()),
f.Ga(z.nna(),z.qna()),g.Ga(z.ona(),z.rna()),h.Ga(z.Kfa(),z.Lfa()),A=V.sla(e,f,g,h),this.SGa(A,n);z&&w.Ga(z.Kfa(),z.Lfa());y=y.kp;e.Ga(y.x,y.y);this.SGa([w,e],n);w.Ga(y.x,y.y)}else p[x]===Dd.TK&&(this.SGa([w,u],n),n.close())}}z=this.be.Fa();this.be.Tb(this.kM);this.be.fh(n,Cd.To,!1);this.be.Tb(z);return this};c.prototype.ac=function(){return this.be?this.be.ac():!1};c.prototype.getSelection=function(){return this.be&&this.be.ac()?this.be.getSelection():[]};c.prototype.Ym=function(n,p){this.Jo();this.ac()&&
(this.LHa(p),n.render(this),this.roa())};c.prototype.fT=function(n){this.Jo();this.be.ac()&&this.be.fT(n)};c.prototype.wt=function(n){this.Jo();this.be.ac()&&this.be.wt(n);return this};c.prototype.LHa=function(n){this.Jo();this.be.LHa(n)};c.prototype.roa=function(){this.Jo();this.be.roa()};c.prototype.selectNode=function(n){this.Jo();this.be.selectNode(n)};c.prototype.measureText=function(n,p){this.Jo();return this.be.measureText(n,p)};c.prototype.save=function(){this.Jo();var n=null!=this.lH?this.lH.clone():
null;this.tDa.push(n);this.be.save();return this};c.prototype.restore=function(){this.Jo();0<this.tDa.length&&this.$Va(this.tDa.pop());this.be.restore();return this};c.prototype.Pua=function(n){this.Jo();return this.eg.Pua(n)};c.prototype.bFa=function(n){this.Jo();return this.eg.MRa(n)};c.prototype.Uva=function(){this.Jo();return this.eg.Uva()};c.prototype.yh=function(n){this.Jo();this.be.yh(n);this.aO=n;a(this.aO)&&(this.vDa=!0);return this};c.prototype.yV=function(){this.Jo();this.be.yV();return this};
c.prototype.HV=function(){this.Jo();this.be.HV();return this};c.prototype.Pu=function(n){this.Jo();this.be.Pu(n);return this};c.prototype.qa=function(n,p){this.Jo();n?n instanceof wf&&!1===this.ac()?(this.UMa=p,this.fn=n,this.be.qa(null)):(this.fn=null,this.be.qa(n,p)):(this.fn=null,this.be.qa(n,p));return this};c.prototype.fb=function(){this.Jo();return this.fn?this.fn:"function"===typeof this.be.fb?this.be.fb():null};c.prototype.ra=function(n,p){this.Jo();this.be.ra(n,p);return this};c.prototype.zh=
function(n){this.be.zh(n);return this};c.prototype.ro=function(){this.be.ro();return this};c.prototype.tFa=function(n,p){var q=0;n=this.mF(n,p);for(p=0;p<n.length-1;++p)q+=M.Uf(n[p],n[p+1]);return q};c.prototype.Iaa=function(n){this.ea.webglrendering=n;return this};c.prototype.iwa=function(){return this.ea.webglrendering};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXREZXZpYXRpb24iOiJ1QyIsImdldEhpbnRzIjoid1AiLCJ1cGRhdGVUcmFuc2Zvcm1hdGlvbiI6InJlYiIsInB1c2hUcmFuc2Zvcm1hdGlvbiI6IlpiIiwiZ2V0VHJhbnNmb3JtYXRpb24iOiJGYSIsInNldFRyYW5zZm9ybWF0aW9uIjoiVGIiLCJnZXRJbnZlcnNlVHJhbnNmb3JtYXRpb24iOiJwcCIsImRyYXdSZWN0YW5nbGUiOiJzYyIsImRyYXdQb2x5Z29uIjoiU2oiLCJkcmF3UG9seWxpbmUiOiJubSIsImRyYXdMaW5lIjoiTmMiLCJkcmF3RWxsaXBzZSI6IlJwIiwiZHJhd0FyYyI6IkZ4IiwiZHJhd0FubnVsdXNBcmMiOiJaSCIsImRyYXdUZXh0IjoiamUiLCJmaWxsUGF0aCI6InhpIiwic2V0VGV4dFN0eWxlIjoiaWIiLCJnZXRDb250ZXh0MmQiOiJXSiIsImNyZWF0ZVJlbmRlcmluZ1N0YXRlIjoiVEoiLCJjcmVhdGVTdXJmYWNlIjoiSHkiLCJzZXREZXZpY2VSZWN0IjoidkMiLCJzZXRNb2RlbFJlY3QiOiJ4QyIsImdldERldmljZVJlY3QiOiJqZyIsImdldE1vZGVsUmVjdCI6IlJnIiwic2V0Q2xpcCI6ImZoIiwiaXNQaWNraW5nIjoiYWMiLCJwaWNrIjoiWW0iLCJwdXNoU2VsZWN0aW9uIjoiZlQiLCJzZXRTZWxlY3Rpb24iOiJ3dCIsImZpbmRWaXNpYmxlVHJhamVjdG9yeVJhbmdlcyI6IlB1YSIsImZpbmRMaW5lYXJCYm94IjoiYkZhIiwic2V0Q3VycmVudE5vZGUiOiJ5aCIsImJlZ2luUmVuZGVyaW5nIjoieVYiLCJlbmRSZW5kZXJpbmciOiJIViIsInNldEZpbGxQYXR0ZXJuIjoiUHUiLCJzZXRGaWxsU3R5bGUiOiJxYSIsImdldEZpbGxTdHlsZSI6ImZiIiwic2V0TGluZVN0eWxlIjoicmEiLCJzZXRIaW50cyI6InpoIiwicmVzZXRIaW50cyI6InJvIiwiZ2V0RGV2aWNlUGF0aExlbmd0aCI6InRGYSIsInNldFdlYkdMUmVuZGVyaW5nIjoiSWFhIiwiZ2V0V2ViR0xSZW5kZXJpbmciOiJpd2EifX19");var ZU=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a){FO.call(this);a=G(a,{minWidth:1,maxWidth:Infinity,aspectratio:10});this.OU=a.minWidth;this.IU=a.maxWidth;this.dHb=a.aspectratio}D(c,FO);L(c,"geotoolkit.deviation.AspectRatioTrackWidthStrategy");c.prototype.ca=function(a,b){var d=b.trajectory;2>d.count()?a=b.width*a.pb():(a=this.tXb(d,a),a=a.deviceLength/this.dHb);a<this.OU&&(a=this.OU);a>this.IU&&(a=this.IU);return a};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXaWR0aCI6ImNhIn19fSAg");var $U=/*#__PURE__*/va(/*#__PURE__*/function(){function c(d,e,f){e=(e.getY()-d.getY())/(e.getX()-d.getX());if(!isFinite(e))return Number.NaN;d=d.getY()-e*d.getX();return f=e*f+d}function a(d,e,f){e=(e.getY()-d.getY())/(e.getX()-d.getX());if(!isFinite(e))return Number.NaN;d=d.getY()-e*d.getX();return f-=d/e}function b(d,e,f){Xi.call(this);this.U1=d;this.dad=e;this.od=f;this.nJ=[new M,new M];this.Pfc=this.Op=null;this.HQb=[]}D(b,Xi);L(b,"geotoolkit.deviation.axis.DeviatedValueTransformer");b.prototype.Nud=function(d,e){if(!d.equals(this.Op)||
!e.W7a().l9(this.Pfc)){var f=new M;this.HQb=[];for(var g=0;g<d.count();++g){f.Ga(0,d.Sb(g));var h=e.transform(f);this.HQb.push(h)}this.Op=d;this.Pfc=e.W7a()}return this.HQb};b.Oud=function(d){if(!d||1>d.length)return null;for(var e=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,k,l,m,n,p,q,r,t,u=0;u<d.length;++u){var w=d[u],y=w.getX(),A=w.getY();y<e&&(e=y,k=w,p=u);y>g&&(g=y,m=w,r=u);A<f&&(f=A,l=w,q=u);A>h&&(h=A,n=w,t=u)}return{lFc:p,mFc:q,
jFc:r,kFc:t,MEd:k,NEd:l,KEd:m,LEd:n}};b.prototype.Gz=function(){return this.od};b.prototype.transform=function(d){if(!this.U1.Pk())return d;var e=this.U1.Pk().trajectory;if(!e||2>e.count())return d;var f=this.U1.ezc();if(!f)return d;var g=this.od.zg()===Rh.ob,h=this.od.$Dc().co(),k=this.U1.getRoot().YJ();g?(h=d*h.Ab()+h.We(),this.nJ[0].Ga(k.la(),h),this.nJ[1].Ga(k.na(),h)):(h=d*h.pb()+h.hf(),this.nJ[0].Ga(h,k.ka()),this.nJ[1].Ga(h,k.ma()));k=this.Nud(e,f);var l=IO.DGa(this.nJ,k);if(null==l&&k&&0<
k.length){var m=b.Oud(k);if(m)if(g){var n;h<=m.NEd.getY()?0===m.mFc?n=a(k[0],k[1],h):m.mFc===k.length-1&&(n=a(k[k.length-2],k[k.length-1],h)):h>=m.LEd.getY()&&(0===m.kFc?n=a(k[0],k[1],h):m.kFc===k.length-1&&(n=a(k[k.length-2],k[k.length-1],h)));isFinite(n)&&(l=new M(n,h))}else{var p;h<=m.MEd.getX()?0===m.lFc?p=c(k[0],k[1],h):m.lFc===k.length-1&&(p=c(k[k.length-2],k[k.length-1],h)):h>=m.KEd.getX()&&(0===m.jFc?p=c(k[0],k[1],h):m.jFc===k.length-1&&(p=c(k[k.length-2],k[k.length-1],h)));isFinite(p)&&(l=
new M(h,p))}}if(null==l)return d;f=f.nc(l);if(null===f||!V.Xp(f.getX())||!V.Xp(f.getY()))return d;f=f.getY();f=this.dad.transform(f,!1);return d=(e=e.NFc(f))?g?e.getY():e.getX():d};return b}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBeGlzIjoiR3oifX19");var aV=/*#__PURE__*/va(/*#__PURE__*/{kc:"Left",Na:"Center",$b:"Right"},2,"eyJMZWZ0Ijoia2MiLCJDZW50ZXIiOiJOYSIsIlJpZ2h0IjoiJGIifSAg");var bV=/*#__PURE__*/function(){function c(a,b,d,e){this.nE=a?a:0;this.ox=b?b:0;this.NAa=d?d:0;this.xj=e?e:null}L(c,"geotoolkit.deviation.PiecewiseLinearApproximation");c.prototype.line=function(){return this.xj};c.prototype.error=function(){return this.NAa};c.prototype.Zbd=function(){return this.nE};c.prototype.lVb=function(){return this.ox};c.prototype.count=function(){return this.ox-this.nE+1};c.prototype.copy=function(a){this.nE=a.nE;this.ox=a.ox;this.NAa=a.NAa;this.xj=a.xj;return this};return c}();var cV=/*#__PURE__*/function(){function c(b,d,e){this.Op=b;this.J$c=d;this.njb=e;this.Uqa=0;this.Rka=null==b?0:b.count();this.ei=new bV;this.PIb=[];for(b=0;b<this.Rka;++b)this.PIb[b]=this.J$c.Ma(this.sAd(b));this.next()}function a(){this.d8c=new M;this.nR=new M;this.pkc=this.KMb=0;this.jnb=new M}L(c,"geotoolkit.deviation.PiecewiseLinearIteratorImpl");c.prototype.wua=function(b){return 0<=b&&b<this.Rka?this.PIb[b]:new M};c.prototype.sAd=function(b){return 0<=b&&b<this.Rka?new M(this.Op.getX(b),this.Op.getY(b)):
new M};c.prototype.depth=function(b){return 0<=b&&b<this.Rka?this.Op.Sb(b):0};c.prototype.object=function(){return this.ei};c.prototype.end=function(){return 0===this.Rka||this.Uqa===this.Rka-1};c.prototype.next=function(){this.ei.lVb()&&(this.Uqa=this.ei.lVb());this.end()||(this.ei=this.tSb())};c.prototype.center=function(b,d){for(var e=0,f=0,g=d-b+1;b<=d;++b){var h=this.wua(b);e+=h.getX();f+=h.getY()}return new M(e/g,f/g)};c.prototype.GHc=function(b,d,e){for(var f=this.center(b,d),g=0,h=0,k=0;b<=
d;++b){var l=this.wua(b),m=l.getX()-f.getX();l=l.getY()-f.getY();g+=l*l;h-=m*l;k+=m*m}e.jnb=f;d=g+k;g=.5*(g-k);k=Math.sqrt(h*h+g*g);e.pkc=.5*d+k;e.nR.Ga(-h,g-k);h=HO.gIa(e.nR,e.nR);0===h?e.nR.Ga(1,0):(h=Math.sqrt(h),e.nR.Ga(e.nR.getX()/h,e.nR.getY()/h));e.KMb=d-e.pkc;e.d8c=new M(-e.nR.getY(),e.nR.getX())};c.prototype.TUb=function(b,d,e,f,g){b=d*(this.depth(e)-b);f=M.Uf(g,f);return Math.abs(b-f)};c.prototype.Ste=function(b,d,e){if(2>d-b)return 0;e=new JO(e.nR,-HO.gIa(e.nR,e.jnb));for(var f=0;b<=d;++b){var g=
Math.abs(e.distance(this.wua(b)));f<g&&(f=g)}return f};c.prototype.Idd=function(b,d,e){if(2>d-b)return!0;e=new JO(e.nR,-HO.gIa(e.nR,e.jnb));var f=e.project(this.wua(b)),g=e.project(this.wua(d)),h=this.depth(b),k=this.depth(d);if(Math.abs(k-h)<V.Qb)return!1;g=M.Uf(f,g)/(k-h);for(var l,m=b+1;m<=d&&(l=e.project(this.wua(m)))===f;){if(this.TUb(h,g,m,f,l)>this.njb.getX())return!1;++m}if(m>d)return!0;l=e.project(this.wua(m));if(this.TUb(h,g,m,f,l)>this.njb.getX())return!1;b=V.sign(l.getX()-f.getX());k=
V.sign(l.getY()-f.getY());for(m+=1;m<=d;++m){var n=e.project(this.wua(m));if(this.TUb(h,g,m,f,n)>this.njb.getX())return!1;if(n!==l){if(V.sign(n.getX()-l.getX())!==b||V.sign(n.getY()-l.getY())!==k)return!1;l=n}}return!0};c.prototype.tSb=function(){var b=this.Rka-this.Uqa-1,d=this.Uqa+1,e=new a,f=new a;if(1<b)for(;0<b;){var g=Math.floor(b/2);var h=d+g;this.GHc(this.Uqa,h,f);var k=Math.abs(f.KMb)>V.Qb?Math.sqrt(Math.abs(f.KMb)):0;if(k<=this.njb.getY()&&this.Idd(this.Uqa,h,f)){e=f;var l=k;d=h;b-=g+1}else b=
g}else this.GHc(this.Uqa,this.Rka-1,e),l=0,d=this.Rka-1;return new bV(this.Uqa,d,l,new JO(e.nR,-HO.gIa(e.nR,e.jnb)))};return c}();var dV=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a){FO.call(this);a=G(a,{minWidth:1,maxWidth:Infinity,widthScale:25});this.OU=a.minWidth;this.IU=a.maxWidth;this.yRb=a.widthScale}D(c,FO);L(c,"geotoolkit.deviation.ProportionalWidthStrategy");c.prototype.ca=function(a,b){var d=b.width;b=b.trajectory;2>b.count()?a=1:(a=this.tXb(b,a),a=a.deviceLength/a.length);d*=this.yRb*a;d<this.OU&&(d=this.OU);d>this.IU&&(d=this.IU);return d};c.prototype.ia=function(){return{maxwidth:this.IU,minwidth:this.OU,widthscale:this.yRb}};c.prototype.fa=
function(a){a=hc(a);if(null==a)return this;a.minwidth&&(this.OU=a.minwidth);a.maxwidth&&(this.IU=a.maxwidth);a.widthscale&&(this.yRb=a.widthscale);return this};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXaWR0aCI6ImNhIiwiZ2V0UHJvcGVydGllcyI6ImlhIiwic2V0UHJvcGVydGllcyI6ImZhIn19fSAg");var eV=/*#__PURE__*/function(){function c(b,d,e){FR.call(this,b,null,e);this.qca=this.Kj=null;this.kAa=function(){var f=this.Kj.wa().transform(this.Kj.Avb());this.qca.sa(this.$a.wa().nc(f));this.H1&&this.qca.uo(new Oe(Ed.fromRect(this.Kj.getParent().vb())))}.bind(this);this.Tx(d,a(d))}function a(b){if(null==b)return null;b=b.getParent();return null==b?null:mc(b,fp)?b:a(b)}D(c,FR);L(c,"geotoolkit.deviation.tools.DeviatedAdapter");c.prototype.nt=function(){return this.Kj};c.prototype.Tx=function(b,d){this.Fd=b;
this.Kj=d;this.qca=this.Kj.jJa?this.Kj.jJa():this.Kj.clone();this.qca.kb("ghost_node");this.kAa();this.Kj.on(Ce.RI,this.kAa);this.$a.oa(this.qca);return this};c.prototype.contains=function(b){b=this.Kj.nc(b);return!isNaN(b.getX())&&!isNaN(b.getY())};c.prototype.rBb=function(b,d,e){d=this.Kj.nc(d);return isNaN(d.getX())||isNaN(d.getY())?!1:FR.prototype.rBb.call(this,b,d,e)};c.prototype.JBb=function(b){b=this.Kj.nc(b);return isNaN(b.getX())||isNaN(b.getY())?null:this.Kj.wa().transform(b)};c.prototype.O9b=
function(b){b=this.Kj.wa().nc(b);return this.Kj.transform(b)};c.prototype.Vdb=function(b){b=this.$a.wa().transform(b);b=this.Kj.nc(b).clone();return isNaN(b.getX())||isNaN(b.getY())?null:b};c.prototype.Udb=function(b){if(!b)return null;b=this.Kj.transform(new M(this.Kj.pa().ca()/2,b.getY()));return this.$a.wa().nc(b)};c.prototype.intersect=function(b){var d=this.Kj.Jw(this.$a.wa().rc());d.PFc(b);b=d.ce();for(var e=d.Fe(),f=this.$a.wa(),g=Infinity,h=-Infinity,k=0;k<d.getSize();k++){var l=this.Kj.nc(f.transform(new M(b[k],
e[k])));l.getY()<g&&(g=l.getY());l.getY()>h&&(h=l.getY())}return new U(0,g,this.Kj.pa().ca(),h)};c.prototype.OHc=function(){return!0};c.prototype.ec=function(){return this.qca};c.prototype.dispose=function(){this.Kj&&(this.Kj.za(Ce.RI,this.kAa),this.Kj=null);this.qca&&(this.qca.dh(),this.qca.dispose(),this.qca=null)};c.qm=function(b){return null!=a(b)};c.yZb=function(){return 2};return c}();var fV=/*#__PURE__*/va(/*#__PURE__*/{qYa:"onDeviationChanged"},2,"eyJEZXZpYXRpb25DaGFuZ2VkIjoicVlhIn0g"),gV=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a){Th.call(this,a);this.Sa=this.Dl=this.Ri=null;this.jka=new M}D(c,Th);lc(c,fp);L(c,"geotoolkit.scene.DeviatedCompositeNode");GR.ya().register(eV);c.Lhd=!1;c.Ja=fV;c.prototype.addListener=function(a,b){this.on(a,b);return this};c.prototype.removeListener=function(a,b){this.za(a,b);return this};c.prototype.EIc=function(){this.notify(fV.qYa,this)};c.prototype.uC=function(a){null==a?this.Ri=null:(this.Ri||(this.Ri=new WO),this.Ri.uC(a));this.EIc();
this.xa();this.ha();return this};c.prototype.Pk=function(){return this.Ri?this.Ri.Pk():null};c.prototype.jJa=function(){var a=new c;a.Ri=this.Ri;return a};c.prototype.transform=function(a){return this.Ri?this.Ri.eg.transform(a):a};c.prototype.nc=function(a){return this.Ri?this.Ri.eg.nc(a):a};c.prototype.pa=function(){var a=this.Pk();if(!a)return null;var b=a.trackWidth;return(a=a.trajectory)?new U(0,a.Of(),b,a.Nf()):null};c.prototype.ga=function(){return this.Sa?this.Sa.lock():this.Avb()};c.prototype.sa=
function(a){if(null!=this.Sa&&this.Sa.wi(a))return this;this.Ag();this.Sa!==a&&(this.Sa=null!=a?new U(a):a);this.xa();this.Ag();return this};c.prototype.Avb=function(){var a=this.Pk();if(!a)return null;a=a.trajectory;return new U(a.Nma(),a.Oma(),a.Ima(),a.Jma())};c.prototype.Iud=function(){return this.Ri.Uva()};c.prototype.Jw=function(a){var b=this.Pk();if(!b)return null;var d=[],e=b.trajectory;this.Ri.eg.II([new M(0,e.Of()),new M(b.trackWidth,e.Of()),new M(b.trackWidth,e.Nf()),new M(0,e.Nf()),new M(0,
e.Of())],d,this.Ri.Se,!0);d=d.map(function(f){return a.transform(f)});return new th(d.map(function(f){return f.getX()}),d.map(function(f){return f.getY()}))};c.prototype.Mud=function(){var a=this.Pk();if(!a)return null;var b=a.trajectory;a=this.Ri.mF(new M(a.trackWidth/2,b.Of()),new M(a.trackWidth/2,b.Nf()));return Hd.getBoundingBox(a)};c.prototype.xa=function(a,b){Th.prototype.xa.call(this,a,b);this.Dl=null;return this};c.prototype.Yd=function(){if(null!=this.Dl)return this.Dl;var a=this.ga(),b=
this.Avb();null!=b&&(0===b.ca()&&b.Ra(1),0===b.da()&&b.Ya(1));null==a||a.isEmpty()||null==b||b.isEmpty()||(this.Dl=W.Sd(b,a,!1,!1,!1));return this.Dl};c.prototype.R9b=function(a){var b=this.Ri,d=[];a=[a.bd(),new M(a.na(),a.ka()),a.nf(),new M(a.la(),a.ma())];b.eg.II(a,d,b.Se,!0);return Hd.getBoundingBox(d)};c.prototype.Ag=function(a,b){if(!this.Ri||!this.Ri.be)return this;var d=this.getParent();if(d){if(a){var e=this.R9b(a);e=d.wa().pd(e)}else e=d.pa();d.ha(e,b)}if(this.FD)for(d=0;d<this.FD.length;++d)if(e=
this.FD[d])if("function"==typeof e)e.call(this,a,b);else e.onInvalidate(a,b);return this};c.prototype.getBoundingBox=function(a){a||(a=this.getParent()?this.getParent().wa():new W);var b=this.ga();if(null!=b){var d=this.lb();null!=d&&(b=d.Ta(b));b=a.Ta(b);d=this.Pk();null!=d&&null!=d.trackWidth&&b.Uc(d.trackWidth);b=a.nc(b)}return b};c.prototype.bf=function(a){if(!this.Ia())return!1;var b=this.ga();if(null!=b){var d=this.lb();null!=d&&(b=d.Ta(b));b=a.Fa().Ta(b);d=this.Pk();null!=d&&null!=d.trackWidth&&
b.Uc(d.trackWidth);if(!a.jg().Nd(b))return!1}return!0};c.prototype.render=function(a){if(this.Pk()){a=null!=this.Qa()?a.Zb(this.Qa()):a;a.save();this.Eh(a);this.Ri.update(a);var b=a.jg(),d=a.Fa().pd(b);d=this.Ri.bFa(d);if(d.isEmpty())this.jh(a),a.restore();else{if(this.Ri.Pk().clip){var e=this.R9b(d);e=e.intersect(b);a.fh(e)}this.Ri.$Va(d);for(b=this.vf();b.Kg();)d=b.next(),this.Ri.filter(d)&&(this.Ri.yh(d),d.render(this.Ri));this.jh(a);a.restore();c.Lhd&&(d=this.Pk().trajectory,this.Ri.yh(null),
this.Ri.Lvc(new X("red",2)),this.Ri.U9().ra(new X("red",1)),this.Ri.U9().qa(null),b=a.Fa().nc(this.Iud()),this.Ri.U9().sc(b),this.Ri.U9().ra(new X("black",2)),this.Ri.Nc(this.Pk().trackWidth/2,d.Of(),this.Pk().trackWidth/2,d.Nf()),this.Ri.U9().ra(new X("green",1)),b=a.Fa().nc(this.Mud()),this.Ri.U9().sc(b),this.Ri.U9().ra(new X("blue",1)),b=new U(0,d.Of(),this.Pk().trackWidth,d.Nf()),this.Ri.sc(b))}}else Th.prototype.render.call(this,a)};c.prototype.we=function(a,b){if(this.Pk()){var d=null!=this.Qa()?
a.Zb(this.Qa()):a;d.save();this.Ri.update(d);a=d.jg();var e=d.Fa().pd(a);e=this.Ri.bFa(e);if(e.isEmpty())d.restore(),b();else{if(this.Ri.Pk().clip){var f=this.R9b(e);f=f.intersect(a);d.fh(f)}this.Ri.$Va(e);var g=this;Hg.sM(this.vf(),function(h,k){g.Ri.filter(h)?(g.Ri.yh(h),h.we(g.Ri,k)):k()},function(){d.restore();c.bwe&&g.Ri.Lvc(new X("red",2));b&&b()})}}else Th.prototype.we.call(this,a,b)};c.prototype.mjd=function(a,b){if(null==this.Ri)return null;this.Ri.reb(this.wa());a=this.Ri.bFa(a);if(a.isEmpty())return null;
b?b.Lk(a.ka(),a.ma()):b=new Jd(a.ka(),a.ma());return b};c.prototype.OVc=function(){this.Ri&&this.Ri.reb(this.wa());return this};c.prototype.ezc=function(){if(null==this.Ri)return null;this.Ri.reb(this.wa());return this.Ri.eg};c.prototype.vb=function(a){var b=this.getParent(),d=this.pa(),e=Vi.Dm();null!=b&&null!=b.pa()&&(e=new U(b.Ki(a)),null!=this.Ri&&null!=this.Ri.eg&&(b=this.Ri.eg.Se.pd(e),e=this.Ri.bFa(b)));if(null==d||e.isEmpty())return d;a||e.intersect(d);return e};c.prototype.Iaa=function(a){null!=
this.Ri&&this.Ri.Iaa(a);return this};c.prototype.iwa=function(){return null==this.Ri?!1:this.Ri.iwa()};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJvbkRldmlhdGlvbkNoYW5nZWQiOiJFSWMiLCJzZXREZXZpYXRpb24iOiJ1QyIsImdldERldmlhdGlvbiI6IlBrIiwic2hhbGxvd0Nsb25lIjoiakphIiwiaW52ZXJzZVRyYW5zZm9ybSI6Im5jIiwiZ2V0TW9kZWxMaW1pdHMiOiJwYSIsImdldEJvdW5kcyI6ImdhIiwic2V0Qm91bmRzIjoic2EiLCJnZXRUcmFqZWN0b3J5TGltaXRzIjoiQXZiIiwiZ2V0T3V0bGluZSI6Ikp3IiwidXBkYXRlU3RhdGUiOiJ4YSIsImdldENvbnRlbnRzVHJhbnNmb3JtIjoiWWQiLCJpbnZhbGlkYXRlUGFyZW50IjoiQWciLCJjaGVja0NvbGxpc2lvbiI6ImJmIiwicmVuZGVyQXN5bmMiOiJ3ZSIsImZpbmREZXB0aFJhbmdlIjoibWpkIiwiZ2V0RGV2aWF0ZWRUcmFuc2Zvcm1hdGlvbiI6ImV6YyIsImdldFZpc2libGVNb2RlbExpbWl0cyI6InZiIiwic2V0V2ViR0xSZW5kZXJpbmciOiJJYWEiLCJnZXRXZWJHTFJlbmRlcmluZyI6Iml3YSJ9fX0g");var hV=/*#__PURE__*/va(/*#__PURE__*/function(){function c(f){f=xb(f,{fillstyle:null,alignment:O.Je,offset:0});Th.call(this,f);this.ea=f;this.ea.children&&this.oa(this.ea.children);this.El=null;this.Kj=f.deviatednode;this.Kj.on(fV.qYa,this.sb());this.eg=null;this.Joc=new W}var a=W.Xj,b=new M,d=new U,e=50;D(c,Th);L(c,"geotoolkit.scene.DeviatedHeader");c.prototype.sb=function(){null==this.El&&(this.El=function(f,g,h){g===this.Kj&&this.ha(void 0,!0);return this}.bind(this));return this.El};c.prototype.dispose=function(){this.ge()||
(this.Kj.za(fV.qYa,this.sb()),Th.prototype.dispose.call(this))};c.prototype.OVc=function(f){f=f.Fa();if(this.eg)this.eg.update(f);else{var g=this.Kj.Pk();this.eg=g.transformer.create(g,f)}return this.eg};c.prototype.fzc=function(){var f=null;if(0<this.Yb()){var g=this.eb(0);"function"===typeof g.cl&&(f=g.cl());f||"function"!==typeof g.ga||(f=g.ga());f&&(f.setX(0),f.setY(0),void 0!==this.ea.height&&f.Ya(this.ea.height))}f||(f=this.Kj.Pk().trackWidth,g=void 0!==this.ea.height?this.ea.height:e,f=new U(0,
0,f,g));return f};c.prototype.Mmd=function(f){var g=this.Kj.Pk().trackWidth;if(this.ea.alignment===O.Je){var h=-f;f=0}else h=0;return d.cb(-g/2,h,g/2,f)};c.prototype.bf=function(f){if(1>this.Yb())return!1;var g=this.wcd(f);this.Joc=W.multiply(f.Fa().rc(),g);g.Ta(this.fzc(),d);f=f.jg();return d.Nd(f)};c.prototype.Kc=function(f){if(f)throw Error("setLocalTransform is not allowed");return this};c.prototype.Yd=function(){return this.Joc};c.prototype.wcd=function(f){this.OVc(f);f=this.Kj.pa();var g=this.ea.alignment===
O.Je?f.ka():f.ma();b.Ga(f.la(),g);var h=this.eg.transform(b,a);b.Ga(f.na(),g);var k=this.eg.transform(b,a);g=Math.atan2(k.getY()-h.getY(),k.getX()-h.getX());f=(k.getX()+h.getX())/2;h=(k.getY()+h.getY())/2;0!==this.ea.offset&&(k=this.ea.offset*Math.sin(-g),f+=k,k=this.ea.offset*Math.cos(-g),h+=k);k=this.fzc();k=W.Sd(k,this.Mmd(k.da()));g=W.Xi(g,0,0);f=W.cf(f,h);g=W.multiply(g,k);W.multiply(f,g,g);return g};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRJbnZhbGlkYXRlTWV0aG9kIjoic2IiLCJjaGVja0NvbGxpc2lvbiI6ImJmIiwic2V0TG9jYWxUcmFuc2Zvcm0iOiJLYyIsImdldENvbnRlbnRzVHJhbnNmb3JtIjoiWWQifX19");var iV=/*#__PURE__*/function(){function c(a){hb("DeviationTool and inheritors are deprecated since 2020.1 (3.1) Use Carnac tools instead");IR.call(this,a);this.eg=this.Kj=null;this.Jc=this.$a instanceof Am?this.$a.getParent():this.$a}D(c,IR);L(c,"geotoolkit.deviation.tools.DeviationTool");c.prototype.oFd=function(){var a=this.Kj.Pk(),b=this.Kj.wa();this.eg=a.transformer.create(a,b)};c.prototype.iSa=function(){if(null==this.Kj){var a=jf(this.$a.getRoot()).mc(function(b){return b instanceof gV}).qN();null!=a&&0<
a.length&&(this.Kj=a[0],this.Kj.addListener(fV.qYa,function(){this.oFd()}.bind(this)))}return this.Kj};return c}();var jV=/*#__PURE__*/va(/*#__PURE__*/function(){function c(){oi.call(this);this.ug(!1);this.xj=new Fk;this.oa(this.xj);this.Uh=(new ek({textstyle:new Ki})).vt(!0);this.oa(this.Uh);this.w1=0;this.Vr(aV.Na);this.Wmc=null}D(c,oi);c.prototype.ha=function(a,b){this.Ia()&&(null==a?(this.Uh&&this.Ag(this.Uh.ga(),b),this.xj&&this.Ag(this.xj.ga(),b)):this.Ag(a,b));return this};c.prototype.setData=function(a,b,d){this.Wmc=d;this.xj.wb(!1);this.xj.Oq({from:a,to:b});this.xj.wb(!0);this.Uh.wb(!1);var e=Math.atan2(b.getY()-a.getY(),b.getX()-
a.getX());a=this.elb===aV.Na?new M((a.getX()+b.getX())/2,(a.getY()+b.getY())/2):this.elb===aV.kc?new M(a.getX(),a.getY()):new M(b.getX(),b.getY());d=null!=this.Uh.tib?this.Uh.tib(d.getX(),d.getY()):d.toString();this.Uh.Eb(d);0!==this.w1&&this.Uh.rotate(-this.w1,this.Uh.pn(),this.Uh.Vl());this.Uh.Db(a);this.w1=e;0!==this.w1&&this.Uh.rotate(this.w1,this.Uh.pn(),this.Uh.Vl());this.Uh.wb(!0);this.ha();return this};c.prototype.getData=function(){return this.Wmc};c.prototype.xt=function(a){a&&(a.line&&
this.cLd(a.line),a.label&&this.$w(a.label));return this};c.prototype.cLd=function(a){void 0!==a.linestyle&&this.xj.ra(a.linestyle);null!=a.visible&&this.xj.va(a.visible)};c.prototype.Vr=function(a){this.elb=a;this.elb===aV.Na?this.Uh.tc(O.Je):this.elb===aV.kc?this.Uh.tc(O.cg):this.Uh.tc(O.lh)};c.prototype.$w=function(a){void 0!==a.textstyle&&this.Uh.ib(a.textstyle);null!=a.visible&&this.Uh.va(a.visible);void 0!==a.textconverter&&(this.Uh.tib=a.textconverter);null!=a.position&&this.Vr(a.position)};
return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZhbGlkYXRlIjoiaGEifX19");var kV=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a,b){PR.call(this,a);this.De=b}D(c,PR);c.prototype.bc=function(){return this.De};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRQb3NpdGlvbiI6ImJjIn19fSAg");var lV=/*#__PURE__*/va(/*#__PURE__*/{Qx:"onPositionChanged"},2,"eyJvblBvc2l0aW9uQ2hhbmdlZCI6IlF4In0g"),mV=/*#__PURE__*/va(/*#__PURE__*/function(){function c(d,e){iV.call(this,{slots:{pointermove:this.Ac.bind(this),"cg-leave":this.Ry.bind(this)},name:"string"===typeof e&&""!==e?e:"MD-cursor",layer:d instanceof oi||d instanceof Am||d&&"geotoolkit.schematics.scene.SimpleLayer"===d.Oa()?d:null});this.lqa=new jV;this.xt({line:{linestyle:(new X("black",1,[3,2])).Mg({x:!0,y:!0})}});this.$a.oa(this.lqa);this.qda=null}var a=new M,b=new W;D(c,iV);L(c,"geotoolkit.deviation.tools.MDCursorTool");c.Ja=lV;c.prototype.Km=
function(){var d=this.isEnabled();this.lqa.va(d);this.$a.ha();iV.prototype.Km.call(this)};c.prototype.xt=function(d){null!=d.enabled&&this.Ob(d.enabled);this.lqa.xt(d);return this};c.prototype.yue=function(d){this.setActive(!1)};c.prototype.Ac=function(d){if(this.isEnabled()){var e=this.iSa();if(e){var f=e.Pk();null!=f&&(e=e.wa(),this.eg?this.eg.update(e):this.eg=f.transformer.create(f,e),f=this.jga(d),a.Ga(f.x,f.y),f=this.eg.nc(a),isNaN(f.getX())||isNaN(f.getY())?(this.lqa.va(!1),null!==this.qda&&
(this.qda=null,this.fireEvent(c.Ja.Qx,new kV(d,this.qda)))):(this.paa(f),this.lqa.va(!0),this.setActive(!0),null!=this.qda&&V.equals(this.qda.getY(),f.getY())&&V.equals(this.qda.getX(),f.getX())||(this.qda=f,this.fireEvent(c.Ja.Qx,new kV(d,this.qda)))))}}};c.prototype.Ry=function(d){this.fireEvent(HR.Ry,new kV(d,null))};c.prototype.update=function(){if(this.isEnabled()){var d=this.lqa.getData(),e=this.iSa();null!=d&&null!=e&&(this.eg.update(e.wa()),this.paa(d))}};c.prototype.paa=function(d){if(d){var e=
this.iSa();if(e){var f=e.Pk();if(f){e=e.wa();this.eg?this.eg.update(e):this.eg=f.transformer.create(f,e);a.Ga(0,d.getY());e=this.eg.transform(a,b);f=f.trackWidth;a.Ga(f,d.getY());f=this.eg.transform(a,b);var g=this.Jc.wa();null!=g&&(e=g.hd(e),f=g.hd(f));this.lqa.setData(e,f,d)}}}else this.lqa.va(!1),null!==this.qda&&(this.qda=null)};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJvbkFjdGl2ZVN0YXRlQ2hhbmdlZCI6IkttIiwic2V0U2V0dGluZ3MiOiJ4dCIsInNldEN1cnNvciI6InBhYSJ9fX0g");var nV=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a,b){PR.call(this,a);b=G(b,{},!0);void 0!==b.area&&(this.qB=b.area);void 0!==b.startmd&&(this.q$c=b.startmd);void 0!==b.endmd&&(this.m6c=b.endmd)}D(c,PR);L(c,"geotoolkit.deviation.tools.MDRubberBandEventArgs");c.prototype.Atd=function(){return this.q$c};c.prototype.jnd=function(){return this.m6c};c.prototype.getArea=function(){return this.qB};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTdGFydE1EIjoiQXRkIiwiZ2V0RW5kTUQiOiJqbmQifX19");var oV=/*#__PURE__*/va(/*#__PURE__*/{TEb:"md",l1:"xy"},2,"eyJNRCI6IlRFYiIsIlhZIjoibDEifSAg"),pV=/*#__PURE__*/function(){function c(f,g){this.te=g||oV.l1;g="md"===this.te?{pointerdown:this.xBd.bind(this),pointermove:this.zBd.bind(this),pointerup:this.BBd.bind(this)}:{pointerdown:this.yBd.bind(this),pointermove:this.ABd.bind(this),pointerup:this.CBd.bind(this)};iV.call(this,{slots:g,layer:f,name:"MD-rubberband"});this.Ob(!1);this.u2=!0;this.Gda=(new Vm).va(!1).ra((new X(a,1,[2,3])).Mg({x:!1,y:!1})).qa(new rf(b));null!=this.$a&&this.$a.oa(this.Gda);this.m4a=(new ho(new U(0,0,0,
0))).va(!1).ra((new X("red",2)).Mg({x:!0,y:!0})).qa(null);null!=this.$a&&this.$a.oa(this.m4a);this.pJ=null;this.zw=NaN;this.Cb=0;this.JU=this.rR=NaN;this.Kpb=new M;this.Jpb=new M;this.P3a=new U}var a="#bdbdbd",b="rgba(189,189,189,0.5)",d=new M,e=new W;D(c,iV);L(c,"geotoolkit.deviation.tools.MDRubberBand");c.Av=oV;c.prototype.zQd=function(){var f=this.iSa();if(!f)return null;var g=f.Pk(),h=f.wa();this.eg?this.eg.update(h):this.eg=g.transformer.create(g,h);this.zw=g.trackWidth;this.Cb=g.offset;return f};
c.prototype.$Sb=function(f){var g=this.iSa();if(!g)return d.Ga(NaN,NaN);var h=g.Pk();g=g.wa();this.eg?this.eg.update(g):this.eg=h.transformer.create(h,g);this.zw=h.trackWidth;this.Cb=h.offset;f=this.jga(f);d.Ga(f.x,f.y);return this.eg.nc(d)};c.prototype.xBd=function(f){var g=this.$Sb(f);isNaN(g.getX())||isNaN(g.getY())||(f.stopPropagation(!0),this.setActive(!0),this.rR=g.getY(),this.fireEvent(kU.Ja.ZP,new nV(f,{startMD:this.rR})))};c.prototype.BBd=function(f){if(this.Hd()){var g=this.$Sb(f);isNaN(g.getX())||
isNaN(g.getY())?this.Hd()&&(this.setActive(!1),this.Gda.va(!1).ha()):(f.stopPropagation(!0),this.setActive(!1),this.Gda.va(!1).ha(),this.fireEvent(kU.Ja.coa,new nV(f,{startMD:this.rR,endMD:this.JU})),g=new U(this.POa.getX(),this.POa.getY(),this.QOa.getX(),this.QOa.getY()),this.fireEvent(kU.Ja.ov,new nV(f,{area:g})),this.u2&&this.Ob(!1))}};c.prototype.tOc=function(){var f=this.Jc.wa(),g=null;f&&(g=f.rc());var h=[new M(0,this.rR),new M(this.zw,this.rR),new M(this.zw,this.JU),new M(0,this.JU)];f=[];
this.eg.II(h,f,e,!0);d.Ga(this.zw/2-this.Cb,this.rR);this.POa=this.eg.transform(d,e);d.Ga(this.zw/2-this.Cb,this.JU);this.QOa=this.eg.transform(d,e);if(g)for(g.Ma(this.POa,this.POa),g.Ma(this.QOa,this.QOa),h=0;h<f.length;++h)g.Ma(f[h],f[h]);var k=[],l=[];f.forEach(function(m){k.push(m.getX());l.push(m.getY())});this.Gda.he(k,l)};c.prototype.zBd=function(f){if(this.Hd()){var g=this.$Sb(f);isNaN(g.getX())||isNaN(g.getY())||(f.stopPropagation(!0),this.JU=g.getY(),this.tOc(),this.Gda.va(!0).ha(),this.fireEvent(kU.Ja.coa,
new nV(f,{startMD:this.rR,endMD:this.JU})))}};c.prototype.yBd=function(f){this.Opc=this.Kd(this.$a,f);var g=this.jga(f);this.Kpb.Ga(Math.round(g.x),Math.round(g.y));f.stopPropagation(!0);this.setActive(!0);this.zQd()};c.prototype.CBd=function(f){if(this.Hd()&&(f.stopPropagation(!0),this.setActive(!1),this.Gda.va(!1).ha(),this.m4a.va(!1).ha(),!isNaN(this.JU)&&!isNaN(this.rR))){this.fireEvent(kU.Ja.coa,new nV(f,{startMD:this.rR,endMD:this.JU}));var g=new U(this.POa.getX(),this.POa.getY(),this.QOa.getX(),
this.QOa.getY());this.fireEvent(kU.Ja.ov,new nV(f,{area:g}));this.u2&&this.Ob(!1)}};c.prototype.nxa=function(f,g){d.Ga(f,g);f=this.eg.nc(d).getY();isNaN(f)||(f<this.rR&&(this.rR=f),f>this.JU&&(this.JU=f))};c.prototype.Mcd=function(){var f=this.iSa();if(f){this.rR=Number.POSITIVE_INFINITY;this.JU=Number.NEGATIVE_INFINITY;var g=this.P3a.ka();f=this.P3a.ma();for(var h=this.P3a.la(),k=this.P3a.na(),l=h;l<k;l+=10)this.nxa(l,g),this.nxa(l,f);this.nxa(k,g);for(this.nxa(k,f);g<f;g+=10)this.nxa(h,g),this.nxa(k,
g);this.nxa(h,f);this.nxa(k,f)}else this.JU=this.rR=NaN};c.prototype.ABd=function(f){if(this.Hd()){var g=this.jga(f);this.Jpb.Ga(Math.round(g.x),Math.round(g.y));if(this.Jpb.x!==this.Kpb.x&&this.Jpb.y!==this.Kpb.y){g=function(k,l,m){k.cb(Math.min(l.x,m.x),Math.min(l.y,m.y),Math.max(l.x,m.x),Math.max(l.y,m.y))};g(this.P3a,this.Kpb,this.Jpb);var h=this.Kd(this.$a,f);!1===this.m4a.Ia()&&this.Opc.Ew(h)||(this.nad=h,g(this.m4a,this.Opc,this.nad),this.m4a.va(!0).ha(),this.Mcd(),isNaN(this.JU)||isNaN(this.rR)?
this.Gda.va(!1).ha():(this.tOc(),this.Gda.va(!0).ha()),f.stopPropagation(!0),this.fireEvent(kU.Ja.coa,new nV(f,{startMD:this.rR,endMD:this.JU})))}}};c.prototype.setOptions=function(f){null!=f.enabled&&this.Ob(f.enabled);void 0!==f.linestyle&&this.Gda.ra(f.linestyle);void 0!==f.fillstyle&&this.Gda.qa(f.fillstyle);null!=f.autodisabled&&(this.u2=f.autodisabled);void 0!==f.mode&&(this.te=f.mode);return this};return c}();var qV=/*#__PURE__*/va(/*#__PURE__*/function(){function c(e,f,g,h,k){g=(k-h)/(g-f);return g*(e-f)+h}function a(e,f){return e&&f&&e.t9()===f.t9()&&e.Tc()===f.Tc()}function b(e,f,g,h,k,l){void 0!==h&&hb("geotoolkit.deviation.Trajectory2d parameter minDepth deprecated since 2020 (3.0). minDepth is calculated inside");void 0!==k&&hb("geotoolkit.deviation.Trajectory2d parameter maxDepth deprecated since 2020 (3.0). maxDepth is calculated inside");void 0!==l&&hb("geotoolkit.deviation.Trajectory2d parameter approximate deprecated since 2021.1 (3.3). Use properties object instead (x.options.approximate)");
this.NH=Zd.ya();this.ea={approximate:l||!0,depthinterval:d,units:{distance:"ft"}};e&&!Array.isArray(e)&&(g=e.data,h=e.options,e=g.x,f=g.y,g=g.d,G(h,this.ea));this.h5a=this.S8=this.Q8=null;this.Kga({x:e,y:f,d:g})}var d=.001;L(b,"geotoolkit.deviation.Trajectory2d");b.prototype.Kga=function(e){var f=e.x,g=e.y;e=e.d;if(!(!f||1>f.length||!g||1>g.length||f.length!==g.length)){var h;if(!e)for(e=[0],h=1;h<f.length;h++){var k=f[h]-f[h-1],l=g[h]-g[h-1];e.push(e[h-1]+Math.sqrt(k*k+l*l))}this.Vc=[f[0]];this.zd=
[g[0]];this.rg=[e[0]];k=new M;l=new M;for(h=1;h<e.length;h++)Math.abs(e[h]-e[h-1])<this.ea.depthinterval||(k.Ga(f[h-1],g[h-1]),l.Ga(f[h],g[h]),M.Uf(k,l)<V.Qb||(this.Vc.push(f[h]),this.zd.push(g[h]),this.rg.push(e[h])));this.OG(this.ea.units);this.jeb();this.sne=this.ea.approximate}};b.prototype.vQd=function(e,f,g,h,k,l){if(e&&!a(e,f)&&e.lm(f)){var m=[];this.Vc.forEach(function(q){q=e.convert(q,f);m.push(q)});this.Vc=m}if(g&&!a(g,h)&&g.lm(h)){var n=[];this.zd.forEach(function(q){q=g.convert(q,h);n.push(q)});
this.zd=n}if(k&&!a(k,l)&&k.lm(l)&&this.Q8===this.S8){var p=[];this.rg.forEach(function(q){q=k.convert(q,l);p.push(q)});this.rg=p}this.jeb()};b.prototype.OG=function(e){if(!e)return this;var f=this.Q8,g=this.S8,h=this.h5a;if(e.distance){var k=this.NH.Wa(e.distance);if(!k||!k.xA("length"))throw new TypeError("distance-unit must belong to length units!");this.h5a=this.S8=this.Q8=k;this.ea.units.x=e.distance;this.ea.units.y=e.distance}else{f||e.x||(e.x=e.y);g||e.y||(e.y=e.x);if(e.x){k=this.NH.Wa(e.x);
if(!k||!k.xA("length"))throw new TypeError("x-unit must belong to length units!");this.Q8=k;this.ea.units.x=e.x}if(e.y){k=this.NH.Wa(e.y);if(!k||!k.xA("length"))throw new TypeError("y-unit must belong to length units!");this.S8=k;this.ea.units.y=e.y}}this.vQd(f,this.Q8,g,this.S8,h,this.h5a);return this};b.prototype.Dvb=function(){this.Q8||this.OG(this.ea.units);return this.Q8};b.prototype.Evb=function(){this.S8||this.OG(this.ea.units);return this.S8};b.prototype.Vud=function(){this.h5a||this.OG(this.ea.units);
return this.h5a};b.prototype.wTa=function(){return xb(this.ea.units,{})};b.Pa=function(e){if(!e)return null;if(e instanceof b)return e.id=Be.Py(),e;var f=e.md;f=new b({data:{x:e.x,y:e.y,d:f}});void 0===e.id&&(e.id=Be.Py());f.id=e.id;return f};b.prototype.jeb=function(){this.P7=Math.min.apply(null,this.Vc);this.I7=Math.max.apply(null,this.Vc);this.Q7=Math.min.apply(null,this.zd);this.J7=Math.max.apply(null,this.zd);this.Zq=Math.min.apply(null,this.rg);this.Fr=Math.max.apply(null,this.rg)};b.prototype.NFc=
function(e,f){var g=this.rg.length;if(2>g)return hb("Can not extrapolate: less than 2 stations!"),null;f||(f=new M);if(e<=this.rg[0]){var h=0;var k=1}else if(e>=this.rg[g-1])h=g-2,k=g-1;else for(var l=1;l<g;++l)if(e<this.rg[l]){h=l-1;k=l;break}g=c(e,this.rg[h],this.rg[k],this.Vc[h],this.Vc[k]);e=c(e,this.rg[h],this.rg[k],this.zd[h],this.zd[k]);f.Ga(g,e);return f};b.prototype.nwc=function(e){if(2>this.rg.length)return rb("Can not extrapolate: less than 2 stations!"),!1;var f=1,g=0,h=c(e,this.rg[f],
this.rg[g],this.Vc[f],this.Vc[g]);f=c(e,this.rg[f],this.rg[g],this.zd[f],this.zd[g]);Math.abs(e-this.rg[g])<this.ea.depthinterval?(this.Vc[g]=h,this.zd[g]=f,this.rg[g]=e):(this.Vc.unshift(h),this.zd.unshift(f),this.rg.unshift(e));this.jeb();return!0};b.prototype.owc=function(e){if(2>this.rg.length)return rb("Can not extrapolate: less than 2 stations!"),!1;var f=this.Vc.length-2,g=this.Vc.length-1,h=c(e,this.rg[f],this.rg[g],this.Vc[f],this.Vc[g]);f=c(e,this.rg[f],this.rg[g],this.zd[f],this.zd[g]);
Math.abs(e-this.rg[g])<this.ea.depthinterval?(this.Vc[g]=h,this.zd[g]=f,this.rg[g]=e):(this.Vc.push(h),this.zd.push(f),this.rg.push(e));this.jeb();return!0};b.prototype.getX=function(e){return this.Vc[e]};b.prototype.getY=function(e){return this.zd[e]};b.prototype.Sb=function(e){return this.rg[e]};b.prototype.count=function(){return this.Vc?this.Vc.length:0};b.prototype.Of=function(){return this.Zq};b.prototype.Nf=function(){return this.Fr};b.prototype.iBc=function(e,f,g){return new cV(this,e,new M(g,
f))};b.Ifd=function(e,f,g,h,k,l,m){g=d;var n={distance:"ft",angle:"deg"};if(!Array.isArray(e)){f=e.data;var p=e.options;e=f.md;f=f.inclination;p=xb(p,{rightDeviation:!0,start:0,filter:!0,approximate:!0,depthinterval:g,units:n});h=p.rightDeviation;k=p.start;l=p.filter;m=p.approximate;g=p.depthinterval;n=p.units}if(!e||!f||e.length!==f.length)return null;var q;for(q=0;q<e.length-1;++q)if(e[q+1]<e[q])return null;p=new M;var r=new M,t=new M;k=k||0;l=void 0!==l?l:!0;m=void 0!==m?m:!0;h=void 0!==h?h:!0;
q=Zd.ya();var u=q.Wa(n.angle),w=q.Wa("rad"),y=e.length,A=[],x=[],C=[],z=e[0],v=0;for(q=0;q<y;q++){var B=h?f[q]:-f[q];B=u.convert(B,w);if(0===q){A[0]=k;x[0]=z;C[0]=e[q];var E=B;var H=e[q];var F=e[q]}else{var I=e[q]-C[v];k+=I*Math.sin(E);z+=I*Math.cos(E);if(l){if(0<=v){p.Ga(A[v-1],x[v-1]);r.Ga(A[v],x[v]);t.Ga(k,z);E=M.Uf(r,t);var J=E<V.Qb,K=0<v&&!J&&HO.i0b(p,r,t);J||(K?(J=M.Uf(p,r),(E=Math.abs(E/J-I/(C[v]-C[v-1]))<V.Qb)||++v):++v,A[v]=k,x[v]=z,C[v]=e[q])}}else++v,A[v]=k,x[v]=z,C[v]=e[q];E=B;C[v]>H&&
(H=C[v]);C[v]<F&&(F=C[v])}}return 0<v?new b({data:{x:A,y:x,d:C},options:{approximate:m,depthinterval:g,units:n}}):null};b.prototype.Nma=function(){return this.P7};b.prototype.Oma=function(){return this.Q7};b.prototype.Ima=function(){return this.I7};b.prototype.Jma=function(){return this.J7};b.prototype.Ayb=function(e,f){if(0>e||e>this.Vc.length-1)throw Error("Removal index out of bounds");void 0===f&&(f=1);0!==f&&(this.Vc.splice(e,f),this.zd.splice(e,f),this.rg.splice(e,f),this.jeb())};b.Nwc=function(e,
f,g){var h,k;for(h=g;h<e.count();++h)for(k=g;k<f.count();++k)if(e.Vc[h]===f.Vc[k]&&e.zd[h]===f.zd[k])return{Wwc:h,kNc:k};return null};b.dGd=function(e,f){if(!(1>e.count()||1>f.count())&&e.Vc[0]===f.Vc[0]&&e.zd[0]===f.zd[0])for(var g=0,h;;){h=-1;for(var k=Math.min(e.count(),f.count());g<k;++g)if(e.Vc[g]!==f.Vc[g]||e.zd[g]!==f.zd[g]){h=g;break}if(-1===h)break;if(k=b.Nwc(e,f,h))e.Ayb(k.Wwc-h),f.Ayb(k.kNc-h);else if(k=b.Nwc(f,e,h))e.Ayb(k.kNc-h),f.Ayb(k.Wwc-h);if(!k)break;g=h}};b.qGd=function(e){!e||
2>e.length||2===e.length&&b.dGd(e[0],e[1])};b.prototype.equals=function(e){if(!e||this.count()!==e.count()||this.Nma()!==e.Nma()||this.Ima()!==e.Ima()||this.Oma()!==e.Oma()||this.Jma()!==e.Jma())return!1;for(var f=0;f<this.count();f++)if(this.getX(f)!==e.getX(f)||this.getY(f)!==e.getY(f)||this.Sb(f)!==e.Sb(f))return!1;return!0};b.prototype.ia=function(){var e={};e.options=xb(this.ea,{});return e};b.prototype.fa=function(e){e=hc(e);if(null==e)return this;void 0!==e.options&&G(e.options,this.ea);void 0!==
e.data&&this.Kga(e.data);return this};return b}(),2,"eyJmcm9tT2JqZWN0IjoiUGEiLCJjcmVhdGVUcmFqZWN0b3J5IjoiSWZkIiwicHJvdG90eXBlIjp7InMiOjAsImMiOnsiaW50ZXJwb2xhdGVYWSI6Ik5GYyIsImdldERlcHRoIjoiU2IiLCJtaW5EZXB0aCI6Ik9mIiwibWF4RGVwdGgiOiJOZiIsImdldE1pblgiOiJObWEiLCJnZXRNaW5ZIjoiT21hIiwiZ2V0TWF4WCI6IkltYSIsImdldE1heFkiOiJKbWEiLCJnZXRQcm9wZXJ0aWVzIjoiaWEiLCJzZXRQcm9wZXJ0aWVzIjoiZmEifX19");var rV=/*#__PURE__*/function(){function c(){LO.call(this);this.DL=null;this.Rc=new W;this.r=new U;this.Eob=new M}D(c,LO);L(c,"geotoolkit.deviation.TVDTrajectoryStation");c.prototype.Gf=function(){return this.r};c.prototype.bd=function(){return this.Rc.Ma(this.Eob.Ga(this.r.la(),this.r.ka()))};c.prototype.Vf=function(){return this.Rc.Ma(this.Eob.Ga(this.r.la(),this.r.ma()))};c.prototype.Wf=function(){return this.Rc.Ma(this.Eob.Ga(this.r.na(),this.r.ka()))};c.prototype.nf=function(){return this.Rc.Ma(this.Eob.Ga(this.r.na(),
this.r.ma()))};c.prototype.D_=function(){return this.DL=this.DL||this.Rc.rc()};c.prototype.Fa=function(){return this.Rc};c.prototype.Tb=function(a){this.Rc=a;this.DL=null;this.rTb();return this};c.prototype.offset=function(a,b){this.Rc.cB(this.Rc.hf()+a,this.Rc.We()+b);this.DL=null;return this};c.prototype.IPd=function(){var a=this.r.la(),b=this.r.na(),d=this.r.ka(),e=this.r.ma(),f=this.Rc.Hc(a,e),g=f.getX();f=f.getY();var h=this.Rc.Hc(b,d),k=h.getX();h=h.getY();a=this.Rc.Hc(a,d);d=a.getX();a=a.getY();
b=this.Rc.Hc(b,e);var l=b.getX();e=b.getY();b=Math.min(Math.min(g,k),Math.min(d,l));g=Math.max(Math.max(g,k),Math.max(d,l));k=Math.min(Math.min(f,h),Math.min(a,e));f=Math.max(Math.max(f,h),Math.max(a,e));return new U(b,k,g,f)};c.prototype.contains=function(a){a=this.D_().Ma(a);return this.r.contains(a)};c.prototype.nc=function(a){return this.D_().Ma(a)};c.prototype.transform=function(a){return this.Rc.Ma(a)};c.prototype.i9=function(a,b){return this.L1b(a,b)};return c}();var sV=/*#__PURE__*/va(/*#__PURE__*/function(){function c(b,d,e){EO.call(this);this.Se=b.transformation||e;this.Op=b.trajectory;this.zw=b.trackWidth;this.uf=b.filter;this.Cb=b.offset;d=G(d,{scaleWidth:!1,minWidth:-Number.MAX_VALUE,maxWidth:Number.MAX_VALUE,widthScaleX:1});this.YOb=d.scaleWidth;this.OU=d.minWidth;this.IU=d.maxWidth;this.Hpb=d.widthScaleX;this.xe=[];this.YF=new DO;this.Yca=this.Xca=this.pR=this.oR=1;this.Loc=new W;this.Moc=new W;this.soa();this.Sa=null}var a=HO;D(c,EO);L(c,"geotoolkit.deviation.TVDTransformation");
c.prototype.m_=function(b){var d=this.xe.length,e=V.findIndex(null,this.xe,0,d,function(f){f=f.r.ma()-b;return Math.abs(f)>V.Qb?f:0});0>e?e=~e:++e;e>=d&&(e=d-1);return e};c.prototype.update=function(b){if(Math.abs(b.pb()-this.Se.pb())>V.Qb||Math.abs(b.Ab()-this.Se.Ab())>V.Qb)this.Se=b,this.soa();else{var d=b.hf()-this.Se.hf(),e=b.We()-this.Se.We();if(Math.abs(d)>V.Qb||Math.abs(e)>V.Qb){for(var f=0;f<this.xe.length;++f)this.xe[f].offset(d,e);this.Loc.Tb(1,0,0,1,d,e);d=this.YF.ana();for(e=0;e<d.length;++e)f=
d[e],this.Loc.Ta(f.Bv.D5,f.Bv.D5)}this.Se=b}return!0};c.prototype.transform=function(b){var d=this.m_(b.getY());for(0>d&&(d=0);d<this.xe.length;++d){if(b.getY()<=this.xe[d].r.ma()&&b.getY()>=this.xe[d].r.ka())return this.xe[d].transform(b);if(this.xe[d].r.ma()>b.getY())break}return new M};c.prototype.nc=function(b){for(var d=this.YF.ana(),e=this.YF.yUa(b.getY()-this.Se.We());e<d.length;++e){var f=d[e];if(this.xe[f.Bv.vpa].contains(b))return this.xe[f.Bv.vpa].nc(b);if(b.getY()<f.Bv.D5.ma())break}return new M};
c.prototype.mF=function(b,d,e){if(0!==this.xe.length){var f=new M,g=this.m_(b.getY());if(b.getY()<=d.getY())for(;g<this.xe.length;++g){var h=this.xe[g];h.r.ka()<=b.getY()&&h.r.ma()>=b.getY()&&a.Mq(e,h.transform(b),f,this.uf);h.r.ka()>=b.getY()&&h.r.ka()<=d.getY()&&a.Mq(e,h.transform(a.SP(b,d,h.r.ka())),f,this.uf);g===this.xe.length-1&&h.r.ma()>=b.getY()&&h.r.ma()<=d.getY()&&a.Mq(e,h.transform(a.SP(b,d,h.r.ma())),f,this.uf);h.r.ka()<=d.getY()&&h.r.ma()>=d.getY()&&a.Mq(e,h.transform(d),f,this.uf);if(h.r.ma()>=
d.getY())break}else for(g>=this.xe.length&&(g=this.xe.length-1);0<=g&&!(h=this.xe[g],h.r.ka()<=b.getY()&&h.r.ma()>=b.getY()&&a.Mq(e,h.transform(b),f,this.uf),h.r.ma()>=d.getY()&&h.r.ma()<=b.getY()&&a.Mq(e,h.transform(a.SP(b,d,h.r.ma())),f,this.uf),0===g&&h.r.ka()>=d.getY()&&h.r.ka()<=b.getY()&&a.Mq(e,h.transform(a.SP(b,d,h.r.ka())),f,this.uf),h.r.ka()<=d.getY()&&h.r.ma()>=d.getY()&&a.Mq(e,h.transform(d),f,this.uf),h.r.ka()<=d.getY());--g);}};c.prototype.II=function(b,d,e,f){var g=b.length;if(1<g&&
0<this.xe.length){(f=f&&!a.kKc(b,g))&&++g;if(e){var h=e.pb();var k=e.Ab();var l=e.hf();e=e.We()}else k=h=1,e=l=0;for(var m=new M,n=new M(b[0].getX()*h+l,b[0].getY()*k+e),p=new M,q=0,r=0,t,u=0;u<g-1;++u){t=f&&u===g-2?0:u+1;p.Ga(b[t].getX()*h+l,b[t].getY()*k+e);if(0>q||q>=this.xe.length||!(this.xe[q].r.ka()<=n.getY()&&this.xe[q].r.ma()>=n.getY()))q=this.m_(n.getY());if(n.getY()<=p.getY())for(;q<this.xe.length&&!(t=this.xe[q],0===u&&t.r.ka()<=n.getY()&&t.r.ma()>=n.getY()&&a.Mq(d,t.transform(n),m,this.uf),
t.r.ka()>n.getY()&&t.r.ka()<p.getY()&&a.Mq(d,t.transform(a.SP(n,p,t.r.ka())),m,this.uf),q===this.xe.length-1&&t.r.ma()>n.getY()&&t.r.ma()<p.getY()&&a.Mq(d,t.transform(a.SP(n,p,t.r.ma())),m,this.uf),t.r.ka()<=p.getY()&&t.r.ma()>=p.getY()&&(a.Mq(d,t.transform(p),m,this.uf),r=q),t.r.ma()>=p.getY());++q);else for(q>=this.xe.length&&(q=this.xe.length-1);0<=q&&!(t=this.xe[q],0===u&&t.r.ka()<=n.getY()&&t.r.ma()>=n.getY()&&a.Mq(d,t.transform(n),m,this.uf),t.r.ma()>p.getY()&&t.r.ma()<n.getY()&&a.Mq(d,t.transform(a.SP(n,
p,t.r.ma())),m,this.uf),0===q&&t.r.ka()>p.getY()&&t.r.ka()<n.getY()&&a.Mq(d,t.transform(a.SP(n,p,t.r.ka())),m,this.uf),t.r.ka()<=p.getY()&&t.r.ma()>=p.getY()&&(a.Mq(d,t.transform(p),m,this.uf),r=q),t.r.ka()<=p.getY());--q);q=r;n.Ga(p.getX(),p.getY())}}};c.prototype.Pua=function(b){return null};c.prototype.MRa=function(b){return 1>this.xe.length?new U:new U(0,b.ka(),this.zw,b.ma())};c.prototype.contains=function(b){for(var d=this.YF.ana(),e=this.YF.yUa(b.getY()-this.Se.We());e<d.length;++e){var f=
d[e];if(f.Bv.D5.contains(b)&&this.xe[f.Bv.vpa].contains(b))return!0;if(b.getY()<f.Bv.D5.ma())break}return!1};c.prototype.eX=function(b){return this.oR};c.prototype.fX=function(b){return this.pR};c.prototype.JW=function(){return this.oR};c.prototype.KW=function(){return this.pR};c.prototype.XS=function(){return this.Xca};c.prototype.YS=function(){return this.Yca};c.prototype.i9=function(b,d){var e=this.m_(b.getY());for(0>e&&(e=0);e<this.xe.length;++e){if(b.getY()<=this.xe[e].r.ma()&&b.getY()>=this.xe[e].r.ka())return this.xe[e].i9(b,
d);if(this.xe[e].r.ma()>b.getY())break}return null};c.prototype.jId=function(b){return this.YOb};c.prototype.soa=function(){this.xe=[];this.YF.clear();for(var b=0,d=this.jId(Math.abs(this.Se.pb())),e=1;e<this.Op.count();++e)if(!(this.Op.getY(b)>=this.Op.getY(e))){var f=this.Op.getX(b),g=this.Op.getY(b),h=this.Op.getX(e),k=this.Op.getY(e);if(1<e&&e<this.Op.count()-1){var l=new M(f,g),m=new M(h,k),n=this.Se.Ma(l),p=this.Se.Ma(m);if(.5>Math.abs(n.getX()-p.getX())&&.5>Math.abs(n.getY()-p.getY()))continue;
if(1<b&&(n=new M(this.Op.getX(b-1),this.Op.getY(b-1)),a.i0b(n,m,l)))continue}h=(h-f)/(k-g);f-=h*g;g=new rV;this.Moc.Tb(d,0,h,1,f,0);g.Tb(W.multiply(this.Se,this.Moc));g.r=new U(0,this.Op.getY(b),this.zw,this.Op.getY(e));this.hEa(g);b=e}this.oR=Math.abs(d*this.Se.pb());this.pR=Math.abs(this.Se.Ab());this.Xca=Math.abs(d*this.Se.pb());this.Yca=Math.abs(this.Se.Ab())};c.prototype.hEa=function(b){var d=b.IPd(),e=new RO(this.xe.length,d);d=d.ma()-this.Se.We();this.YF.Jn(new SO(d,e));this.xe.push(b)};c.prototype.W7a=
function(){return this.Se};c.prototype.Uva=function(){if(!this.Sa){var b=null;this.xe.forEach(function(d){b?b.union(d.ga()):b=d.ga()});this.Sa=b}return this.Sa};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRMb3dlckluZGV4IjoibV8iLCJpbnZlcnNlVHJhbnNmb3JtIjoibmMiLCJ0cmFuc2Zvcm1MaW5lIjoibUYiLCJ0cmFuc2Zvcm1MaW5lcyI6IklJIiwiZmluZFZpc2libGVUcmFqZWN0b3J5UmFuZ2VzIjoiUHVhIiwiZmluZEJvdW5kcyI6Ik1SYSIsInNjYWxlWEF0IjoiZVgiLCJzY2FsZVlBdCI6ImZYIiwibWF4U2NhbGVYIjoiSlciLCJtYXhTY2FsZVkiOiJLVyIsIm1pblNjYWxlWCI6IlhTIiwibWluU2NhbGVZIjoiWVMiLCJkaWdpdGl6ZSI6Imk5IiwiZ2V0U3RhdGlvbnNCb3VuZHMiOiJVdmEifX19");var tV=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a){CO.call(this);this.ea=G(a,{scaleWidth:!1,minWidth:-Number.MAX_VALUE,maxWidth:Number.MAX_VALUE,widthScaleX:1})}D(c,CO);L(c,"geotoolkit.deviation.TVDTransformer");c.prototype.ta=function(){return G(this.ea,{})};c.prototype.setOptions=function(a){G(a,this.ea)};c.prototype.create=function(a,b){return new sV(a,this.ea,b)};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoidGEifX19");export {CO,DO,EO,FO,GO,HO,IO,JO,KO,LO,MO,NO,OO,PO,QO,RO,SO,TO,UO,VO,WO,ZU,$U,aV,bV,cV,dV,eV,fV,gV,hV,iV,jV,kV,lV,mV,nV,oV,pV,qV,rV,sV,tV};