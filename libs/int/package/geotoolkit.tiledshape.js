/* eslint-disable */
import {L,Fb,M,V,Gh,D,Fj,Gj,ue,so,hb,xc,Qk,Za,Ce,G,U,Hd,ac,Sm,Ee,hc,xb,rf,W,va} from './geotoolkit.base.js';import {$k,Uk} from './geotoolkit.http.js';var aa,ha=ha||{};ha.scope={};ha.Nqc=function(c){var a=0;return function(){return a<c.length?{done:!1,value:c[a++]}:{done:!0}}};ha.Moe=function(c){return{next:ha.Nqc(c)}};ha.qXc=!1;ha.URd=!1;ha.VRd=!1;ha.Mfe=!1;ha.Acc=!1;ha.defineProperty=ha.qXc||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,a,b){if(c==Array.prototype||c==Object.prototype)return c;c[a]=b.value;return c};
ha.cod=function(c){c=["object"==typeof globalThis&&globalThis,c,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var a=0;a<c.length;++a){var b=c[a];if(b&&b.Math==Math)return b}return function(){throw Error("Cannot find global object");}()};ha.global=ha.cod(this);ha.nEb="function"===typeof Symbol&&"symbol"===typeof Symbol("x");ha.hje=!ha.Acc||ha.nEb;ha.r3b={};ha.L3b={};ha.S1c="$jscp$";
function aaa(c,a){var b=ha.L3b[a];if(null==b)return c[a];b=c[b];return void 0!==b?b:c[a]}ha.lKc=function(c,a,b,d){a&&(ha.Acc?ha.ZDd(c,a,b,d):ha.$Dd(c,a,b,d))};ha.$Dd=function(c,a,b,d){b=ha.global;c=c.split(".");for(d=0;d<c.length-1;d++){var e=c[d];if(!(e in b))return;b=b[e]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&ha.defineProperty(b,c,{configurable:!0,writable:!0,value:a})};
ha.ZDd=function(c,a,b,d){var e=c.split(".");c=1===e.length;d=e[0];d=!c&&d in ha.r3b?ha.r3b:ha.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];b=ha.nEb&&"es6"===b?d[e]:null;a=a(b);null!=a&&(c?ha.defineProperty(ha.r3b,e,{configurable:!0,writable:!0,value:a}):a!==b&&(ha.L3b[e]=ha.nEb?ha.global.Symbol(e):ha.S1c+e,e=ha.L3b[e],ha.defineProperty(d,e,{configurable:!0,writable:!0,value:a})))};ha.Ise=function(){};
ha.lKc("Symbol",function(c){function a(f){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new b(d+(f||"")+"_"+e++,f)}function b(f,g){this.oXc=f;ha.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})}if(c)return c;b.prototype.toString=function(){return this.oXc};var d="jscomp_symbol_",e=0;return a},"es6","es3");ha.Kse=function(){};
ha.lKc("Symbol.iterator",function(c){if(c)return c;c=Symbol("Symbol.iterator");for(var a="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),b=0;b<a.length;b++){var d=ha.global[a[b]];"function"===typeof d&&"function"!=typeof d.prototype[c]&&ha.defineProperty(d.prototype,c,{configurable:!0,writable:!0,value:function(){return ha.Nyd(ha.Nqc(this))}})}return c},"es6","es3");ha.Jse=function(){};
ha.Nyd=function(c){c={next:c};c[Symbol.iterator]=function(){return this};return c};var mo=/*#__PURE__*/va(/*#__PURE__*/function(){function c(){}L(c,"geotoolkit.scene.shapes.tiledshape.AbstractCancellationStrategy");c.prototype.wwb=Fb;return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpc1JlcXVlc3RWYWxpZCI6Ind3YiJ9fX0g");var no=/*#__PURE__*/va(/*#__PURE__*/{Image:0,Fpa:1,Teb:2},2,"eyJCYXNlNjQiOiJGcGEiLCJDYW52YXMiOiJUZWIifSAg");var oo=/*#__PURE__*/va(/*#__PURE__*/function(){function c(d){this.rect=d;this.qk=null;this.time=Date.now();this.valid=!0}function a(d){return Math.floor(d+.5)}var b=new M;c.prototype.Kl=function(){return this.qk};c.prototype.dpa=function(d){this.qk=d;return this};c.prototype.Eq=function(){return this.rect};c.prototype.cb=function(d){this.rect=d;return this};c.prototype.render=function(d,e,f){var g=d.uSa();d.BIa(!0);b.Ga(f.getX(),f.getY());b=e.Ma(b);var h=b.getX(),k=b.getY(),l=V.Qb,m=d.Bs();e=a(a(this.rect.getX()+h-l)*m);f=a(a(this.rect.getY()+
k-l)*m);h=a(a(this.rect.na()+h+l)*m);k=a(a(this.rect.ma()+k+l)*m);d.zh({Oz:!0});d.drawImage(this.qk,0,0,this.qk.ca(),this.qk.da(),e,f,h-e,k-f);d.ro();d.BIa(g)};c.prototype.getTime=function(){return this.time};c.prototype.cRd=function(){this.time=Date.now();return this};c.prototype.ha=function(){this.valid=!1};c.prototype.Td=function(){return this.valid};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZhbGlkYXRlIjoiaGEiLCJpc1ZhbGlkIjoiVGQifX19");var po=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a){this.yd=[];this.GLa=this.FLa=0;this.JHb=!1;this.setOptions(a)}L(c,"geotoolkit.scene.shapes.tiledshape.TileCache");c.prototype.setOptions=function(a){void 0!==a.capacity&&(this.GLa=a.capacity);void 0!==a.loadertype&&(this.JHb=a.loadertype===no.Teb);return this};c.prototype.ta=function(){return{capacity:this.GLa}};c.prototype.clear=function(){if(0===this.FLa)return{};var a=this.yd;this.yd=[];this.FLa=0;return a};c.prototype.bld=function(){return 0<this.GLa?this.GLa:Number.POSITIVE_INFINITY};
c.prototype.Zfa=function(a){return this.yd[a]};c.prototype.VP=function(a){if(a.hasOwnProperty("id")){var b=a.id,d=a.tileRect;if(this.prc()){var e=null,f=Date.now(),g;for(g in this.yd)if(this.yd.hasOwnProperty(g)){var h=this.yd[g].getTime();h<f&&(e=g,f=h)}a=this.NMc(a.image,d,b,e);delete this.yd[e];this.FLa--}else a=this.duc(a.image,d);this.yd.hasOwnProperty(b)||this.FLa++;this.yd[b]=a}};c.prototype.NMc=function(a,b,d,e){d="string"===typeof e?this.yd[e]:e;d.cRd();d.cb(b);a=this.JHb?a:a.HA();b=d.Kl();
b.setSize(a.width,a.height);b.clear();b.drawImage(a,0,0);return d};c.prototype.duc=function(a,b){b=new oo(b);a=this.JHb?a:a.HA();var d=new Gh(a.width,a.height,!0,!0,1);d.drawImage(a,0,0);b.dpa(d);return b};c.prototype.prc=function(){return 0<this.GLa&&this.FLa>=this.GLa};c.prototype.nwb=function(){return 0===this.FLa};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoidGEiLCJnZXRDYXBhY2l0eSI6ImJsZCIsImxvYWRGcm9tQ2FjaGUiOiJaZmEiLCJsb2FkSW1hZ2UiOiJWUCIsInJldXNlVGlsZSI6Ik5NYyIsImNyZWF0ZVRpbGUiOiJkdWMiLCJjYWNoZUlzRnVsbCI6InByYyIsImlzQ2FjaGVFbXB0eSI6Im53YiJ9fX0g");var uo=/*#__PURE__*/va(/*#__PURE__*/function(){function c(){mo.call(this)}D(c,mo);L(c,"geotoolkit.scene.shapes.tiledshape.VisibleAreaCancellationStrategy");c.prototype.wwb=function(a,b){return b.visibleModelArea.Nd(a.tileRect)};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpc1JlcXVlc3RWYWxpZCI6Ind3YiJ9fX0g");var vo=/*#__PURE__*/va(/*#__PURE__*/{BZa:"TileAddedToQueue",Aza:"TileRemovedFromQueue",OXa:"AllTilesRendered",Bba:"TileLoading",Aba:"TileLoaded",m6:"TileCancelled",Dba:"TileRendering",Cba:"TileRendered",yYa:"FirstTileLoading",zKa:"LastTileRendered"},2,"eyJUaWxlTG9hZGluZyI6IkJiYSIsIlRpbGVMb2FkZWQiOiJBYmEiLCJUaWxlQ2FuY2VsbGVkIjoibTYiLCJUaWxlUmVuZGVyaW5nIjoiRGJhIiwiVGlsZVJlbmRlcmVkIjoiQ2JhIiwiRmlyc3RUaWxlTG9hZGluZyI6InlZYSIsIkxhc3RUaWxlUmVuZGVyZWQiOiJ6S2EifSAg");var wo=/*#__PURE__*/va(/*#__PURE__*/function(){function c(f){ue.call(this);this.Nda=new so({numberofparalleltasks:6});this.JQb=1;this.Bx=6E4;this.m3=null;this.DMa=b;this.Rs={};this.Lkb=!0;this.CMa=null;this.XKb=this.bhc=this.$gd.bind(this);this.BL=$k.ya().sS();this.JNa=no.Image;this.Qib=this.Phb=null;this.setOptions(f)}function a(f,g){return(f<<16)+g}var b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAIAAADTED8xAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAKXSURBVHhe7dMBAQAACMMgm7+6QQYduEGYAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoApAlAmgCkCUCaAKQJQJoAhG0PobQWVJKLEbMAAAAASUVORK5CYII=",d=
[],e=function(){function f(){this.eha=this.data=this.r9b=this.image=this.request=null}f.prototype.dispose=function(){null!=this.eha&&clearTimeout(this.eha);this.request&&this.request.cancel();this.image&&(this.image.za(Fj.Cj),this.image.fa({url:null}),256>d.length?d.push(this.image):this.image.dispose());this.data=null};return f}();D(c,ue);L(c,"geotoolkit.scene.shapes.tiledshape.TileReceiver");c.prototype.setOptions=function(f){if(!f)return this;void 0!==f.maxnumreq&&this.Nda.o7b(f.maxnumreq);void 0!==
f.tries&&(this.JQb=f.tries);void 0!==f.timeout&&(this.Bx=f.timeout);void 0!==f.formatter&&this.hdb(f.formatter);void 0!==f.imageloader&&(this.XKb=null!=f.imageloader?f.imageloader:this.bhc);void 0!==f.errimgsrc&&(this.DMa=f.errimgsrc,this.CMa&&(this.CMa.src=this.DMa));void 0!==f.base64&&(hb("options.base64 from geotoolkit.scene.shapes.TiledShape is deprecated since 2020.1 (3.1), use options.loadertype instead"),this.JNa=no.Fpa);void 0!==f.httpservice&&(this.BL=f.httpservice?f.httpservice:$k.ya().sS());
void 0!==f.loadertype&&(this.JNa=f.loadertype);void 0!==f.cancellationstrategy&&(this.Phb=f.cancellationstrategy);void 0!==f.timetowaitchanges&&(hb("geotoolkit.scene.shapes.TiledShape.prototype.setOptions parameter options.timetowaitchanges was deprecated since 3.4. Use parameter delaycallback instead."),this.Qib=function(){return f.timetowaitchanges||0});void 0!==f.delaycallback&&(this.Qib=f.delaycallback);return this};c.prototype.ta=function(){return{maxnumreq:this.Nda.aCc(),tries:this.JQb,timeout:this.Bx,
formatter:this.m3,imageloader:this.XKb,errimgsrc:this.DMa,httpservice:this.BL,loadertype:this.JNa,cancellationstrategy:this.Phb,delaycallback:this.Qib}};c.prototype.hdb=function(f){this.clear();this.m3=f;this.Lkb="function"===typeof this.m3||null==this.m3;return this};c.prototype.IJa=function(f){if(this.Phb instanceof uo)for(var g in this.Rs)this.Phb.wwb(this.Rs[g].data,f)||this.oua(g)};c.prototype.Iga=function(f){if(this.m3){var g=f.id;if(this.Rs.hasOwnProperty(g)){if(null==this.Rs[g].eha)return;
clearTimeout(this.Rs[g].eha);this.notify(vo.Aza,this);this.Rs[g].eha=null}else this.Rs[g]=new e;this.Rs[g].data=f;var h=this.Qib(f);0<h?this.Rs[g].eha=setTimeout(this.pqc.bind(this,g,f),h):this.pqc(g,f);this.notify(vo.BZa,this)}};c.prototype.pqc=function(f,g){if(this.ge()||null==this.Rs[f]||this.Rs[f].data!==g)this.ge()||this.notify(vo.Aza,this);else{this.Rs[f].eha=null;var h=this,k=this.Nda.iEa(function(l,m,n){n.mk()||!h.m3?m():(h.notify(vo.Bba,h,{id:f,modelArea:g.tileRect}),h.load(g,function(p){n.mk()?
m():(h.notify(vo.Aba,h,{id:f,image:p,modelArea:g.tileRect,tileRect:g.deviceTileRect}),h.z4b(f),l())}))},{cancel:function(){h.notify(vo.m6,h,{id:f,modelArea:g.tileRect});h.z4b(f)}});this.Rs[f].r9b=k.ic()}};c.prototype.load=function(f,g){var h=this;if(this.Lkb){var k=f.id;f.deviceTileRect=f.deviceArea.clone().translate(-f.transformedModelRect.getX(),-f.transformedModelRect.getY());f.deviceArea.round();f.transformedModelRect.round();var l=null;this.JNa!==no.Teb&&(l=0<d.length?d.pop():new Gj({crossorigin:"Anonymous"}),
this.Rs[k].image=l,l.on(Fj.Cj,function(){h.ge()||g(l)}));this.cHc(this.m3(f),l,k,g,this.JQb)}else{f.deviceArea.round();f.transformedModelRect.round();k=function(n){n.id=a(n.imgI,n.imgJ);n.image=new Gj({crossorigin:"Anonymous",image:n.img||n.image});n.image.on(Fj.Cj,function(){g(n.image)});h.m3.Avc(n.id)};var m=function(n){h.CMa||(h.CMa=xc("img"),h.CMa.src=h.DMa);n.id=a(n.imgI,n.imgJ);n.image=new Gj({crossorigin:"Anonymous",image:h.CMa});n.image.on(Fj.Cj,function(){g(n.image)});h.m3.Avc(n.id)};this.m3.load(null,
k,m,f.transformedModelRect,f.deviceArea,f.tileRect,f.i,f.j)}};c.prototype.cHc=function(f,g,h,k,l){var m=this;this.Rs[h].request=new Qk;"string"===typeof f&&(f={url:f});f.cancel=this.Rs[h].request;f.connectionData=this.Rs[h];var n=this.XKb(f,function(p,q){f.connectionData!==m.Rs[h]?k():q?null==g?k(q):(p=m.JNa===no.Fpa||"object"!==typeof q?q:Za.URL.createObjectURL(q),g.fa({url:p?p:m.DMa})):!p||p!==Uk.nha&&p.code!==Uk.nha?(l--,p=function(){m.Rs[h]===f.connectionData?m.cHc(f,g,h,k,l):k()},0<l?setTimeout(p,
m.Bx):null==g?(m.oua(h),k()):g.fa({url:m.DMa})):k()});n instanceof Qk&&this.Rs[h].request!==n&&(this.Rs[h].request=n,f.cancel=this.Rs[h].request)};c.prototype.$gd=function(f,g){return this.query(f,this.JNa===no.Fpa?null:"blob",function(h,k){g(h,k)})};c.prototype.query=function(f,g,h){return this.BL.get(f.url,{cancel:f.cancel,responseType:g}).then(function(k){h(null,k.data)},h)};c.prototype.clear=function(){this.Nda.abort();for(var f in this.Rs)this.oua(f);this.Lkb||this.m3.ite();return this};c.prototype.oua=
function(f){if(null!=this.Rs[f])if(null!=this.Rs[f].r9b)this.Nda.Tpc(this.Rs[f].r9b);else{var g=vo.m6;null!=this.Rs[f].eha&&(clearTimeout(this.Rs[f].eha),this.Rs[f].eha=null,g=vo.Aza);this.notify(g,this,{id:f,modelArea:this.Rs[f].data.tileRect});this.z4b(f)}};c.prototype.z4b=function(f){null!=this.Rs[f]&&(this.Lkb||this.m3.Avc(f),this.Rs[f].dispose(),delete this.Rs[f])};c.prototype.dispose=function(){this.ge()||(ue.prototype.dispose.call(this),this.clear())};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoidGEiLCJzZXRUaWxlRm9ybWF0dGVyIjoiaGRiIiwidmFsaWRhdGVSZXF1ZXN0cyI6IklKYSIsInNlbmRSZXF1ZXN0IjoiSWdhIiwiY2FuY2VsSW1hZ2UiOiJvdWEifX19");var xo=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a){ue.call(this);null==a.formatter&&(a.formatter=a.provider);this.dY=a.asynctimeout||12E4;this.Bx=null;this.JY=0;this.d0a=this.Et=null;this.yd=new po(a);this.xc=new wo(a);this.xc.on(vo.BZa,function(){this.JY++;this.notify(vo.BZa,this)}.bind(this));this.xc.on(vo.Aza,function(){this.JY--;this.notify(vo.Aza,this)}.bind(this));this.xc.on(vo.Bba,function(b,d,e){this.notify(vo.Bba,this,e)}.bind(this));this.xc.on(vo.Aba,function(b,d,e){null!=e.image&&(this.yd.VP(e),this.JY--,
this.Et&&(this.Et(this.yd.Zfa(e.id)),this.d6a()&&this.jVb()),this.notify(vo.Aba,this,e),this.notify(Ce.gb,this,e.modelArea))}.bind(this));this.xc.on(vo.m6,function(b,d,e){this.JY--;this.notify(vo.m6,this,e)}.bind(this))}D(c,ue);L(c,"geotoolkit.scene.shapes.tiledshape.AbstractTileManager");c.prototype.setOptions=function(a){null==a.formatter&&(a.formatter=a.provider);this.dY=a.asynctimeout||this.dY;this.yd.setOptions(a);this.xc.setOptions(a);return this};c.prototype.ta=function(){return G(G(this.yd.ta(),
this.xc.ta()),{asynctimeout:this.dY})};c.prototype.hdb=function(a){this.xc.hdb(a);return this};c.prototype.nwb=function(){return this.yd.nwb()};c.prototype.clear=function(){this.xc.clear();return this.yd.clear()};c.prototype.Zfa=function(a){return this.yd.Zfa(a)};c.prototype.Iga=function(a){this.xc.Iga(a)};c.prototype.oua=function(a){this.xc.oua(a)};c.prototype.fyb=function(a,b,d,e,f,g){this.Et&&(this.xc.clear(),this.jVb());this.clear();this.query(a,b,d,e,f,!0);this.d6a()?g():(this.Et=f,this.d0a=
g,this.Bx=setTimeout(this.jVb.bind(this),this.dY))};c.prototype.jVb=function(){this.Et=null;this.Bx&&(clearTimeout(this.Bx),this.Bx=null);this.d0a()};c.prototype.ha=function(a){};c.prototype.query=Fb;c.prototype.IJa=function(a){this.xc.IJa(a)};c.prototype.dispose=function(){this.clear();this.xc.dispose();ue.prototype.dispose.call(this)};c.prototype.d6a=function(){return 0===this.JY};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoidGEiLCJzZXRUaWxlRm9ybWF0dGVyIjoiaGRiIiwiaXNDYWNoZUVtcHR5IjoibndiIiwibG9hZEZyb21DYWNoZSI6IlpmYSIsInNlbmRSZXF1ZXN0IjoiSWdhIiwiY2FuY2VsSW1hZ2UiOiJvdWEiLCJxdWVyeUFzeW5jIjoiZnliIiwiaW52YWxpZGF0ZSI6ImhhIiwidmFsaWRhdGVSZXF1ZXN0cyI6IklKYSIsImFyZUFsbFRpbGVzTG9hZGVkIjoiZDZhIn19fSAg");var yo=/*#__PURE__*/va(/*#__PURE__*/function(){function c(a){xo.call(this,a);this.$Mb=null;this.ck=[];this.setOptions(a)}D(c,xo);L(c,"geotoolkit.scene.shapes.tiledshape.ImageManager");c.prototype.setOptions=function(a){if(null==a)return this;xo.prototype.setOptions.call(this,a);void 0!==a.modelarea&&(this.$Mb=a.modelarea);void 0!==a.images&&(this.ck=a.images.sort(function(b,d){return b.width<d.width}));return this};c.prototype.ta=function(){return G(xo.prototype.ta.call(this),{modelarea:this.$Mb,images:this.ck})};c.prototype.query=
function(a,b,d,e,f){this.v8=this.v8||a.pb();this.w8=this.w8||a.Ab();a=a.Ta(e);a=a.translate(-a.getX(),-a.getY());b=this.HA(Math.round(a.ca()));d=this.Zfa(b.id);null==d?(this.IJa({visibleModelArea:e}),this.Iga({id:b.id,tileRect:this.$Mb,deviceArea:a,transformedModelRect:a})):this.R_a=d;this.R_a&&(this.notify(vo.Dba,this,{id:b.id,modelArea:this.R_a.rect}),this.R_a.cb(a),f(this.R_a),this.notify(vo.Cba,this,{id:b.id,modelArea:this.R_a.rect}));this.notify(vo.OXa,this)};c.prototype.HA=function(a){for(var b=
0;b<this.ck.length-1;b++)if(a<=this.ck[b])return this.ck[b];return this.ck[this.ck.length-1]};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoidGEiLCJnZXRJbWFnZSI6IkhBIn19fSAg");var zo=/*#__PURE__*/va(/*#__PURE__*/function(){function c(d){xo.call(this,d);this.mV=this.oV=256;this.tY=1;this.NU=0;this.HU=15;this.o2=null;this.uR=[];this.setOptions(d);this.k2=this.E3=1;this.pq=new U}function a(d,e){return(d<<16)+e}var b=new U;D(c,xo);L(c,"geotoolkit.scene.shapes.tiledshape.OSMManager");c.prototype.setOptions=function(d){if(null==d)return this;xo.prototype.setOptions.call(this,d);void 0!==d.tilew&&(this.oV=d.tilew);void 0!==d.tileh&&(this.mV=d.tileh);void 0!==d.extendedrenderingborders&&(this.tY=d.extendedrenderingborders);
void 0!==d.minlod&&(this.NU=d.minlod);void 0!==d.maxlod&&(this.HU=d.maxlod);return this};c.prototype.ta=function(){return G(xo.prototype.ta.call(this),{tilew:this.oV,tileh:this.mV,extendedrenderingborders:this.tY,minlod:this.NU,maxlod:this.HU})};c.prototype.query=function(d,e,f,g,h){b.cb(e).Uc(this.tY*this.oV,this.tY*this.mV);this.o2=g;this.pq=d.Ta(this.o2,this.pq);e=V.clamp(Math.ceil(Math.log2(Math.min(d.Wt(),d.Hw()))),this.NU,this.HU);if(this.z!==e||!V.equals(this.E3,this.pq.ca())||!V.equals(this.k2,
this.pq.da())){this.z=e;g=this.clear();for(var k in g)this.uR.push(g[k]);for(k=0;k<this.uR.length;k++){g=this.uR[k].Eq();var l=this.pq.ca()/this.E3,m=this.pq.da()/this.k2;g.cb(g.getX()*l,g.getY()*m,g.na()*l,g.ma()*m);this.uR[k].cb(g)}}this.E3=this.pq.ca();this.k2=this.pq.da();m=Math.pow(2,e);l=b.intersect(this.pq);if(!l.isEmpty()){k=Math.abs(Math.sin(d.hv()))+Math.abs(Math.cos(d.hv()));l.Uc(l.width*(k-1),l.height*(k-1));g=Math.ceil(this.oV*d.Wt()/m);var n=Math.ceil(this.mV*d.Hw()/m);k=Math.ceil((l.getX()+
l.ca()-this.pq.getX())/g);var p=Math.floor((l.getX()-this.pq.getX())/g);g=Math.floor((l.getY()-this.pq.getY())/n);l=Math.ceil((l.getY()+l.da()-this.pq.getY())/n);0>p&&(p=0);0>g&&(g=0);k>m&&(k=m);l>m&&(l=m);this.uR.forEach(h);f=f.clone().intersect(this.pq);f.isEmpty()||(f=d.pd(f),f.Uc(Math.max(Hd.qb((this.tY+1)*this.oV,0,d),0),Math.max(Hd.qb(0,(this.tY+1)*this.mV,d),0)),this.IJa({visibleModelArea:f}));for(f=p;f<k;f++)for(m=g;m<l;m++)p=a(f,m),n=this.Zfa(p),null!=n?(this.notify(vo.Dba,this,{id:p,modelArea:n.rect}),
h(n),this.notify(vo.Cba,this,{id:p,modelArea:n.rect})):this.qab(this.pq,d,f,m,e,p);this.d6a()&&0<this.uR.length&&(this.uR.length=0);this.notify(vo.OXa,this)}};c.prototype.qab=function(d,e,f,g,h,k){var l=Math.pow(2,h),m=this.oV*e.Wt()/l;l=this.mV*e.Hw()/l;var n=f*m+d.getX(),p=g*l+d.getY();m=new U(n,p,m+n,l+p);e=e.pd(m);e.Nd(this.o2)&&this.Iga({id:k,tileRect:e,i:f,j:g,z:h,deviceArea:m,transformedModelRect:d.clone()})};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoidGEiLCJsb2FkRnJvbVNlcnZlciI6InFhYiJ9fX0g");var Ao=/*#__PURE__*/va(/*#__PURE__*/function(){function c(d){xo.call(this,d);this.mV=this.oV=256;this.tY=1;this.n1a=!1;this.o2=null;this.Gjc=1;this.uR=[];this.pq=new U;this.setOptions(d)}function a(d,e){return(d<<16)+e}var b=new U;D(c,xo);L(c,"geotoolkit.scene.shapes.tiledshape.TileManager");c.prototype.setOptions=function(d){if(null==d)return this;xo.prototype.setOptions.call(this,d);void 0!==d.tilew&&(this.oV=d.tilew);void 0!==d.tileh&&(this.mV=d.tileh);void 0!==d.extendedrenderingborders&&(this.tY=d.extendedrenderingborders);
void 0!==d.isconsttiles&&(this.n1a=d.isconsttiles);return this};c.prototype.ta=function(){return G(xo.prototype.ta.call(this),{tilew:this.oV,tileh:this.mV,extendedrenderingborders:this.tY,isconsttiles:this.n1a})};c.prototype.query=function(d,e,f,g,h){if(null!=g){var k=ac();b.cb(e).Uc(this.tY*this.oV,this.tY*this.mV);this.o2=g;this.pq=d.Ta(this.o2,this.pq);if(!(this.n1a||V.equals(this.Gjc,k)&&V.equals(this.E3,this.pq.ca())&&V.equals(this.k2,this.pq.da()))){e=this.clear();for(var l in e)this.uR.push(e[l]);
for(l=0;l<this.uR.length;l++){e=this.uR[l].Eq();g=this.pq.ca()/this.E3;var m=this.pq.da()/this.k2;e.cb(e.getX()*g,e.getY()*m,e.na()*g,e.ma()*m);this.uR[l].cb(e)}}this.Gjc=k;this.E3=this.pq.ca();this.k2=this.pq.da();g=b.intersect(this.pq);if(!g.isEmpty()){l=this.oV;m=this.mV;k=Math.ceil((g.getX()+g.ca()-this.pq.getX())/l);l=Math.floor((g.getX()-this.pq.getX())/l);e=Math.floor((g.getY()-this.pq.getY())/m);g=Math.ceil((g.getY()+g.da()-this.pq.getY())/m);f=f.clone().intersect(this.pq);f.isEmpty()||(f=
d.pd(f),f.Uc(Math.max(Hd.qb((this.tY+1)*this.oV,0,d),0),Math.max(Hd.qb(0,(this.tY+1)*this.mV,d),0)),this.IJa({visibleModelArea:f}));for(f=l;f<k;f++)for(m=e;m<g;m++){var n=a(f,m),p=this.Zfa(n);null!=p&&p.Td()||this.qab(this.pq,d,f,m,n)}!this.n1a&&0<this.uR.length&&(this.d6a()?this.uR.length=0:this.uR.forEach(h));this.cHd(l,k,e,g,h);this.notify(vo.OXa,this)}}};c.prototype.cHd=function(d,e,f,g,h){for(;d<e;d++)for(var k=f;k<g;k++){var l=a(d,k),m=this.Zfa(l);m&&(this.notify(vo.Dba,this,{id:l,modelArea:m.rect}),
h(m),this.notify(vo.Cba,this,{id:l,modelArea:m.rect}))}};c.prototype.qab=function(d,e,f,g,h){var k=this.oV,l=this.mV,m=f*k+d.getX(),n=g*l+d.getY();k=new U(m,n,k+m,l+n);l=e.nc(k);l=l.intersect(this.o2);l.ca()<V.Qb||l.da()<V.Qb||(k=e.transform(l,k),this.Iga({id:h,tileRect:l,deviceArea:k,transformedModelRect:d.clone(),i:f,j:g}))};c.prototype.ha=function(d){if(!this.n1a){var e=b;null!=d?(b.cb(d),b.intersect(this.pq)):b.cb(this.pq);var f=this.oV,g=this.mV;d=Math.ceil((e.getX()+e.ca()-this.pq.getX())/f);
var h=Math.floor((e.getX()-this.pq.getX())/f);f=Math.floor((e.getY()-this.pq.getY())/g);e=Math.ceil((e.getY()+e.da()-this.pq.getY())/g);for(g=h;g<d;g++)for(h=f;h<e;h++){var k=a(g,h);this.oua(k);k=this.Zfa(k);null!=k&&k.ha()}}};return c}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoidGEiLCJsb2FkRnJvbVNlcnZlciI6InFhYiIsImludmFsaWRhdGUiOiJoYSJ9fX0g");var Do=/*#__PURE__*/va(/*#__PURE__*/function(){function c(g){var h=new U(0,0,1E3,1E3);Sm.call(this,h);this.o2=h;this.Np=null;this.tV=function(k,l,m){this.ha(m,!1)}.bind(this);this.jL=!1;this.IOb=this.WLb=this.JY=this.XLb=0;this.Nka={};this.UPa={};this.Kob={};this.Job={};this.mQb={};this.zjb=!0;this.TPa=!1;this.Uba=null;this.ea={freezeupdate:!1};this.khc=function(k){k.za(vo.BZa,this.Qlc);k.za(vo.Aza,this.Ulc);k.za(vo.OXa,this.llc);k.za(Ce.gb,this.tV);k.za(vo.Bba,this.Tlc);k.za(vo.Aba,this.Slc);k.za(vo.m6,this.Rlc);k.za(vo.Dba,
this.Wlc);k.za(vo.Cba,this.Vlc)}.bind(this);this.Lgc=function(k){k.on(vo.BZa,this.Qlc);k.on(vo.Aza,this.Ulc);k.on(vo.OXa,this.llc);k.on(Ce.gb,this.tV);k.on(vo.Bba,this.Tlc);k.on(vo.Aba,this.Slc);k.on(vo.m6,this.Rlc);k.on(vo.Dba,this.Wlc);k.on(vo.Cba,this.Vlc)}.bind(this);this.Qlc=function(){0===this.JY&&(this.zjb=!0,this.TPa=!1);this.JY++}.bind(this);this.Ulc=function(){this.JY--}.bind(this);this.Tlc=function(k,l,m){if(this.zjb){this.WLb=0;this.zjb=!1;this.TIc();if(!this.jL)return;this.Nka[m.id]=
Za.performance.now();this.XLb=this.Nka[m.id]}else this.jL&&(this.Nka[m.id]=Za.performance.now());this.jL&&this.notify(vo.Bba,this,{modelArea:m.modelArea})}.bind(this);this.Slc=function(k,l,m){this.JY--;this.WLb++;this.jL&&(k=Za.performance.now()-this.Nka[m.id],this.notify(vo.Aba,this,{modelArea:m.modelArea,time:k}),delete this.Nka[m.id],this.Kob[m.modelArea.toString()]=k)}.bind(this);this.Rlc=function(k,l,m){this.JY--;this.jL&&this.Nka.hasOwnProperty(m.id)&&(k=Za.performance.now()-this.Nka[m.id],
this.notify(vo.m6,this,{modelArea:m.modelArea,time:k}),delete this.Nka[m.id],this.Job[m.modelArea.toString()]=k)}.bind(this);this.Wlc=function(k,l,m){this.jL&&!this.TPa&&(this.UPa[m.id]=Za.performance.now(),this.notify(vo.Dba,this,{modelArea:m.modelArea}))}.bind(this);this.Vlc=function(k,l,m){this.TPa||(this.IOb++,this.jL&&(k=Za.performance.now()-this.UPa[m.id],this.notify(vo.Cba,this,{modelArea:m.modelArea,time:Za.performance.now()-this.UPa[m.id]}),delete this.UPa[m.id],this.mQb[m.modelArea.toString()]=
k))}.bind(this);this.llc=function(k,l,m){this.TPa||0<this.JY||(this.TPa=!0,this.vIc(),this.Kob={},this.Job={},this.UPa={})}.bind(this);g=g||{};g.delaycallback=g.delaycallback||function(k){return 500};this.setOptions(g)}var a,b,d,e,f;D(c,Sm);L(c,"geotoolkit.scene.shapes.TiledShape");c.prototype.TIc=function(){this.notify(vo.yYa,this)};c.prototype.vIc=function(){this.Uba&&(this.Uba.dispose(),this.Uba=null,setTimeout(this.ha.bind(this)));var g=this.jL?{tilesLoading:this.Kob,tilesCancelling:this.Job,
tilesRendering:this.mQb,time:Za.performance.now()-this.XLb}:{};this.notify(vo.zKa,this,g)};c.prototype.BMc=function(){this.IOb=this.WLb=this.JY=this.XLb=0;this.Nka={};this.UPa={};this.Kob={};this.Job={};this.mQb={};this.zjb=!0;this.TPa=!1};c.prototype.Gfd=function(g){var h=Ao;if(void 0!==g.images)h=yo;else if(g.hasOwnProperty("minlod")||g.hasOwnProperty("maxlod"))h=zo;else if(!g.hasOwnProperty("isconsttiles")&&null!=this.Np)return g&&g.freezeupdate&&(this.Uba=this.Uba||this.Np,this.khc(this.Np),this.Np=
new h(g),this.Lgc(this.Np)),this.Np.clear(),this.BMc(),this.Np.setOptions(g),this.Np;null!=this.Np&&((g=G(g,this.Np.ta()))&&g.freezeupdate?(this.Uba=this.Np,this.khc(this.Np)):this.Np.dispose());this.Np=new h(g);this.BMc();this.Lgc(this.Np);return this.Np};c.prototype.setOptions=function(g){if(null==g)return this;g=hc(g);this.ea=xb(g,this.ea);g.hasOwnProperty("modelarea")&&this.ea.modelarea instanceof U&&!this.ea.modelarea.isEmpty()&&(this.o2=this.ea.modelarea,this.sa(this.o2));this.Np=this.Gfd(this.ea);
this.ha();return this};c.prototype.ta=function(){var g=xb(this.ea,{});return xb(this.Np.ta(),g)};c.prototype.we=function(g,h){g=null!=this.Qa()?g.Zb(this.Qa()):g;if(g.ac())g.qa(rf.kh),g.sc(this.Iz()),h();else if(null==this.Np)h();else{var k=this;this.Doa(g,function(l,m,n,p,q){function r(){q();h()}k.Uba?k.Uba.fyb(l,m,n,k.Iz(),p,function(){k.Np.fyb(l,m,n,k.Iz(),function(){},r)}):k.Np.fyb(l,m,n,k.Iz(),p,r)})}};c.prototype.render=function(g){this.IOb=0;g=null!=this.Qa()?g.Zb(this.Qa()):g;if(g.ac())g.qa(rf.kh),
g.sc(this.Iz());else if(null!=this.Np){var h=this;this.Doa(g,function(k,l,m,n,p){h.Uba?(h.Uba.query(k,l,m,h.Iz(),n),h.Np.query(k,l,m,h.Iz(),function(){})):h.Np.query(k,l,m,h.Iz(),n);p()})}};c.prototype.Doa=function(g,h){function k(){if(null!=l){l.Ko();var y=g.Zb(t.rc());y.drawImage(l,0,0,l.ca()*g.Bs(),l.da()*g.Bs(),0,0,r.ca(),r.da())}w.jh(g)}this.Eh(g);var l,m=g.jg(),n=g.KM(),p=g.Fa();if((p.yG()||0>p.pb()||0>p.Ab())&&null!=this.Iz()){var q=g.Fa();m=this.Iz();a=a||new M;b=b||new M;d=d||new M;e=e||
new U;f=f||new W;a.Ga(m.la(),m.ka());b.Ga(m.la(),m.ma());d.Ga(m.na(),m.ka());a=q.transform(a,a);b=q.transform(b,b);d=q.transform(d,d);n=M.Uf(a,d);p=M.Uf(a,b);e.cb(0,0,n,p);p=W.Sd(m,e);m=g.jg().clone();n=g.KM().clone();q.nc(m,m);q.nc(n,n);p.transform(m,m);p.transform(n,n);if(m.Nd(e)){var r=m.clone().intersect(e);var t=W.cf(-r.getX()+e.getX(),-r.getY()+e.getY()).Qp(p);q=r.ca();var u=r.da();0<q&&0<u&&(l=g.Hy(q,u,!1))}}null!=l&&l.vq();var w=this;h(p,m,n,function(y){null!=l?y.render(l.Ova(),t,w.Iz()):
y.render(g,g.Fa(),w.Iz())},k)};c.prototype.Iz=function(){return this.o2};c.prototype.Qa=function(){var g=this.Vod(),h=this.lb();return null==h?g:null==g?h:W.multiply(h,g)};c.prototype.dispose=function(){this.ge()||(null!=this.Np&&(this.Np.dispose(),this.Np=null),Sm.prototype.dispose.call(this))};c.prototype.xa=function(g,h){Sm.prototype.xa.call(this,g,h);h===Ee.vba&&(this.Np&&this.Np.clear(),this.ha());return this};c.prototype.Vod=function(){var g=this.ga(),h=this.Iz();return W.nua(h,g)?W.Sd(h,g,
!1,!1,!1):null};c.prototype.BAc=function(g){g=g||this.Iz();if(null!=g&&null!=this.wa()){var h=this.wa().hv(),k=Math.abs(Math.cos(h))+Math.abs(Math.sin(h))-1;0<k&&(g=g.clone(),h=g.ca()*k,k*=g.ca(),g.Uc(h,k))}return g};c.prototype.ha=function(g,h){!1!==h&&this.Np&&this.Np.ha(g);Sm.prototype.ha.call(this,this.BAc(g),h)};c.prototype.Ag=function(g,h){Sm.prototype.Ag.call(this,this.BAc(g),h)};c.prototype.Dxa=function(g){this.jL=g;return this};c.prototype.m8a=function(){return this.jL};return c}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJvblN0YXJ0VGlsZXNMb2FkaW5nIjoiVEljIiwib25BbGxUaWxlc1JlbmRlcmVkIjoidkljIiwiZ2V0T3B0aW9ucyI6InRhIiwicmVuZGVyQXN5bmMiOiJ3ZSIsImdldE1vZGVsQXJlYSI6Ikl6IiwiZ2V0V29ybGRUcmFuc2Zvcm0iOiJRYSIsInVwZGF0ZVN0YXRlIjoieGEiLCJpbnZhbGlkYXRlIjoiaGEiLCJpbnZhbGlkYXRlUGFyZW50IjoiQWciLCJzZXRDb2xsZWN0UGVyZm9ybWFuY2VJbmZvcm1hdGlvbiI6IkR4YSIsImdldENvbGxlY3RQZXJmb3JtYW5jZUluZm9ybWF0aW9uIjoibThhIn19fSAg");export {mo,no,oo,po,uo,vo,wo,xo,yo,zo,Ao,Do};